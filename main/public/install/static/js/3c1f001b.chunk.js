"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["dialogs"],{86980:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var i=a(85597),r=a(21822),o=a(29620),n=a(72962),l=a(24498),s=a(77745),c=a(22949),p=a(28583),d=a.n(p),m=a(67294);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function u({title:e,message:t,label:a,value:p,helperText:u,positiveButton:g,negativeButton:f}){let{i18n:v,useDialog:y}=(0,i.OgA)(),{setDialogValue:x,disableBackdropClick:b,dialogProps:E}=y(),C=()=>{x(!1)};m.useEffect(()=>{b(!0)},[]);let{label:S,...w}=d()({label:v.formatMessage({id:"cancel"}),color:"primary"},f),{label:z,...k}=d()({label:v.formatMessage({id:"ok"}),color:"primary"},g);e=null!=e?e:v.formatMessage({id:"prompt"});let[Z,M]=m.useState(null!=p?p:""),P=()=>{x(Z)};return m.createElement(o.Z,h({},E,{fullScreen:!1,"data-testid":"popupConfirm",maxWidth:"xs",role:"alertdialog",fullWidth:!0,"aria-modal":!0,variant:"alert"}),m.createElement(s.Z,{id:"dialogTitle","data-testid":"popupTitle"},null!=e?e:"Prompt"),m.createElement(l.Z,{dividers:!1},m.createElement(c.Z,{onChange:e=>M(e.currentTarget.value),autoFocus:!0,defaultValue:p,fullWidth:!0,required:!0,placeholder:a,InputLabelProps:{shrink:!1},variant:"outlined",helperText:u})),m.createElement(n.Z,null,m.createElement(r.Z,h({},k,{role:"button","data-testid":"buttonCancel",tabIndex:0,variant:"contained",size:"medium",color:"primary",disabled:!Z.trim().length,onClick:P,sx:{minWidth:120}}),z),m.createElement(r.Z,h({},w,{role:"button","data-testid":"buttonSubmit",tabIndex:1,variant:"outlined",size:"medium",color:"primary",sx:{minWidth:120},onClick:C}),S)))}},25391:function(e,t,a){a.r(t),a.d(t,{default:function(){return E}});var i=a(85597),r=a(60408),o=a(68450),n=a(29620),l=a(72962),s=a(24498),c=a(77745),p=a(21822),d=a(22949),m=a(12902),h=a(67294),u=a(22410),g=a(73327),f=(0,u.Z)(e=>(0,g.Z)({root:{},actionWrapper:{marginBottom:e.spacing(2),paddingRight:e.spacing(2),"& .MuiButton-root":{marginLeft:e.spacing(1.5)}},suggestionsWrapper:{position:"fixed",zIndex:1,backgroundColor:e.mixins.backgroundColor("paper"),padding:e.spacing(2),borderRadius:"4px",boxShadow:e.shadows[2]},userWrapper:{margin:e.spacing(1,0),minWidth:"385px"},userOuter:{display:"inline-flex",alignItems:"center",padding:e.spacing(.5),color:e.palette.primary.main,border:e.mixins.border("primary"),marginRight:e.spacing(.5),marginBottom:e.spacing(.5),"&:hover":{background:e.palette.primary.main,color:"#fff","& $removeBtn":{color:"#fff"}}},removeBtn:{color:e.palette.primary.main,fontSize:11,margin:e.spacing(0,.5,0,1),cursor:"pointer"},name:{fontSize:e.mixins.pxToRem(13)}}),{name:"DialogCreateCustomListPrivacy"});function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}let y=(0,u.Z)(e=>(0,g.Z)({root:{},mentionSuggestionsWrapper:{position:"absolute",backgroundColor:e.mixins.backgroundColor("paper"),borderRadius:4},mentionOptionWrapper:{display:"flex",alignItems:"center",padding:e.spacing(.5,0),cursor:"pointer"},avatar:{width:32,height:32,borderRadius:"50%"},name:{marginLeft:e.spacing(1),color:e.palette.text.primary,fontSize:e.mixins.pxToRem(13)}}));function x({user:e,...t}){let a=y();return h.createElement("div",v({className:a.root},t),h.createElement("div",{className:a.mentionOptionWrapper},h.createElement("img",{src:e.avatar,alt:e.name,className:a.avatar}),h.createElement("span",{className:a.name},e.name)))}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function E(e){let{customList:t}=e,a=f(),{useDialog:u,i18n:g,apiClient:v}=(0,i.OgA)(),{dialogProps:y,closeDialog:E,setDialogValue:C}=u(),[S,w]=h.useState(""),[z,k]=h.useState([]),[Z,M]=h.useState([]),[P,R]=h.useState({listName:!1,friends:!1}),[W,N]=h.useState(!1),[O,T]=h.useState([]),I=h.useRef(),D=h.useCallback(({value:e})=>{v.request({method:"get",url:"/friend",params:{q:e,limit:6}}).then(e=>{var t,a,i;return(null===(t=e.data)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.length)?null===(i=e.data)||void 0===i?void 0:i.data:[]}).then(e=>{return e.map(e=>({avatar:(0,o.Q4)(e.avatar,"240"),name:e.full_name,link:`/${e.resource_name}/${e.id}`}))}).then(e=>T(e))},[v]),A=()=>{let e=!1;(j(S)||""===S)&&(R(e=>({...e,listName:!0})),e=!0),0===Z.length&&(R(e=>({...e,friends:!0})),e=!0),e||(E(),C(S))},_=e=>{R(e=>({...e,listName:!1}));let t=e.target.value;w(t),j(t)&&R(e=>({...e,listName:!0}))},L=e=>{R(e=>({...e,friends:!1}));let t=e.target.value;k(t),D({value:t}),N(!0)},j=e=>{return t.includes(e)},B=e=>{if(M(t=>[...t,e]),k([]),N(!1),I){var t;null==I||null===(t=I.current)||void 0===t||t.focus()}R(e=>({...e,friends:!1}))},$=e=>{M((0,m.ZP)(Z,t=>{t.splice(e,1)})),0===Z.length&&R(e=>({...e,friends:!0}))};return h.createElement(n.Z,b({},y),h.createElement(c.Z,null,g.formatMessage({id:"create_friends_list"})),h.createElement(s.Z,null,h.createElement(d.Z,{error:P.listName,placeholder:g.formatMessage({id:"list_name"}),label:g.formatMessage({id:"list_name"}),variant:"outlined",fullWidth:!0,margin:"normal",size:"small",value:S,onChange:e=>_(e),autoFocus:!0}),Z&&0<Z.length?h.createElement("div",{className:a.userWrapper},Z.map((e,t)=>h.createElement("div",{key:t.toString(),className:a.userOuter},h.createElement("span",{className:a.name},e.name),h.createElement(r.zb,{icon:"ico-close",className:a.removeBtn,onClick:()=>$(t)})))):null,h.createElement(d.Z,{error:P.friends,placeholder:g.formatMessage({id:"add_friend"}),label:g.formatMessage({id:"add_friend"}),variant:"outlined",fullWidth:!0,margin:"normal",size:"small",multiline:!0,value:z,onChange:e=>L(e),inputRef:I}),W&&h.createElement("div",{className:a.suggestionsWrapper},O?O.map((e,t)=>h.createElement(x,{key:t.toString(),user:e,onClick:()=>B(e)})):null)),h.createElement(l.Z,null,h.createElement("div",{className:a.actionWrapper},h.createElement(p.Z,{variant:"outlined",onClick:E,size:"small"},g.formatMessage({id:"back"})),h.createElement(p.Z,{variant:"contained",onClick:A,size:"small",color:"primary"},g.formatMessage({id:"create"})))))}},11437:function(e,t,a){a.r(t),a.d(t,{default:function(){return R}});var i=a(85597),r=a(92114),o=a(17171),n=a(39628),l=a(1469),s=a.n(l),c=a(41609),p=a.n(c),d=a(96026),m=a.n(d),h=a(21822),u=a(49960),g=a(18037),f=a(52922),v=a(91647),y=a(67294),x=a(12902),b=a(22410),E=a(73327),C=(0,b.Z)(e=>(0,E.Z)({root:{},shareWith:{fontSize:e.mixins.pxToRem(15),color:e.palette.text.primary,fontWeight:e.typography.fontWeightBold,marginBottom:e.spacing(1)},linkContainer:{marginTop:e.spacing(1),display:"flex",alignItems:"center"}}),{name:"DialogCustomListPrivacy"}),S=a(71682),w=(0,b.Z)(e=>(0,E.Z)({root:{height:e.spacing(5),display:"flex",alignItems:"center"},checkbox:{marginRight:e.spacing(1)}}),{name:"DialogCustomListPrivacy"});function z(){let e=w();return y.createElement("div",{className:e.root},y.createElement("div",{className:e.checkbox},y.createElement(S.Z,{variant:"rectangular",width:16,height:16})),y.createElement(S.Z,{variant:"text",width:"50%",height:24}))}var k=a(21241),Z=a(68450);function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}let P=e=>{let t=[];return e.forEach(e=>{(null==e?void 0:e.is_selected)&&t.push(null==e?void 0:e.id)}),t};function R({value:e,feed:t}){let a=C(),{useDialog:l,i18n:c,useFetchItems:d,dispatch:b,getAcl:E}=(0,i.OgA)(),{dialogProps:S,setDialogValue:w,closeDialog:R}=l(),W=(0,i.oHF)("core","privacy","getCustomPrivacyOptions"),N=E("friend.friend_list.create"),[O,T]=d({dataSource:{apiUrl:W.apiUrl,apiParams:(0,Z.aZ)(W.apiParams,t)},normalize:!1}),[I,D]=y.useState(O),[A,_]=y.useState(Array.isArray(e)?e:[]);y.useEffect(()=>{D(O),p()(O)||s()(e)||_(P(O))},[O,e]);let L=()=>{R(),w(A)},j=e=>{_(t=>{return t.find(t=>t==e)?t.filter(t=>t!=e):[...t,e]})},B=y.useCallback(()=>{b({type:"friend/addNewList",meta:{onSuccess:e=>{_(t=>(0,x.ZP)(t,t=>{t.push(e.id)})),D(t=>(0,x.ZP)(t,t=>{t.push(e)}))}}})},[]);return y.createElement(r.Vq,M({},S,{maxWidth:"xs",fullWidth:!0}),y.createElement(r.$N,null,c.formatMessage({id:"custom_privacy"})),y.createElement(r.cZ,null,y.createElement("div",{className:a.shareWith},c.formatMessage({id:"share_with"})),y.createElement(k.l$,{autoHide:!0,autoHeight:!0,autoHeightMax:200},T?m()(1,5).map(e=>y.createElement(z,{key:e.toString()})):y.createElement(f.Z,null,(null==I?void 0:I.length)===0?y.createElement(v.Z,{paragraph:!0,variant:"body1",margin:"0",color:"textSecondary"},c.formatMessage({id:"there_are_no_friend_list"})):null==I?void 0:I.map((e,t)=>y.createElement(g.Z,{checked:-1<A.indexOf(e.id),key:t.toString(),value:e.id,label:e.title,onChange:()=>j(e.id),control:y.createElement(u.Z,{value:e,icon:y.createElement(n.Z,{fontSize:"small"}),checkedIcon:y.createElement(o.Z,{fontSize:"small"}),color:"primary"})})))),y.createElement("div",{className:a.linkContainer},N&&y.createElement(y.Fragment,null,y.createElement(h.Z,{variant:"link",size:"small",color:"primary",onClick:B},c.formatMessage({id:"create_new_custom_list"})),"\xa0",y.createElement("span",null," ",c.formatMessage({id:"or"})," "),"\xa0"),y.createElement(h.Z,{variant:"link",size:"small",href:"/friend",color:"primary"},c.formatMessage({id:"manage_lists"})))),y.createElement(r.kX,null,y.createElement(h.Z,{variant:"outlined",onClick:R,size:"small"},c.formatMessage({id:"cancel"})),y.createElement(h.Z,{variant:"contained",onClick:L,size:"small",color:"primary",disabled:0===A.length},c.formatMessage({id:"save"}))))}},24615:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var i=a(85597),r=a(92114),o=a(68450),n=a(39348),l=a(30120),s=a(22949),c=a(81719),p=a(67294),d=a(21822),m=a(44373),h=a(71682),u=a(91647);function g({item:{title:e,keywords:t,description:a,previewImage:r,name:o},onItemSelected:n,onKeyWorkClicked:s}){let{i18n:c}=(0,i.OgA)();return p.createElement(p.Fragment,null,p.createElement(l.Z,{component:"div",flexDirection:"row",display:"flex"},p.createElement(l.Z,{component:"div",mr:"16px"},p.createElement(h.Z,{component:"div",variant:"rectangular",width:"120px",height:"80px",animation:!1})),p.createElement(l.Z,{sx:{flex:1}},p.createElement(u.Z,{variant:"h4"},null!=e?e:o),p.createElement(u.Z,{variant:"body1"},t),p.createElement(u.Z,{variant:"body1"},a)),p.createElement(l.Z,{sx:{mt:1.5}},p.createElement(d.Z,{onClick:()=>n(o)},c.formatMessage({id:"create_layout_block"})))),p.createElement(m.Z,{style:{margin:"12px 0"}}))}var f=a(44908),v=a.n(f);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}let x=(0,c.ZP)(l.Z,{name:"Editor",slot:"Tag"})(({theme:e})=>({display:"inline-block",color:e.palette.primary.main,cursor:"pointer",fontSize:e.typography.body1.fontSize,background:"#2682d511",margin:"2px",padding:"0 4px",borderRadius:"4px"}));function b(e){let{parentBlockId:t,slotName:a,pageName:c,pageSize:d}=e,{useDialog:m,layoutBackend:h,dispatch:u,i18n:f}=(0,i.OgA)(),{dialogProps:b,closeDialog:E}=m(),[C,S]=p.useState(""),w=h.getAllBlockView(),z=p.useMemo(()=>{let e=[];return Object.values(w).filter(e=>!e.experiment).filter(e=>!e.admincp).forEach(({keywords:t})=>{t&&t.split(",").map(e=>e.trim().toLowerCase()).forEach(t=>e.push(t))}),v()(e).filter(Boolean).sort()},[]),k=e=>{(0,o._v)(150).then(()=>{let i=(0,o.kb)(),r={blockId:i,parentBlockId:t,pageName:c,slotName:a,blockName:e,pageSize:d};h.addBlock(r),u({type:"@layout/editBlock",payload:r})}),E()},Z=p.useMemo(()=>Object.values(w).map(e=>({...e})).filter(e=>!e.experiment).filter(e=>!e.admincp).filter(Boolean),[]),M=p.useMemo(()=>{if(!C)return Z;let e=RegExp((0,o.hr)(C),"i");return Z.filter(t=>{return e.test(t.keywords)||e.test(t.title)||e.test(t.description)})},[Z,C]);return p.createElement(r.Vq,y({},b,{maxWidth:"md",fullWidth:!0}),p.createElement(r.$N,{id:"alert-dialog-title"},f.formatMessage({id:"create_layout_block"})),p.createElement(r.cZ,{sx:{height:"50vh"}},p.createElement(l.Z,{sx:{display:"flex",flexDirection:"row"}},p.createElement(l.Z,{sx:{width:220,mr:2}},p.createElement(n.Z,{sx:{mb:2},freeSolo:!0,options:z,getOptionLabel:e=>e,onChange:(e,t)=>{S(t)},value:C,renderInput:e=>p.createElement(s.Z,y({},e,{hiddenLabel:!0,autoFocus:!0,fullWidth:!0,size:"small",variant:"outlined",placeholder:f.formatMessage({id:"search"})}))}),z.map(e=>{return p.createElement(x,{key:e,onClick:()=>S(e)},e)})),p.createElement(l.Z,{sx:{flex:1}},M.map((e,t)=>p.createElement(g,{key:t.toString(),item:e,onItemSelected:k,onKeyWorkClicked:S}))))))}},59740:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var i=a(85597),r=a(26440),o=a(29620),n=a(67294),l=a(43581);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function c(){let{useDialog:e,i18n:t}=(0,i.OgA)(),{closeDialog:a,dialogProps:c}=e(),p=t.formatMessage({id:"add_new_template"}),d=(0,l.Hy)(p);d.elements.content.elements.name={component:"Text",name:"name",variant:"outlined",margin:"normal",required:!0,defaultValue:"",label:"Template Name",fullWidth:!0},d.elements.footer.elements={cancel:{component:"Button",label:"Cancel",color:"primary",type:"cancel",onClick:a},submit:{component:"Button",label:"Submit",color:"primary",type:"cancel",onClick:a}};let m=()=>{};return n.createElement(o.Z,s({},c),n.createElement(r.qu,{dialog:!0,initialValues:{},formSchema:d,onSubmit:m}))}},50789:function(e,t,a){a.r(t),a.d(t,{ItemView:function(){return f},default:function(){return y}});var i=a(92114),r=a(85597),o=a(21822),n=a(44373),l=a(30030),s=a(30120),c=a(81719),p=a(22410),d=a(73327),m=a(67294);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}let u=(0,c.ZP)(s.Z,{name:"ThemeItem",slot:"Root"})(({theme:e,selected:t})=>({borderRadius:8,overflow:"hidden",border:`2px solid ${t?e.palette.primary.main:"rgba(0,0,0,0.1)"}}`})),g=(0,c.ZP)(s.Z,{name:"ThemeItem",slot:"Content"})(({theme:e})=>({borderRadius:8,display:"block",paddingBottom:"60%",backgroundColor:"rgba(0,0,0,0.1)",backgroundSize:"cover"}));function f({title:e,id:t,image:a,selected:i,onChange:r}){return m.createElement(u,{selected:i},m.createElement(g,{title:e,onClick:()=>r(t),style:{backgroundImage:`url(${a})`}}))}let v=(0,p.Z)(e=>(0,d.Z)({content:{display:"flex",flexWrap:"nowrap",flexDirection:"row"},divider:{marginLeft:e.spacing(2),marginRight:e.spacing(2)},dialogActions:{margin:e.spacing(1),"& button":{width:94,height:40}}}),{name:"ChooseThemeDialog"});function y(){let{useDialog:e,getSetting:t,i18n:a,usePreference:s,preferenceBackend:c}=(0,r.OgA)(),{themeId:p=r.t04}=s(),{dialogProps:d,closeDialog:u,setDialogValue:g}=e(),[y,x]=m.useState(p),b=v(),E=t("layout.variants",[]),C=m.useCallback(()=>{c.setTheme(y),g(y)},[c,g,y]),S=m.useCallback(e=>{x(e)},[]);return m.createElement(i.Vq,h({},d,{maxWidth:"sm","data-testid":"dialogThemePicker"}),m.createElement(i.$N,null,a.formatMessage({id:"choose_your_preferred_theme"})),m.createElement(i.cZ,null,m.createElement("div",{className:b.content},m.createElement(l.ZP,{container:!0,columnSpacing:1,rowSpacing:2},E.map(e=>{var t;return m.createElement(l.ZP,{item:!0,key:null===(t=e.id)||void 0===t?void 0:t.toString(),xs:12},m.createElement(f,h({},e,{image:e.image,selected:e.id===y,onChange:S})))})))),m.createElement(n.Z,{className:b.divider}),m.createElement(i.kX,{className:b.dialogActions},m.createElement(o.Z,{onClick:C,variant:"contained",color:"primary",disabled:!y,"data-testid":"buttonSubmit"},a.formatMessage({id:"apply"})),m.createElement(o.Z,{onClick:u,type:"button",variant:"outlined",color:"primary","data-testid":"buttonCancel"},a.formatMessage({id:"cancel"}))))}},43841:function(e,t,a){a.r(t),a.d(t,{default:function(){return s}});var i=a(85597),r=a(92114),o=a(21822),n=a(67294);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function s(){let{i18n:e,theme:t,useDialog:a}=(0,i.OgA)(),{closeDialog:s,dialogProps:c}=a();return n.createElement(r.Vq,l({},c,{maxWidth:"sm",fullWidth:!0}),n.createElement(r.$N,{id:"alert-dialog-title"},e.formatMessage({id:"layout_inspect_theme"})),n.createElement(r.cZ,null,n.createElement("pre",null,JSON.stringify(t,null,"  "))),n.createElement(r.kX,null,n.createElement(o.Z,{onClick:s,color:"primary",autoFocus:!0,children:e.formatMessage({id:"ok"})})))}},15890:function(e,t,a){a.r(t),a.d(t,{default:function(){return s}});var i=a(85597),r=a(29620),o=a(67294),n=a(26440);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function s({config:e}){let{action_name:t,onSubmit:a}=e||{},{useDialog:s,dispatch:c}=(0,i.OgA)(),{setDialogResolveValue:p,setDialogValue:d,dialogProps:m,forceClose:h}=s(),u=(0,i.oHF)("captcha","captcha","getVerifyForm"),g=(e,t)=>{p(e),c({type:"@waitingCaptchaImage/start",payload:{form:t,forceClose:h}})},f=()=>{d(null)};return o.createElement(r.Z,l({},m,{fullScreen:!1,"data-testid":"dialogCaptchaImage",maxWidth:"xs",fullWidth:!0,"aria-modal":!0}),o.createElement(n.AO,{dataSource:u,onSubmit:a||g,onCancel:f,pageParams:{action_name:t,auto_focus:!0},navigationConfirmWhenDirty:!1,dialog:!0}))}},67430:function(e,t,a){a.r(t),a.d(t,{default:function(){return V},initState:function(){return $}});var i,r=a(85597),o=a(60408),n=a(68450),l=a(21822),s=a(35705),c=a(29620),p=a(77745),d=a(50130),m=a(763),h=a(62097),u=a(61225),g=a(23560),f=a.n(g),v=a(67294);let y=e=>new Promise((t,a)=>{let i=new Image;i.addEventListener("load",()=>t(i)),i.addEventListener("error",e=>a(e)),i.setAttribute("crossOrigin","anonymous"),i.src=e});async function x(e,t,a,i=0,r=!1,o=!1){try{let n=await y(e),l=document.createElement("canvas"),s=l.getContext("2d"),c=Math.max(n.width,n.height),p=2*(c/2*Math.sqrt(2));l.width=p,l.height=p,s.translate(p/2,p/2),s.rotate(i*Math.PI/180),s.scale(r?-1:1,o?-1:1),s.translate(-p/2,-p/2),s.drawImage(n,p/2-.5*n.width,p/2-.5*n.height);let d=s.getImageData(0,0,p,p);if(l.width=t.width,l.height=t.height,s.putImageData(d,Math.round(0-p/2+.5*n.width-t.x),Math.round(0-p/2+.5*n.height-t.y)),"base64"===a)return l.toDataURL("image/jpeg");return new Promise(e=>{l.toBlob(t=>{e(URL.createObjectURL(t))},"image/jpeg")})}catch(m){throw Error(m)}}var b=a(52796),E=a.n(b);function C(e,t,a,i,r=0){let{width:o,height:n}=R(t.width,t.height,r);return{x:S(e.x,o,a.width,i),y:S(e.y,n,a.height,i)}}function S(e,t,a,i){let r=t*i/2-a/2;return Math.min(r,Math.max(e,-r))}function w(e,t){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}function z(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI}function k(e,t){return Math.min(e,Math.max(0,t))}function Z(e,t){return t}function M(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function P(e,t,a,i,r){let o=Math.cos,n=Math.sin,l=r*Math.PI/180,s=(e-a)*o(l)-(t-i)*n(l)+a,c=(e-a)*n(l)+(t-i)*o(l)+i;return[s,c]}function R(e,t,a){let i=e/2,r=t/2,o=[P(0,0,i,r,a),P(e,0,i,r,a),P(e,t,i,r,a),P(0,t,i,r,a)],n=Math.min(...o.map(e=>e[0])),l=Math.max(...o.map(e=>e[0])),s=Math.min(...o.map(e=>e[1])),c=Math.max(...o.map(e=>e[1]));return{width:l-n,height:c-s}}function W(...e){return e.filter(e=>{return"string"==typeof e&&0<e.length}).join(" ").trim()}function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}class O extends(i=v.Component){componentDidMount(){window.addEventListener("resize",this.computeSizes),this.containerRef&&(this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.preventZoomSafari),this.containerRef.addEventListener("gesturechange",this.preventZoomSafari)),this.imageRef&&this.imageRef.complete&&this.onMediaLoad()}componentWillUnmount(){window.removeEventListener("resize",this.computeSizes),this.containerRef&&(this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.containerRef.removeEventListener("gesturechange",this.preventZoomSafari)),this.styleRef&&this.styleRef.remove(),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent()}componentDidUpdate(e){var t,a,i,r,o,n,l,s;e.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):e.aspect!==this.props.aspect?this.computeSizes():e.zoom!==this.props.zoom?this.recomputeCropPosition():(null===(t=e.cropSize)||void 0===t?void 0:t.height)!==(null===(a=this.props.cropSize)||void 0===a?void 0:a.height)||(null===(i=e.cropSize)||void 0===i?void 0:i.width)!==(null===(r=this.props.cropSize)||void 0===r?void 0:r.width)?this.computeSizes():((null===(o=e.crop)||void 0===o?void 0:o.x)!==(null===(n=this.props.crop)||void 0===n?void 0:n.x)||(null===(l=e.crop)||void 0===l?void 0:l.y)!==(null===(s=this.props.crop)||void 0===s?void 0:s.y))&&this.emitCropAreaChange(),e.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent())}getAspect(){let{cropSize:e,aspect:t}=this.props;return e?e.width/e.height:t}onPinchStart(e){let t=O.getTouchPoint(e.touches[0]),a=O.getTouchPoint(e.touches[1]);this.lastPinchDistance=w(t,a),this.lastPinchRotation=z(t,a),this.onDragStart(M(t,a))}onPinchMove(e){let t=O.getTouchPoint(e.touches[0]),a=O.getTouchPoint(e.touches[1]),i=M(t,a);this.onDrag(i),this.rafPinchTimeout&&window.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=window.requestAnimationFrame(()=>{let e=w(t,a),r=this.props.zoom*(e/this.lastPinchDistance);this.setNewZoom(r,i),this.lastPinchDistance=e;let o=z(t,a),n=this.props.rotation+(o-this.lastPinchRotation);this.props.onRotationChange&&this.props.onRotationChange(n),this.lastPinchRotation=o})}render(){let{image:e,video:t,mediaProps:a,transform:i,crop:{x:r,y:o},rotation:n,zoom:l,flipHorizontal:s=!1,flipVertical:c=!1,cropShape:p,showGrid:d,style:{containerStyle:m,cropAreaStyle:h,mediaStyle:u},classes:{containerClassName:g,cropAreaClassName:f,mediaClassName:y}}=this.props,x=c?-1:1,b=s?-1:1;return v.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:e=>this.containerRef=e,"data-testid":"container",style:m,className:W("reactEasyCrop_Container",g)},e?v.createElement("img",N({alt:"",className:W("reactEasyCrop_Image",y)},a,{src:e,ref:e=>this.imageRef=e,style:{...u,transform:i||`translate(${r}px, ${o}px) rotate(${n}deg) scale(${l*x}, ${l*b})`},onLoad:this.onMediaLoad})):t&&v.createElement("video",N({autoPlay:!0,loop:!0,muted:!0,className:W("reactEasyCrop_Video",y)},a,{src:t,ref:e=>this.videoRef=e,onLoadedMetadata:this.onMediaLoad,style:{...u,transform:i||`translate(${r}px, ${o}px) rotate(${n}deg) scale(${l*x}, ${l*b})`},controls:!1})),this.state.cropSize&&v.createElement("div",{style:{...h,width:this.state.cropSize.width,height:this.state.cropSize.height},"data-testid":"cropper",className:W("reactEasyCrop_CropArea","round"===p&&"reactEasyCrop_CropAreaRound",d&&"reactEasyCrop_CropAreaGrid",f)}))}constructor(...e){super(...e),this.imageRef=null,this.videoRef=null,this.containerRef=null,this.styleRef=null,this.containerRect=null,this.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},this.dragStartPosition={x:0,y:0},this.dragStartCrop={x:0,y:0},this.lastPinchDistance=0,this.lastPinchRotation=0,this.rafDragTimeout=null,this.rafPinchTimeout=null,this.wheelTimer=null,this.state={cropSize:null,hasWheelJustStarted:!1},this.preventZoomSafari=e=>e.preventDefault(),this.cleanEvents=()=>{document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onDragStopped),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onDragStopped)},this.clearScrollEvent=()=>{this.containerRef&&this.containerRef.removeEventListener("wheel",this.onWheel),this.wheelTimer&&clearTimeout(this.wheelTimer)},this.onMediaLoad=()=>{this.computeSizes(),this.emitCropData(),this.setInitialCrop(),this.props.onMediaLoaded&&this.props.onMediaLoaded(this.mediaSize)},this.setInitialCrop=()=>{let{initialCroppedAreaPixels:e,cropSize:t}=this.props;if(!e)return;let{crop:a,zoom:i}=function(e,t,a){let i=t.width/t.naturalWidth,r=function(e,t,a){let i=t.width/t.naturalWidth;if(a){let r=a.height>a.width;return r?a.height/i/e.height:a.width/i/e.width}let o=e.width/e.height,n=t.naturalWidth>=t.naturalHeight*o;return n?t.naturalHeight/e.height:t.naturalWidth/e.width}(e,t,a),o=i*r,n={x:((t.naturalWidth-e.width)/2-e.x)*o,y:((t.naturalHeight-e.height)/2-e.y)*o};return{crop:n,zoom:r}}(e,this.mediaSize,t);this.props.onCropChange(a),this.props.onZoomChange&&this.props.onZoomChange(i)},this.computeSizes=()=>{let e=this.imageRef||this.videoRef;if(e&&this.containerRef){var t,a,i,r,o,n;this.containerRect=this.containerRef.getBoundingClientRect(),this.mediaSize={width:e.offsetWidth,height:e.offsetHeight,naturalWidth:(null===(t=this.imageRef)||void 0===t?void 0:t.naturalWidth)||(null===(a=this.videoRef)||void 0===a?void 0:a.videoWidth)||0,naturalHeight:(null===(i=this.imageRef)||void 0===i?void 0:i.naturalHeight)||(null===(r=this.videoRef)||void 0===r?void 0:r.videoHeight)||0};let l=this.props.cropSize?this.props.cropSize:function(e,t,a,i,r,o=0){let{width:n,height:l}=R(e,t,o),s=Math.min(n,a),c=Math.min(l,i);return s>c*r?{width:c*r,height:c}:{width:s,height:s/r}}(e.offsetWidth,e.offsetHeight,this.containerRect.width,this.containerRect.height,this.props.aspect,this.props.rotation);((null===(o=this.state.cropSize)||void 0===o?void 0:o.height)!==l.height||(null===(n=this.state.cropSize)||void 0===n?void 0:n.width)!==l.width)&&this.props.onCropSizeChange&&this.props.onCropSizeChange(l),this.setState({cropSize:l},this.recomputeCropPosition)}},this.onMouseDown=e=>{e.preventDefault(),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onDragStopped),this.onDragStart(O.getMousePoint(e))},this.onMouseMove=e=>this.onDrag(O.getMousePoint(e)),this.onTouchStart=e=>{e.preventDefault(),document.addEventListener("touchmove",this.onTouchMove,{passive:!1}),document.addEventListener("touchend",this.onDragStopped),2===e.touches.length?this.onPinchStart(e):1===e.touches.length&&this.onDragStart(O.getTouchPoint(e.touches[0]))},this.onTouchMove=e=>{e.preventDefault(),2===e.touches.length?this.onPinchMove(e):1===e.touches.length&&this.onDrag(O.getTouchPoint(e.touches[0]))},this.onDragStart=({x:e,y:t})=>{var a,i;this.dragStartPosition={x:e,y:t},this.dragStartCrop={...this.props.crop},null===(i=(a=this.props).onInteractionStart)||void 0===i||i.call(a)},this.onDrag=({x:e,y:t})=>{this.rafDragTimeout&&window.cancelAnimationFrame(this.rafDragTimeout),this.rafDragTimeout=window.requestAnimationFrame(()=>{if(!this.state.cropSize||void 0===e||void 0===t)return;let a=e-this.dragStartPosition.x,i=t-this.dragStartPosition.y,r={x:this.dragStartCrop.x+a,y:this.dragStartCrop.y+i},o=this.props.restrictPosition?C(r,this.mediaSize,this.state.cropSize,this.props.zoom,this.props.rotation):r;this.props.onCropChange(o)})},this.onDragStopped=()=>{var e,t;this.cleanEvents(),this.emitCropData(),null===(t=(e=this.props).onInteractionEnd)||void 0===t||t.call(e)},this.onWheel=e=>{e.preventDefault();let t=O.getMousePoint(e),{pixelY:a}=E()(e),i=this.props.zoom-a*this.props.zoomSpeed/200;this.setNewZoom(i,t),this.state.hasWheelJustStarted||this.setState({hasWheelJustStarted:!0},()=>{var e,t;return null===(t=(e=this.props).onInteractionStart)||void 0===t?void 0:t.call(e)}),this.wheelTimer&&clearTimeout(this.wheelTimer),this.wheelTimer=window.setTimeout(()=>{return this.setState({hasWheelJustStarted:!1},()=>{var e,t;return null===(t=(e=this.props).onInteractionEnd)||void 0===t?void 0:t.call(e)})},250)},this.getPointOnContainer=({x:e,y:t})=>{if(!this.containerRect)throw Error("The Cropper is not mounted");return{x:this.containerRect.width/2-(e-this.containerRect.left),y:this.containerRect.height/2-(t-this.containerRect.top)}},this.getPointOnMedia=({x:e,y:t})=>{let{crop:a,zoom:i}=this.props;return{x:(e+a.x)/i,y:(t+a.y)/i}},this.setNewZoom=(e,t)=>{if(!this.state.cropSize||!this.props.onZoomChange)return;let a=this.getPointOnContainer(t),i=this.getPointOnMedia(a),r=Math.min(this.props.maxZoom,Math.max(e,this.props.minZoom)),o={x:i.x*r-a.x,y:i.y*r-a.y},n=this.props.restrictPosition?C(o,this.mediaSize,this.state.cropSize,r,this.props.rotation):o;this.props.onCropChange(n),this.props.onZoomChange(r)},this.getCropData=()=>{if(!this.state.cropSize)return null;let e=this.props.restrictPosition?C(this.props.crop,this.mediaSize,this.state.cropSize,this.props.zoom,this.props.rotation):this.props.crop;return function(e,t,a,i,r,o=0,n=!0){let l=n&&0===o?k:Z,s={x:l(100,((t.width-a.width/r)/2-e.x/r)/t.width*100),y:l(100,((t.height-a.height/r)/2-e.y/r)/t.height*100),width:l(100,a.width/t.width*100/r),height:l(100,a.height/t.height*100/r)},c=Math.round(l(t.naturalWidth,s.width*t.naturalWidth/100)),p=Math.round(l(t.naturalHeight,s.height*t.naturalHeight/100)),d=t.naturalWidth>=t.naturalHeight*i,m=d?{width:Math.round(p*i),height:p}:{width:c,height:Math.round(c/i)},h={...m,x:Math.round(l(t.naturalWidth-m.width,s.x*t.naturalWidth/100)),y:Math.round(l(t.naturalHeight-m.height,s.y*t.naturalHeight/100))};return{croppedAreaPercentages:s,croppedAreaPixels:h}}(e,this.mediaSize,this.state.cropSize,this.getAspect(),this.props.zoom,this.props.rotation,this.props.restrictPosition)},this.emitCropData=()=>{let e=this.getCropData();if(!e)return;let{croppedAreaPercentages:t,croppedAreaPixels:a}=e;this.props.onCropComplete&&this.props.onCropComplete(t,a),this.props.onCropAreaChange&&this.props.onCropAreaChange(t,a)},this.emitCropAreaChange=()=>{let e=this.getCropData();if(!e)return;let{croppedAreaPercentages:t,croppedAreaPixels:a}=e;this.props.onCropAreaChange&&this.props.onCropAreaChange(t,a)},this.recomputeCropPosition=()=>{if(!this.state.cropSize)return;let e=this.props.restrictPosition?C(this.props.crop,this.mediaSize,this.state.cropSize,this.props.zoom,this.props.rotation):this.props.crop;this.props.onCropChange(e),this.emitCropData()}}}O.defaultProps={zoom:1,rotation:0,aspect:4/3,flipVertical:!1,flipHorizontal:!1,maxZoom:3,minZoom:1,cropShape:"rect",showGrid:!0,style:{},classes:{},mediaProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0},O.getMousePoint=e=>({x:Number(e.clientX),y:Number(e.clientY)}),O.getTouchPoint=e=>({x:Number(e.clientX),y:Number(e.clientY)});var T=a(12902),I=a(18446),D=a.n(I);let A=(0,T.ZP)((e,t)=>{switch(t.type){case"setCrop":e.crop=t.payload;break;case"setFlipVertical":e.flipVertical=!e.flipVertical;break;case"setFlipHorizontal":e.flipHorizontal=!e.flipHorizontal;break;case"pendingSave":e.isLoading=!0;break;case"fullfilSave":e.isLoading=!1,e.isDirty=!1,e.isSuccess=!0;return;case"rejectSave":e.isLoading=!1;break;case"updateFile":e.imageSrc=t.payload,e.rotation=$.rotation,e.crop=$.crop,e.zoom=$.zoom;break;case"setImgSource":e.imageSrc=t.payload;break;case"setZoom":{let{mode:a,zoom:i}=t.payload;if(i){e.zoom=i;break}let r=0;"minus"===a&&(r=1<e.zoom-.2?e.zoom-.2:1),"plus"===a&&(r=3>e.zoom+.2?e.zoom+.2:3),e.zoom=r;break}case"setCroppedAreaPixels":e.croppedAreaPixels=t.payload;break;case"setRotation":e.rotation=t.payload}let o={crop:e.crop,flipVertical:e.flipVertical,flipHorizontal:e.flipHorizontal,rotation:e.rotation,zoom:e.zoom,imageSrc:e.imageSrc},n={crop:$.crop,flipVertical:$.flipVertical,flipHorizontal:$.flipHorizontal,rotation:$.rotation,zoom:$.zoom,imageSrc:$.imageSrc};e.isDirty=!D()(n,o)});var _=a(22410),L=a(73327),j=(0,_.Z)(e=>(0,L.Z)({avatarWrapper:{marginTop:-96,marginRight:e.spacing(3),position:"relative"},userAvatar:{width:168,height:168,border:"4px solid",borderColor:e.palette.background.paper},btnClose:{background:"none",boxShadow:"none",padding:0,fontSize:e.mixins.pxToRem(18),minWidth:"1px",color:`${e.palette.text.secondary} !important`,marginRight:`${e.spacing(-1)} !important`,marginLeft:"auto !important",width:e.spacing(4),height:e.spacing(4),borderRadius:e.spacing(4),"&:hover":{background:e.palette.background.default,color:"#fff"}},btnControl:{background:"none",boxShadow:"none",padding:0,fontSize:e.mixins.pxToRem(18),minWidth:e.spacing(4),color:`${e.palette.text.primary} !important`,width:e.spacing(4),height:e.spacing(4),borderRadius:e.spacing(4),"&:hover":{background:"rgba(5, 5, 5, 0.04)",color:e.palette.text.primary,boxShadow:"none"}},btnEditAvatar:{backgroundColor:e.palette.background.paper,textTransform:"capitalize",position:"absolute",top:e.spacing(1),right:e.spacing(1),minWidth:32,height:32,borderRadius:"100%","&:hover":{backgroundColor:e.palette.background.default}},sliderZoom:{margin:e.spacing(0,2)},iconEdit:{},cropDialog:{"& .MuiDialog-paper":{overflowY:"visible"}},titleDialog:{fontWeight:e.typography.fontWeightBold,color:e.palette.text.primary,fontSize:e.mixins.pxToRem(18),padding:e.spacing(2),display:"flex",justifyContent:"space-between",alignItems:"center"},cropContainer:{[e.breakpoints.down("sm")]:{width:"100%"}},cropContent:{position:"relative",height:400,"& .reactEasyCrop_CropArea":{border:"none",color:"rgba(255,255,255,.3)"}},controls:{padding:e.spacing(1),display:"flex"},btnActions:{padding:e.spacing(1),display:"flex",justifyContent:"flex-end","& .Mui-disabled":{..."dark"===e.palette.mode&&{color:`${e.palette.text.hint} !important`}}},btnAction:{margin:`${e.spacing(1)} !important`},btnContainer:{padding:e.spacing(0,1),display:"flex",flexGrow:1,alignItems:"center",maxWidth:500,margin:"auto",justifyContent:"center",marginBottom:e.spacing(2),"& button":{padding:e.spacing(1,2),margin:e.spacing(0,1),whiteSpace:"nowrap",fontWeight:"normal",color:e.palette.text.primary}},sliderContainer:{padding:e.spacing(0,1),display:"flex",flexGrow:1,alignItems:"center",maxWidth:400,margin:"auto"},sliderLabel:{"& + span":{marginLeft:e.spacing(2)}},btnChangePhoto:{position:"relative",overflow:"hidden"},inputFile:{position:"absolute",opacity:0,left:0,top:0,right:0,bottom:0,cursor:"pointer"},cropBackdrop:{top:0,left:0,right:0,bottom:0,display:"flex",overflow:"hidden",position:"absolute",textAlign:"center",alignItems:"center",justifyContent:"center",backgroundColor:e.mixins.backgroundColor("paper")},cropBlurContent:{filter:"blur(10px)",transform:"scale(12)"},blurImage:{width:"100%",height:"100%",objectFit:"cover",border:0}}),{name:"MuiUserAvatarPhoto"});function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}let $={crop:{x:0,y:0},zoom:1,flipHorizontal:!1,flipVertical:!1,rotation:0,isDirty:!1,isLoading:!1,croppedAreaPixels:null,isSuccess:!1},H=e=>{return new Promise(t=>{let a=new FileReader;a.addEventListener("load",()=>t(a.result),!1),a.readAsDataURL(e)})},F=({onUpdate:e,item:t,avatar:a})=>{let i=j(),g=(0,h.Z)(),y=v.useRef(null),[b,E]=v.useState(null),{i18n:C,dispatch:S,dialogBackend:w,useDialog:z,useLimitFileSize:k}=(0,r.OgA)(),{dialogProps:Z,setUserConfirm:M,closeDialog:P}=z(),{photo:R}=k(),W=(0,u.Z)(g.breakpoints.down("sm")),N=(0,n.Q4)(null==t?void 0:t.avatar);a&&(N=(0,n.Q4)(a)),$.imageSrc=N;let[T,I]=(0,v.useReducer)(A,{...$}),[D,_]=v.useState(!N),{crop:L,zoom:F,rotation:V,flipHorizontal:q,flipVertical:G,imageSrc:U,croppedAreaPixels:X,isLoading:J,isDirty:Y,isSuccess:Q}=T;(0,v.useEffect)(()=>{M(()=>{if(Y)return{message:"Are you sure you want to discard the changes?"}})},[M,Y]),(0,v.useEffect)(()=>{Q&&P()},[Q,P]);let K=(e,t)=>{I({type:"setCroppedAreaPixels",payload:t})},ee=()=>{let e=360<=T.rotation+90?0:T.rotation+90;I({type:"setRotation",payload:e})},et=async()=>{I({type:"pendingSave"});try{let i=await x(U,X,"base64",V,G,q);i&&S({type:"updateProfileUserAvatar",payload:{avatar:b,avatar_crop:i,userId:null==t?void 0:t.id,identity:null==t?void 0:t._identity},meta:{onSuccess:()=>{I({type:"fullfilSave"})},onFailure:()=>{w.alert({title:"Error",message:"Ops! Something wrong"}),I({type:"rejectSave"})}}}),f()(e)&&e(a)}catch(r){w.alert({title:"Error",message:"Ops! Picture format is not correct."}),I({type:"rejectSave"})}},ea=async e=>{if(e.target.files&&0<e.target.files.length){let t=e.target.files[0],a=t.size;if(a>R&&0!==R){w.alert({message:C.formatMessage({id:"warning_upload_limit_one_file"},{fileName:(0,n.TX)(t.name,30),fileSize:(0,n.jA)(t.size),maxSize:(0,n.jA)(R)})});return}E(t);let i=await H(t);I({type:"updateFile",payload:i})}},ei=()=>{y.current.click()},er=()=>{window.addEventListener("focus",eo)},eo=()=>{setTimeout(()=>{_(!1)},500),window.removeEventListener("focus",eo)};return((0,v.useEffect)(()=>{D&&ei()},[D]),U)?v.createElement(c.Z,B({},Z,{className:i.cropDialog,"aria-labelledby":"dialog-title",maxWidth:"sm",fullWidth:!0,scroll:"body",fullScreen:W}),v.createElement(p.Z,{id:"dialog-title"},C.formatMessage({id:"update_your_profile_picture"}),v.createElement(d.Z,{size:"small",className:i.btnClose,disabled:J,onClick:P},v.createElement(o.zb,{icon:"ico-close"}))),v.createElement("div",{className:i.cropContainer},v.createElement("div",{className:i.cropContainer},v.createElement("div",{className:i.cropContent},v.createElement("div",{className:i.cropBackdrop},v.createElement("div",{className:i.cropBlurContent},v.createElement("img",{crossOrigin:"anonymous",src:U,alt:"",className:i.blurImage}))),v.createElement(O,{image:U,crop:L,zoom:F,aspect:1,flipHorizontal:q,flipVertical:G,onCropChange:e=>I({type:"setCrop",payload:e}),onCropComplete:K,onZoomChange:e=>I({type:"setZoom",payload:{zoom:e}}),rotation:V,showGrid:!1,cropShape:"round"})),!(0,n.Mf)(U)&&v.createElement(v.Fragment,null,v.createElement("div",{className:i.controls},v.createElement("div",{className:i.sliderContainer},v.createElement(l.Z,{variant:"text",className:i.btnControl,onClick:()=>I({type:"setZoom",payload:{mode:"minus"}})},v.createElement(o.zb,{icon:"ico-minus"})),v.createElement(m.ZP,{className:i.sliderZoom,value:F,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:(e,t)=>I({type:"setZoom",payload:{zoom:t}})}),v.createElement(l.Z,{variant:"text",className:i.btnControl,onClick:()=>I({type:"setZoom",payload:{mode:"plus"}})},v.createElement(o.zb,{icon:"ico-plus"})))),v.createElement("div",{className:i.btnContainer},v.createElement(l.Z,{startIcon:v.createElement(o.zb,{icon:"ico-rotate-right-alt"}),onClick:ee},C.formatMessage({id:"rotate"})),v.createElement(l.Z,{startIcon:v.createElement(o.zb,{icon:"ico-flip-v"}),onClick:()=>I({type:"setFlipVertical"})},C.formatMessage({id:"flip_vertical"})),v.createElement(l.Z,{startIcon:v.createElement(o.zb,{icon:"ico-flip-h"}),onClick:()=>I({type:"setFlipHorizontal"})},C.formatMessage({id:"flip_horizontal"})))),v.createElement("div",{className:i.btnActions},v.createElement("div",{className:i.btnChangePhoto},v.createElement("input",{type:"file",onChange:ea,accept:"image/*",className:i.inputFile,ref:y}),v.createElement(l.Z,{variant:"outlined",disabled:J,className:i.btnAction,size:"small",onClick:ei},C.formatMessage({id:"change_photo"}))),v.createElement(l.Z,{variant:"contained",className:i.btnAction,disabled:!Y,onClick:et,size:"small"},J?v.createElement(s.Z,{color:"inherit",size:"1rem"}):C.formatMessage({id:"save"})))))):D?v.createElement("input",{type:"file",onChange:ea,accept:"image/*",style:{display:"none"},ref:y,onClick:er}):null};var V=F},81154:function(e,t,a){a.r(t);var i=a(92114),r=a(85597),o=a(60408),n=a(44373),l=a(92351),s=a(67294),c=a(68450);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}t.default=function(){let e=(0,l.Z)(),{useDialog:t,i18n:a,useSession:d,jsxBackend:m,getSetting:h,getAcl:u}=(0,r.OgA)(),{dialogProps:g}=t(),{user:f}=d(),v=(0,r.oRt)("core","accountMenu"),[y]=(0,r.zXz)(null,{}),x=a.formatMessage({id:"profile"}),b=h(),E=u(),C=d(),S=(0,c.W$)(v.items,{setting:b,acl:E,session:C});return s.createElement(i.Vq,p({},g,{fullWidth:!0,"data-testid":"popupProfileMenu",fullScreen:!0}),s.createElement(i.$N,{"data-testid":"popupTitle",enableBack:!0,disableClose:!0},x),s.createElement(i.cZ,{className:e.dialog},s.createElement("div",{className:e.profile},s.createElement(n.Z,p({},{variant:"fullWidth"})),s.createElement("div",{className:e.userBlock},s.createElement("div",{className:e.userAvatar},s.createElement(o.Yt,{user:f,size:48})),s.createElement("div",{className:e.userInner},s.createElement("div",{className:e.userName},f.full_name),s.createElement(r.rUS,{className:e.linkInfo,to:f.link},a.formatMessage({id:"view_profile"})))),S.filter(Boolean).map((e,t)=>m.render({component:`menuItem.as.${e.as||"normal"}`,props:{key:t.toString(),item:e,variant:"contained",handleAction:y}})))))}},92351:function(e,t,a){var i=a(22410),r=a(73327);let o=(0,i.Z)(e=>{var t,a,i;return(0,r.Z)({blockHeader:{minHeight:60},menuWrapper:{display:"flex",height:60,boxShadow:"0px 2px 1px 0 rgba(0, 0, 0, 0.05)",backgroundColor:e.mixins.backgroundColor("paper"),position:"fixed",left:0,right:0,top:0,zIndex:1300},menuButton:{flex:"1",minWidth:"64px",display:"flex",alignItems:"center",justifyContent:"center",color:e.palette.text.secondary,borderBottom:"solid 2px #fff"},active:{color:`${e.palette.primary.main} !important`,borderBottomColor:e.palette.primary.main},menuButtonIcon:{width:"24px",height:"24px",fontSize:"24px"},menuInner:{position:"relative"},number:{width:20,height:20,backgroundColor:e.palette.error.main,color:"#fff",fontSize:e.mixins.pxToRem(13),borderRadius:"50%",display:"flex",justifyContent:"center",position:"absolute",top:-10,right:-10},dot:{width:8,height:8,backgroundColor:e.palette.error.main,borderRadius:"50%",position:"absolute",top:0,right:-4},logo:{height:"35px",display:"inline-block"},menuGuestWrapper:{display:"flex",alignItems:"center",justifyContent:"space-between",height:"60px",boxShadow:"0px 2px 1px 0 rgba(0, 0, 0, 0.05)",backgroundColor:e.mixins.backgroundColor("paper"),padding:e.spacing(0,2),position:"fixed",left:0,right:0,top:0,zIndex:2,"& $menuButton":{flex:"none"}},button:{fontSize:15,height:32,padding:e.spacing(0,3),textTransform:"capitalize"},popover:{"& .MuiPopover-paper":{maxWidth:"100%",width:"100%",borderRadius:0,top:"60px !important",bottom:0,boxShadow:"none !important",borderTop:`solid 1px ${null===(t=e.palette.border)||void 0===t?void 0:t.secondary}`,marginTop:"-1px"}},dropdownMenuWrapper:{width:"100%",minHeight:"calc(100vh - 60px)"},menuItem:{color:e.palette.text.primary,padding:e.spacing(1.5,2)},menuItemLink:{padding:0},link:{color:e.palette.text.primary,textDecoration:"none",padding:e.spacing(1.5,2),display:"block",flexGrow:1},icon:{textAlign:"center",marginRight:e.spacing(1.5)},toggleDarkMode:{fontSize:"32px",marginLeft:"auto",lineHeight:"20px",width:"32px",height:"20px",color:e.palette.text.disabled},userBlock:{display:"flex",alignItems:"center",padding:e.spacing(2),borderBottom:`solid 1px ${null===(a=e.palette.border)||void 0===a?void 0:a.secondary}`},userAvatar:{width:48,marginRight:e.spacing(1)},userInner:{flex:1,minWidth:0},userName:{fontSize:e.mixins.pxToRem(18),lineHeight:1.5,color:e.palette.text.primary,fontWeight:"bold"},linkInfo:{fontSize:e.mixins.pxToRem(15),lineHeight:1,color:e.palette.text.secondary},userAction:{marginLeft:"auto","& > .ico":{width:32,height:32,fontSize:e.mixins.pxToRem(24),color:e.palette.text.secondary,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"}},profile:{},menuApp:{borderTop:"solid 8px",borderTopColor:null===(i=e.palette.border)||void 0===i?void 0:i.secondary,paddingTop:16,"& ul":{marginLeft:e.spacing(-1),paddingBottom:e.spacing(4)},"& ul > li":{marginLeft:0,marginRight:0,marginBottom:e.spacing(1),paddingLeft:0,"& > a":{display:"flex",padding:e.spacing(1),fontSize:"0.9375rem",alignItems:"center",fontWeight:"bold"}}},dialog:{padding:"0 !important"},searchMobile:{display:"block",zIndex:"1301",position:"absolute",backgroundColor:e.palette.background.paper,top:"0",width:"100%",height:"100%","& > div":{width:"100%"},"& form":{width:"calc(100% - 96px)"}},cancelButton:{position:"absolute",zIndex:"1",right:"16px",top:"50%",transform:"translateY(-50%)"}})},{name:"SiteBarMobileBlock"});t.Z=o},24656:function(e,t,a){a.r(t),a.d(t,{default:function(){return s}});var i=a(92114),r=a(85597),o=a(21822),n=a(67294);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function s(){let{useDialog:e}=(0,r.OgA)(),{pathname:t}=(0,r.THL)(),{dialogProps:a,setDialogValue:s}=e(),c=({payload:e,type:t="@core/codeGenerate/make",children:a})=>{return n.createElement(o.Z,{onClick:()=>s({type:t,payload:e})},a)};return n.createElement(i.Vq,l({},a,{maxWidth:"xs",fullWidth:!0}),n.createElement(i.$N,null,"Code Generator"),n.createElement(i.cZ,null,n.createElement(c,{payload:"package"},"New App"),n.createElement(c,{payload:"migration"},"Migration"),n.createElement(c,{payload:"model"},"Model"),n.createElement(c,{payload:"web-api"},"Web API"),n.createElement(c,{payload:"admin-api"},"Admin API"),n.createElement(c,{payload:"form"},"Forms"),n.createElement(c,{payload:"request"},"Request"),n.createElement(c,{payload:"category"},"Category"),n.createElement(c,{payload:"data-grid"},"DataGrid"),n.createElement(c,{payload:"listener"},"Listener"),n.createElement(c,{payload:"notification"},"Notification"),n.createElement(c,{payload:"job"},"Job"),n.createElement(c,{payload:"mail"},"Mail"),n.createElement(c,{payload:"export"},"Export"),n.createElement(c,{payload:"inspect"},"Inspect"),n.createElement(c,{payload:"importer"},"Importer"),n.createElement(o.Z,{onClick:()=>s({type:"@core/codeGenerate/editCurrentSeo",payload:{url:t.replace(/^\/|\/$/g,"")}})},"Edit Meta"),n.createElement(o.Z,{onClick:()=>s({type:"@core/codeGenerate/ideFix"})},"IDE Fix")))}},4159:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var i=a(85597),r=a(92114),o=a(60408),n=a(41609),l=a.n(n),s=a(67294),c=a(73327),p=a(61366),d=a(94184),m=a.n(d);let h=e=>{var t;return(0,c.Z)({root:{borderBottom:"1px solid",borderBottomColor:null===(t=e.palette.border)||void 0===t?void 0:t.secondary,padding:e.spacing(2),display:"flex",alignItems:"flex-start","&:hover":{backgroundColor:e.palette.action.hover}},info:{display:"flex",flexDirection:"column"},title:{flex:1,fontSize:e.mixins.pxToRem(15),fontWeight:e.typography.fontWeightBold,color:e.palette.text.primary},icon:{fontSize:e.mixins.pxToRem(18),marginRight:e.spacing(2),marginTop:e.spacing(.5),color:e.palette.text.secondary},address:{fontSize:e.mixins.pxToRem(13),color:e.palette.text.secondary,marginRight:e.spacing(2)},media:{},active:{color:e.palette.primary.main,"& $icon":{color:e.palette.primary.main}}})};var u=(0,p.Z)(h)(function({name:e,address:t,classes:a,active:i,onClick:r}){return s.createElement("div",{role:"button","aria-label":"select place","data-testid":"suggestion",className:m()([a.root,i&&a.active]),onClick:r},s.createElement(o.zb,{icon:"ico-checkin-o",className:a.icon}),s.createElement("div",{className:a.info},s.createElement("span",{className:m()([a.title,i&&a.active])},e),t?s.createElement("div",{className:m()([a.address,i&&a.active]),children:t}):null))}),g=(0,a(22410).Z)(e=>(0,c.Z)({dialog:{},dialogContent:{height:370,padding:`${e.spacing(0,0,2,0)} !important`},inputStage:{padding:e.spacing(2)},btnCancel:{minWidth:e.spacing(3),padding:0,marginRight:e.spacing(1),color:e.palette.text.secondary},searchIcon:{color:e.palette.text.secondary},dialogTitle:{},dialogContentTitle:{color:e.palette.text.secondary,padding:e.spacing(.5,0,.5,2),textTransform:"uppercase"},mapStage:{}}));function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}var v=function({defaultValue:e}){let t=g(),{useDialog:a,i18n:n}=(0,i.OgA)(),{dialogProps:c,setDialogValue:p}=a(),d=n.formatMessage({id:"search_for_location"}),m=n.formatMessage({id:"search_dots"}),h=s.useRef(),[v,y,x,b]=(0,i.$Cd)(h,{...e,address:""}),E=s.useCallback(e=>x(e),[x]),C=e=>{p({...e,query:y})},S=()=>{p(!1)};return s.createElement(r.Vq,f({className:t.dialog,maxWidth:"sm",fullWidth:!0,"data-testid":"dialogLocationPicker"},c),s.createElement(r.$N,{"data-testid":"popupTitle",enableBack:!0,disableClose:!0},d),s.createElement("div",{className:t.inputStage},s.createElement(o.mN,{autoFocus:!0,"data-testid":"searchBox",placeholder:m,onChanged:E})),s.createElement(r.cZ,{className:t.dialogContent},s.createElement("div",{className:t.dialogContentTitle},n.formatMessage({id:"base_on_your_location"})),s.createElement("div",{className:t.mapStage,ref:h}),!l()(b)&&!y&&s.createElement(u,{active:!0,name:b.name,address:b.address,onClick:S}),!!(null==v?void 0:v.length)&&v.map((e,t)=>{return e.lat===(null==b?void 0:b.lat)&&e.lng===(null==b?void 0:b.lng)?null:s.createElement(u,{name:e.name,address:e.address,key:t.toString(),onClick:()=>C(e)})})))}},18661:function(e,t,a){a.r(t),a.d(t,{default:function(){return s}});var i=a(85597),r=a(92114),o=a(26440),n=a(67294);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function s({title:e="Edit",maxWidth:t="sm",...a}){let{useDialog:s}=(0,i.OgA)(),c=s(),{dialogProps:p}=c;return n.createElement(r.Vq,l({},p,{maxWidth:t,fullWidth:!0,"data-testid":"editPopup"}),n.createElement(o.dq,l({dialog:!0,dialogTitle:e,dialogItem:c},a)))}},55502:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var i=a(85597),r=a(92114),o=a(60408),n=a(81674),l=a(86010),s=a(67294),c=a(22410),p=a(73327);let d=(0,c.Z)(e=>(0,p.Z)({root:{display:"flex",position:"relative"},titleDialog:{display:"flex",alignItems:"center"},closeDialog:{color:e.palette.text.secondary,fontSize:e.mixins.pxToRem(13),marginLeft:"auto",cursor:"pointer"},searchFocused:{border:e.mixins.border("primary"),background:"none"},searchIcon:{top:0,width:e.mixins.pxToRem(32),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",transition:"all .2s ease",cursor:"pointer"},searchIconFocused:{color:e.palette.primary.main},inputRoot:{color:"inherit",width:"100%"},inputInput:{padding:e.spacing(1,2,1,0),boxSizing:"border-box",paddingLeft:"30px !important",transition:"all .2s ease",width:"100%",height:e.mixins.pxToRem(32)}}),{name:"SearchInModule"});var m=a(17563);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function u({title:e,placeholder:t,item:a}){let{useDialog:c,navigate:p}=(0,i.OgA)(),{dialogProps:u,closeDialog:g}=c(),f=d(),[v,y]=(0,s.useState)(!1),[x,b]=(0,s.useState)(""),E=()=>{y(!0)},C=()=>{y(!1)},S=e=>{let{value:t}=e.target;b(t)},w=e=>{let t=null==e?void 0:e.keyCode;13===t&&(e.preventDefault(),z())},z=()=>{let e=x.trim();if(!e)return;let{id:t,module_name:i}=a;p({pathname:`/${i}/search/${t}`,search:m.stringify({q:e})}),g()};return s.createElement(r.Vq,h({},u,{maxWidth:"sm",fullWidth:!0,fullScreen:!1,"data-testid":"dialogSearchInApp"}),s.createElement(r.$N,null,s.createElement("div",{className:f.titleDialog},e)),s.createElement(r.cZ,{className:f.root},s.createElement("div",{className:(0,l.default)(f.searchIcon,v&&f.searchIconFocused)},s.createElement(o.zb,{icon:"ico-search-o"})),s.createElement(n.ZP,{placeholder:t,classes:{root:f.inputRoot,input:f.inputInput},value:x,name:"searchBox",autoComplete:"off",autoCapitalize:"off",inputProps:{"aria-label":"search","data-testid":"search_box_in_module"},onFocus:E,onChange:S,onKeyDown:w,onBlur:C})))}}}]);