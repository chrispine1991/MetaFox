"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-photo-components-UploadMultiPhoto-UploadMultiPhotoField"],{42853:function(e,r,t){t.d(r,{Z:function(){return z}});var o,a=t(63366),i=t(87462),l=t(67294),n=t(86010),s=t(94780),d=t(56594),u=t(59711),c=t(81719),m=t(36622),p=t(1588),f=t(34867);function h(e){return(0,f.Z)("MuiFormHelperText",e)}let v=(0,p.Z)("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var g=t(78884),b=t(85893);let Z=["children","className","component","disabled","error","filled","focused","margin","required","variant"],x=e=>{let{classes:r,contained:t,size:o,disabled:a,error:i,filled:l,focused:n,required:d}=e,u={root:["root",a&&"disabled",i&&"error",o&&`size${(0,m.Z)(o)}`,t&&"contained",n&&"focused",l&&"filled",d&&"required"]};return(0,s.Z)(u,h,r)},y=(0,c.ZP)("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,r)=>{let{ownerState:t}=e;return[r.root,t.size&&r[`size${(0,m.Z)(t.size)}`],t.contained&&r.contained,t.filled&&r.filled]}})(({theme:e,ownerState:r})=>(0,i.Z)({color:(e.vars||e).palette.text.secondary},e.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${v.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${v.error}`]:{color:(e.vars||e).palette.error.main}},"small"===r.size&&{marginTop:4},r.contained&&{marginLeft:14,marginRight:14})),k=l.forwardRef(function(e,r){let t=(0,g.Z)({props:e,name:"MuiFormHelperText"}),{children:l,className:s,component:c="p"}=t,m=(0,a.Z)(t,Z),p=(0,u.Z)(),f=(0,d.Z)({props:t,muiFormControl:p,states:["variant","size","disabled","error","filled","focused","required"]}),h=(0,i.Z)({},t,{component:c,contained:"filled"===f.variant||"outlined"===f.variant,variant:f.variant,size:f.size,disabled:f.disabled,error:f.error,filled:f.filled,focused:f.focused,required:f.required}),v=x(h);return(0,b.jsx)(y,(0,i.Z)({as:c,ownerState:h,className:(0,n.default)(v.root,s),ref:r},m,{children:" "===l?o||(o=(0,b.jsx)("span",{className:"notranslate",children:"​"})):l}))});var z=k},47546:function(e,r,t){var o=t(63366),a=t(87462),i=t(67294),l=t(86010),n=t(94780),s=t(56594),d=t(59711),u=t(36622),c=t(78884),m=t(81719),p=t(65410),f=t(85893);let h=["children","className","color","component","disabled","error","filled","focused","required"],v=e=>{let{classes:r,color:t,focused:o,disabled:a,error:i,filled:l,required:s}=e,d={root:["root",`color${(0,u.Z)(t)}`,a&&"disabled",i&&"error",l&&"filled",o&&"focused",s&&"required"],asterisk:["asterisk",i&&"error"]};return(0,n.Z)(d,p.M,r)},g=(0,m.ZP)("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:e},r)=>{return(0,a.Z)({},r.root,"secondary"===e.color&&r.colorSecondary,e.filled&&r.filled)}})(({theme:e,ownerState:r})=>(0,a.Z)({color:(e.vars||e).palette.text.secondary},e.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${p.Z.focused}`]:{color:(e.vars||e).palette[r.color].main},[`&.${p.Z.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${p.Z.error}`]:{color:(e.vars||e).palette.error.main}})),b=(0,m.ZP)("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,r)=>r.asterisk})(({theme:e})=>({[`&.${p.Z.error}`]:{color:(e.vars||e).palette.error.main}})),Z=i.forwardRef(function(e,r){let t=(0,c.Z)({props:e,name:"MuiFormLabel"}),{children:i,className:n,component:u="label"}=t,m=(0,o.Z)(t,h),p=(0,d.Z)(),Z=(0,s.Z)({props:t,muiFormControl:p,states:["color","required","focused","disabled","error","filled"]}),x=(0,a.Z)({},t,{color:Z.color||"primary",component:u,disabled:Z.disabled,error:Z.error,filled:Z.filled,focused:Z.focused,required:Z.required}),y=v(x);return(0,f.jsxs)(g,(0,a.Z)({as:u,ownerState:x,className:(0,l.default)(y.root,n),ref:r},m,{children:[i,Z.required&&(0,f.jsxs)(b,{ownerState:x,"aria-hidden":!0,className:y.asterisk,children:[" ","*"]})]}))});r.Z=Z},65410:function(e,r,t){t.d(r,{M:function(){return i}});var o=t(1588),a=t(34867);function i(e){return(0,a.Z)("MuiFormLabel",e)}let l=(0,o.Z)("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]);r.Z=l},84917:function(e,r,t){t.d(r,{Z:function(){return k}});var o=t(63366),a=t(87462),i=t(67294),l=t(94780),n=t(86010),s=t(56594),d=t(59711),u=t(47546),c=t(65410),m=t(78884),p=t(81719),f=t(1588),h=t(34867);function v(e){return(0,h.Z)("MuiInputLabel",e)}(0,f.Z)("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);var g=t(85893);let b=["disableAnimation","margin","shrink","variant","className"],Z=e=>{let{classes:r,formControl:t,size:o,shrink:i,disableAnimation:n,variant:s,required:d}=e,u=(0,l.Z)({root:["root",t&&"formControl",!n&&"animated",i&&"shrink","small"===o&&"sizeSmall",s],asterisk:[d&&"asterisk"]},v,r);return(0,a.Z)({},r,u)},x=(0,p.ZP)(u.Z,{shouldForwardProp:e=>(0,p.FO)(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,r)=>{let{ownerState:t}=e;return[{[`& .${c.Z.asterisk}`]:r.asterisk},r.root,t.formControl&&r.formControl,"small"===t.size&&r.sizeSmall,t.shrink&&r.shrink,!t.disableAnimation&&r.animated,r[t.variant]]}})(({theme:e,ownerState:r})=>(0,a.Z)({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},r.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===r.size&&{transform:"translate(0, 17px) scale(1)"},r.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!r.disableAnimation&&{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})},"filled"===r.variant&&(0,a.Z)({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===r.size&&{transform:"translate(12px, 13px) scale(1)"},r.shrink&&(0,a.Z)({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===r.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===r.variant&&(0,a.Z)({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===r.size&&{transform:"translate(14px, 9px) scale(1)"},r.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 24px)",transform:"translate(14px, -9px) scale(0.75)"}))),y=i.forwardRef(function(e,r){let t=(0,m.Z)({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,shrink:l,className:u}=t,c=(0,o.Z)(t,b),p=(0,d.Z)(),f=l;void 0===f&&p&&(f=p.filled||p.focused||p.adornedStart);let h=(0,s.Z)({props:t,muiFormControl:p,states:["size","variant","required"]}),v=(0,a.Z)({},t,{disableAnimation:i,formControl:p,shrink:f,size:h.size,variant:h.variant,required:h.required}),y=Z(v);return(0,g.jsx)(x,(0,a.Z)({"data-shrink":f,ownerState:v,ref:r,className:(0,n.default)(y.root,u)},c,{classes:y}))});var k=y},90798:function(e,r,t){t.d(r,{Z:function(){return n}});var o=t(67294),a=t(13218),i=t.n(a);let l=e=>{return e?i()(e)?l(Object.values(e)[0]):e.toString():null};function n({error:e,className:r="invalid-feedback order-last"}){return e?o.createElement("div",{"data-testid":"error",className:r},l(e)):null}},97252:function(e,r,t){var o=t(27274),a=t(81719),i=t(67294);let l=(0,a.ZP)("div",{name:"MultipleUploadField",slot:"PreviewImg",shouldForwardProp:e=>"radio"!==e})(({theme:e,radio:r})=>({position:"absolute",left:0,top:0,right:0,bottom:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"auto 100%",maxWidth:"100%",...r&&"horizontal"===r&&{backgroundSize:"cover"}})),n=({item:e})=>{let[r,t]=i.useState({}),a=(e,r)=>{try{let t=new Image;t.src=r,t.onload=()=>{e({height:t.height,width:t.width})},t.onerror=e=>{}}catch(o){}},n=(null==e?void 0:e.source)||e.image_url||(0,o.Q4)(null==e?void 0:e.image,"1024");i.useEffect(()=>{a(t,n)},[]);let s="horizontal";return s=r&&r.width/r.height<=1?"vertical":"horizontal",i.createElement(l,{radio:s,style:{backgroundImage:`url(${n})`}})};r.Z=n},28715:function(e,r,t){t.r(r),t.d(r,{default:function(){return R}});var o=t(90798),a=t(85597),i=t(77029),l=t(21822),n=t(17888),s=t(30030),d=t(38790),u=t(42853),c=t(84917),m=t(81719),p=t(18948),f=t(68929),h=t.n(f),v=t(41609),g=t.n(v),b=t(67294),Z=t(97252),x=t(2597),y=t(27274);let k=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"Control",shouldForwardProp:e=>"haveError"!==e})(({theme:e,haveError:r})=>({height:120,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",border:e.mixins.border("secondary"),borderColor:"light"===e.palette.mode?"#0000003b":"rgba(255, 255, 255, 0.23)","& .ico-photos-plus-o":{fontSize:`${e.mixins.pxToRem(15)} !important`},"&:hover":{borderColor:"light"===e.palette.mode?"#000":"#fff"},"& button":{[e.breakpoints.down("sm")]:{flexDirection:"column",height:"auto",maxWidth:"calc(100% - 40px)",padding:"10px"}},...r&&{borderColor:`${e.palette.error.main} !important`}})),z=(0,m.ZP)(l.Z,{name:"DropButton",slot:"DropButton"})(({theme:e,isOver:r})=>({...r&&{backgroundColor:e.palette.action.hover}})),E=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"PreviewItem"})(({theme:e})=>({width:"100%",paddingBottom:"56%",borderRadius:8,background:e.palette.grey.A700,position:"relative",overflow:"hidden"})),M=(0,m.ZP)("video",{name:"MultipleUploadField",slot:"PreviewVideo"})({position:"absolute",left:0,top:0,right:0,bottom:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",maxWidth:"100%"}),w=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"removeBtn"})(({theme:e})=>({width:e.spacing(3),height:e.spacing(3),borderRadius:e.spacing(1.5),backgroundColor:"rgba(0,0,0,0.89)",color:"#fff",position:"absolute",top:e.spacing(2),right:e.spacing(2),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"})),P=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"AddMoreBtnWrapper"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",border:e.mixins.border("primary"),borderRadius:e.shape.borderRadius,height:"100%"})),S=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"PreviewVideoWrapper"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",height:"100%"})),_=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"MaskPlay"})(({theme:e})=>({position:"absolute",width:e.spacing(5),height:e.spacing(5),color:"#fff",backgroundColor:"rgba(0,0,0,0.4)",borderRadius:"50%",left:"50%",top:"50%",marginLeft:e.spacing(-2.5),marginTop:e.spacing(-2.5),display:"flex",alignItems:"center",justifyContent:"center",fontSize:e.mixins.pxToRem(24)})),F=(0,m.ZP)(c.Z,{name:"Label"})(({theme:e,haveError:r})=>({padding:e.spacing(0,1),background:e.palette.background.paper,...r&&{color:e.palette.error.main}}));function R({name:e,formik:r,acceptTypeFile:t,config:l}){let{accept:c,upload_url:m,item_type:f,max_upload_filesize:v,description:R,label:C,isVideoUploadAllowed:I,acceptFail:q,required:j}=l,{i18n:$}=(0,a.OgA)(),[,,{setValue:A}]=(0,p.U$)("fileItemType"),[L,U,{setValue:O}]=(0,p.U$)(null!=e?e:"ItemPhotoField"),W=(0,b.useRef)(),[T,N,B]=(0,x.Z)({initialValues:L.value||[],upload_url:m,maxSizeLimit:v,isAcceptVideo:I,messageAcceptFail:q,accept:t||c,inputRef:W}),D=l.placeholder||"add_photo",H=e=>N(r=>r.filter(r=>r.uid!==e)),V=e=>{N(r=>r.map(r=>{return r.id===e?{...r,status:"remove"}:r}))};b.useEffect(()=>{g()(T)&&A(void 0);let e=T.map(e=>({...e,file_type:e.type,fileItemType:f,status:e.status||"update"}));O(e)},[T]);let K=()=>{W.current.click()},Q=e=>{e.length&&B(e)},X=()=>{let e=W.current.files;e.length&&(A(f),B(Object.values(e)),(null==W?void 0:W.current)&&(W.current.value=null))},G=Boolean(U.error&&(U.touched||r.submitCount)),J=T.filter(e=>"remove"!==e.status),Y=null==J?void 0:J.length;return b.createElement(b.Fragment,null,b.createElement(n.Z,{required:j,error:G,fullWidth:!0,margin:"normal"},b.createElement(F,{haveError:G,required:j,variant:"outlined",shrink:"true"},l.label),Y?b.createElement(s.ZP,{container:!0,columnSpacing:1,rowSpacing:1},b.createElement(s.ZP,{item:!0,sm:6,md:3},b.createElement(i.Kb,{style:{height:"100%"},onDrop:e=>Q(e),render:({canDrop:e,isOver:r})=>b.createElement(P,null,b.createElement(z,{size:"large",color:"primary",isOver:r,startIcon:b.createElement(i.zb,{icon:"ico-photos-plus-o"}),sx:{fontWeight:"bold"},onClick:K},C))})),null==J?void 0:J.map(e=>{var r;return b.createElement(s.ZP,{item:!0,key:e.uid,sm:6,md:3,xs:6},b.createElement(E,null,(0,y.yh)(null==e?void 0:null===(r=e.file)||void 0===r?void 0:r.type)?b.createElement(S,null,b.createElement(M,{src:null==e?void 0:e.source,controls:!1}),b.createElement(_,null,b.createElement(i.zb,{icon:"ico-play"}))):b.createElement(Z.Z,{item:e}),b.createElement(d.Z,{title:$.formatMessage({id:"remove"})},b.createElement(w,{onClick:()=>e.uid?H(e.uid):V(e.id)},b.createElement(i.zb,{icon:"ico-close"})))))})):b.createElement(i.Kb,{onDrop:e=>Q(e),render:({canDrop:r,isOver:t})=>b.createElement(k,{haveError:G,role:"button",onClick:K},b.createElement(z,{size:"small",color:"primary",isOver:t,variant:"outlined","data-testid":h()(`field ${e}`),startIcon:b.createElement(i.zb,{icon:"ico-photos-plus-o"})},$.formatMessage({id:D})))}),b.createElement("input",{ref:W,type:"file","aria-hidden":!0,className:"srOnly",multiple:!0,accept:t||c,onChange:X})),R?b.createElement(u.Z,null,R):null,G?b.createElement(o.Z,{error:U.error}):null)}},2597:function(e,r,t){t.d(r,{Z:function(){return c}});var o=t(85597),a=t(67294),i=t(41609),l=t.n(i),n=t(73955),s=t.n(n),d=t(27274);let u=(e,r)=>{let t=!0;if(l()(e))return!0;if(l()(r))return!1;let o=r.split(",");return o.some(r=>e.match(r))&&(t=!1),t};function c({initialValues:e,upload_url:r="",maxSizeLimit:t,isAcceptVideo:i=!0,messageAcceptFail:n,accept:c,inputRef:m}){let{dialogBackend:p,i18n:f}=(0,o.OgA)(),h=a.useRef(!0),[v,g]=a.useState([]),[b,Z]=a.useState(e||[]),x=(null==t?void 0:t.photo)||(null==t?void 0:t.other)||0,y=(null==t?void 0:t.video)||(null==t?void 0:t.other)||0,k=e=>{let t=[],o=[];for(let a=0;a<e.length;++a){let l=e[a],h=l.size,v=(0,d.yh)(null==l?void 0:l.type)?y:x,g={id:0,uid:s()(),source:URL.createObjectURL(l),file_name:l.name,file_size:l.size,file_type:l.type,file:l,upload_url:r,type:l.type.match("image/*")?"photo":"video",status:"create"};if("video"===g.type&&!i||u(null==l?void 0:l.type,c)){p.alert({message:n||f.formatMessage({id:"photo_accept_type_fail"})}),(null==m?void 0:m.current)&&(m.current.value=null);break}h>v&&0!==v?(g.max_size=v,o.push(g)):t.push(g)}if(t.length&&Z(e=>[...e||[],...t]),o.length>0){var b;p.alert({message:1===o.length?f.formatMessage({id:"warning_upload_limit_one_file"},{fileName:(0,d.TX)(o[0].file_name,30),fileSize:(0,d.jA)(o[0].file_size),maxSize:(0,d.jA)(null===(b=o[0])||void 0===b?void 0:b.max_size)}):f.formatMessage({id:"warning_upload_limit_multi_file"},{numberFile:o.length,photoMaxSize:(0,d.jA)(x),videoMaxSize:(0,d.jA)(y)})})}};return(0,a.useEffect)(()=>{if(h.current=!0,!l()(v))return k(v),()=>{h.current=!1}},[v]),[b,Z,g]}}}]);