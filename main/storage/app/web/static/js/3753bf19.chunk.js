"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-feed-blocks-StatusComposer-Block"],{14527:function(e,t,a){a.d(t,{Z:function(){return P}});var n=a(52886),r=a(85597),i=a(21241),o=a(77029),l=a(27274),s=a(30120),p=a(81719),c=a(61225),d=a(62097),m=a(41609),u=a.n(m),f=a(67294),g=a(18974),v=a(74996),h=a(50130);function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}let y=(0,p.ZP)(h.Z,{name:"StatusControl",slot:"Control"})(({theme:e})=>({width:32,height:32,fontSize:e.mixins.pxToRem(20),[e.breakpoints.up("sm")]:{width:44,height:44}}));function x({icon:e,...t}){return f.createElement(y,b({color:"primary"},t),f.createElement(o.zb,{icon:e}))}var k=a(84116);let C="block",E=(0,p.ZP)("div",{name:"AvatarWrapper"})(({theme:e})=>({marginRight:e.spacing(1.5)})),w=(0,p.ZP)("div",{name:"ComposerWrapper"})(({theme:e})=>({display:"flex",width:"100%",alignItems:"center",[e.breakpoints.down("sm")]:{display:"block",width:"100%"}})),_=(0,p.ZP)("div",{name:"ComposerInput"})(({theme:e})=>({border:e.mixins.border("secondary"),flex:1,backgroundColor:e.palette.action.hover,height:e.spacing(6),borderRadius:24,padding:e.spacing(0,3),cursor:"pointer",color:e.palette.text.secondary,fontSize:e.mixins.pxToRem(15),fontWeight:e.typography.fontWeightRegular,letterSpacing:0,WebkitBoxOrient:"vertical",WebkitLineClamp:"1",display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",lineHeight:e.mixins.pxToRem(48),"*":{margin:"0 !important"},[e.breakpoints.down("sm")]:{height:e.spacing(4),lineHeight:e.mixins.pxToRem(32),padding:e.spacing(0,2)}})),Z=(0,p.ZP)("div",{name:"ComposerToolbar"})(({theme:e})=>({display:"flex",marginLeft:e.spacing(1.5),".ico-videocam-o":{fontSize:"24px"},[e.breakpoints.down("sm")]:{marginLeft:e.spacing(0),marginTop:e.spacing(1.5),"& > *":{marginRight:`${e.spacing(1.5)} !important`}}})),S=(0,p.ZP)("div",{name:"ComposerToolbarExpand"})(({theme:e})=>{var t;return{display:"flex",borderTop:"solid 1px",borderTopColor:null===(t=e.palette.border)||void 0===t?void 0:t.secondary,marginTop:e.spacing(2),marginLeft:e.spacing(8),paddingTop:e.spacing(1)}});function P({item:e,title:t,variant:a,blockProps:p,showWhen:m}){var h,b;let y;let[P,,T]=(0,v.Z)(),{i18n:W,useSession:O,dispatch:R,jsxBackend:z,usePageParams:j,getAcl:A,getSetting:H}=(0,r.OgA)(),I=(0,d.Z)(),L=(0,c.Z)(I.breakpoints.down("sm")),U=A(),$=A("activity.feed.create"),B=H(),{user:D,loggedIn:M}=O(),Y=j(),q=W.formatMessage({id:"what_s_your_mind"},{user:null==D?void 0:D.first_name}),V=(0,r.z88)("formValues.dialogStatusComposer")||q,{identity:F,item_type:G}=Y,J=F?F.split(".")[3]:"",K="user"===G&&J&&(null==D?void 0:D.id)!==parseInt(J);f.useEffect(()=>{M&&R({type:"setting/sharingItemPrivacy/FETCH",payload:{id:D.id}})},[M]),T.current.requestComposerUpdate=f.useCallback(()=>{setImmediate(()=>{let{attachmentType:e,attachments:t}=T.current.state;R({type:"statusComposer/onPress/status",payload:{data:{attachmentType:e,attachments:{[e]:t[e]}},parentIdentity:F,parentType:G}})})},[T,R,F,G]);let N=(0,n.q)(F,G);N&&(null==e?void 0:e.privacy_detail)&&(y={privacy_detail:e.privacy_detail});let Q=()=>{R({type:"statusComposer/onPress/status",payload:{parentIdentity:F,parentType:G,data:y}})},X=()=>{T.current.removeAttachments()},ee=f.useMemo(()=>({strategy:C,acl:U,setting:B,isUserProfileOther:K,item:e,parentType:G}),[U,B,K,e,G]),et=(0,l.W$)(g.Z.attachers,ee);if(u()(D)||!$||(null==e?void 0:null===(h=e.profile_settings)||void 0===h?void 0:h.profile_view_profile)===!1||(null==e?void 0:null===(b=e.profile_settings)||void 0===b?void 0:b.feed_share_on_wall)===!1)return null;let ea=!!(0,l.W$)([{showWhen:m}],{item:e}).length;if(!ea)return null;if("expanded"===a)return f.createElement(i.gO,{testid:"blockStatusComposer"},f.createElement(i.ti,{title:t}),f.createElement(i.sU,null,f.createElement(s.Z,{display:"flex",flexDirection:"row"},f.createElement(E,null,f.createElement(o.Yt,{user:D,size:L?32:48,"data-testid":"userAvatar"})),f.createElement(_,{"data-testid":"whatsHappening",color:"info",onClick:Q},f.createElement(k.ZP,{html:V}))),f.createElement(S,{onClick:X},et.map(t=>z.render({component:t.as,props:{key:t.as,strategy:C,composerRef:T,composerState:P,control:x,subject:e}})))));let en=L?et:et.slice(0,3);return f.createElement(i.gO,{testid:"blockStatusComposer"},f.createElement(i.ti,{title:t}),f.createElement(i.sU,null,f.createElement(s.Z,{display:"flex",flexDirection:"row"},f.createElement(E,null,f.createElement(o.Yt,{user:D,size:L?32:48,"data-testid":"userAvatar"})),f.createElement(w,null,f.createElement(_,{"data-testid":"whatsHappening",onClick:Q},f.createElement(k.ZP,{html:V})),f.createElement(Z,{onClick:X},en.map(t=>z.render({component:t.as,props:{key:t.as,strategy:C,composerRef:T,composerState:P,control:x,subject:e}})))))))}},48501:function(e,t,a){a.r(t);var n=a(85597),r=a(14527);let i=(0,n.Uh$)((0,n.YUM)(r.Z,()=>{}));t.default=(0,n.j4Z)({extendBlock:i,name:"StatusComposer",defaults:{variant:"default",title:"Status Composer",blockLayout:"Status Composer"},custom:{variant:{name:"variant",component:"Select",label:"Variant",fullWidth:!0,margin:"normal",variant:"outlined",options:[{label:"Default",value:"default"},{label:"Expanded",value:"expanded"}]}}})}}]);