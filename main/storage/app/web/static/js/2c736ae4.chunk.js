"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-announcement-blocks-AnnouncementListing-Block"],{82710:function(e,n,t){t.r(n),t.d(n,{default:function(){return b}});var l=t(85597),a=t(27361),r=t.n(a),i=t(86706),o=t(22222);let c=e=>r()(e,"announcement.entities.announcement",{}),s=(0,o.P1)(c,e=>e);var u=t(21241),m=t(77029),d=t(50130),p=t(81719),g=t(67294),v=t(46066);function f(){return(f=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e}).apply(this,arguments)}t(16651),t(91259);let h=(0,p.ZP)("div",{name:"NavButtonWrapper",shouldForwardProp:e=>"themeId"!==e})(({theme:e,themeId:n})=>({color:e.palette.primary.main,display:"flex",alignItems:"center","& > span":{fontSize:e.mixins.pxToRem(18),cursor:"pointer","&:hover":{color:e.palette.primary.dark}}})),E=(0,p.ZP)("div",{name:"SlideCount"})(({theme:e})=>({fontSize:e.mixins.pxToRem(15),color:e.palette.text.secondary,marginLeft:e.spacing(1.5),marginRight:e.spacing(1.5)})),k=(0,p.ZP)("span",{shouldForwardProp:e=>"isRead"!==e})(({theme:e,isRead:n})=>({right:e.spacing(2),bottom:e.spacing(2),position:"absolute",color:e.palette.primary.main,borderBottom:"solid 1px transparent",userSelect:"none","&:hover":{borderBottom:`solid 1px ${e.palette.primary.main}`,cursor:"pointer"},...n&&{color:e.palette.grey["400"],"&:hover":{}}})),y=(0,p.ZP)(u.sU)(({theme:e})=>({"& .slick-list":{marginBottom:e.spacing(2.5)}}));var b=(0,l.j4Z)({extendBlock:function({title:e}){let n=g.useRef(),{jsxBackend:t,useTheme:a}=(0,l.OgA)(),[r,o]=g.useState(!0),{i18n:c,dispatch:p}=(0,l.OgA)(),[b,S]=g.useState(0),[_,w]=g.useState(0),[x,A]=g.useState(!1),[C,O]=g.useState(),{direction:P}=a()||{};g.useEffect(()=>{A(!0),p({type:"announcement/getAnnouncementList",meta:{onSuccess:({data:e,meta:n})=>{A(!e),O(n)}}})},[]);let R=(0,i.v9)(s),Z=Object.values(R).filter(e=>!(e.can_be_closed&&e.is_read)),z=e=>{0!==e&&n.current.click()},B=t.get("announcement.itemView.mainCard"),L=t.get("announcement.itemView.mainCard.skeleton"),T=Z[_],j=()=>{T&&(T.is_read||p({type:"announcement/markAsRead",payload:{id:T.id,isDetail:!1},meta:{onSuccess:()=>{S(e=>e+1)}}}))},M=e=>{let{onClick:n,currentSlide:t}=e,{usePreference:a}=(0,l.OgA)(),{themeId:r}=a();return g.createElement(h,{themeId:r,dir:P},g.createElement(m.zb,{icon:"rtl"===P?"ico-angle-right":"ico-angle-left",onClick:()=>z(t)}),g.createElement(E,null,t+1,"/",(null==C?void 0:C.total)-b),g.createElement(m.zb,{icon:"rtl"===P?"ico-angle-left":"ico-angle-right",onClick:n}))},I=e=>{let{onClick:t}=e;return g.createElement("div",{style:{display:"none"},onClick:t,ref:n})},F=(e,n)=>{var t,l;w(n);let a=null===(l=null==C?void 0:C.links[(null==C?void 0:null===(t=C.links)||void 0===t?void 0:t.length)-1])||void 0===l?void 0:l.url;a&&(null==C?void 0:C.total)>(null==C?void 0:C.per_page)&&(null==C?void 0:C.total)>Z.length&&n+3===Z.length-1&&p({type:"announcement/getAnnouncementPage",payload:a})},U={dots:!1,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,useTransform:!1,adaptiveHeight:!0,nextArrow:g.createElement(M,null),prevArrow:g.createElement(I,null),beforeChange:F},V=g.useCallback(()=>o(e=>!e),[]);return x?g.createElement(u.gO,null,g.createElement(u.ti,null,g.createElement(u.bi,null,c.formatMessage({id:e}))),g.createElement(u.sU,null,g.createElement(L,null))):Z.length?g.createElement(u.gO,null,g.createElement(u.ti,null,g.createElement(u.bi,null,c.formatMessage({id:e})),g.createElement(d.Z,{size:"small",color:"default",onClick:V},g.createElement(m.zb,{icon:r?"ico-angle-up":"ico-angle-down"}))),r?g.createElement(y,null,g.createElement(v.Z,f({},U),Z.length&&Z.map(e=>g.createElement("div",{dir:P,key:e.id.toString()},g.createElement(B,{identity:`announcement.entities.announcement.${e.id}`})))),g.createElement(k,{isRead:null==T?void 0:T.is_read,onClick:j},(null==T?void 0:T.is_read)?c.formatMessage({id:"i_have_read_this"}):c.formatMessage({id:"mark_as_read"}))):null):null},name:"AnnouncementListing",defaults:{gridLayout:"Announcement - Slider",itemLayout:"Announcement - Slider"},overrides:{showWhen:["truthy","acl.announcement.announcement.view"]}})}}]);