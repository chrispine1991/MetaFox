(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-chatplus-components-ChatRoomPanel-Block","metafox-chatplus-components-Avatar","metafox-chatplus-components-MsgContent-MessageText"],{6867:function(e,t,n){"use strict";n.d(t,{Z:function(){return R}});var r=n(63366),l=n(87462),i=n(67294),a=n(86010),o=n(2097),s=n(94780),d=n(1588),c=n(34867);function u(e){return(0,c.Z)("MuiBadge",e)}(0,d.Z)("MuiBadge",["root","badge","invisible"]);var p=n(34261),m=n(85893);let g=["badgeContent","component","children","invisible","max","slotProps","slots","showZero"],h=e=>{let{invisible:t}=e;return(0,s.Z)({root:["root"],badge:["badge",t&&"invisible"]},u,void 0)},f=i.forwardRef(function(e,t){let{component:n,children:i,max:a=99,slotProps:s={},slots:d={},showZero:c=!1}=e,u=(0,r.Z)(e,g),{badgeContent:f,max:v,displayValue:b,invisible:y}=function(e){let{badgeContent:t,invisible:n=!1,max:r=99,showZero:l=!1}=e,i=(0,o.Z)({badgeContent:t,max:r}),a=n;!1!==n||0!==t||l||(a=!0);let{badgeContent:s,max:d=r}=a?i:e,c=s&&Number(s)>d?`${d}+`:s;return{badgeContent:s,invisible:a,max:d,displayValue:c}}((0,l.Z)({},e,{max:a})),x=(0,l.Z)({},e,{badgeContent:f,invisible:y,max:v,showZero:c}),w=h(x),E=n||d.root||"span",P=(0,p.Z)({elementType:E,externalSlotProps:s.root,externalForwardedProps:u,additionalProps:{ref:t},ownerState:x,className:w.root}),Z=d.badge||"span",k=(0,p.Z)({elementType:Z,externalSlotProps:s.badge,ownerState:x,className:w.badge});return(0,m.jsxs)(E,(0,l.Z)({},P,{children:[i,(0,m.jsx)(Z,(0,l.Z)({},k,{children:b}))]}))});var v=n(81719),b=n(78884),y=n(69633),x=n(36622);function w(e){return(0,c.Z)("MuiBadge",e)}let E=(0,d.Z)("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),P=["anchorOrigin","className","component","components","componentsProps","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],Z=e=>{let{color:t,anchorOrigin:n,invisible:r,overlap:l,variant:i,classes:a={}}=e,o={root:["root"],badge:["badge",i,r&&"invisible",`anchorOrigin${(0,x.Z)(n.vertical)}${(0,x.Z)(n.horizontal)}`,`anchorOrigin${(0,x.Z)(n.vertical)}${(0,x.Z)(n.horizontal)}${(0,x.Z)(l)}`,`overlap${(0,x.Z)(l)}`,"default"!==t&&`color${(0,x.Z)(t)}`]};return(0,s.Z)(o,w,a)},k=(0,v.ZP)("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),C=(0,v.ZP)("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${(0,x.Z)(n.anchorOrigin.vertical)}${(0,x.Z)(n.anchorOrigin.horizontal)}${(0,x.Z)(n.overlap)}`],"default"!==n.color&&t[`color${(0,x.Z)(n.color)}`],n.invisible&&t.invisible]}})(({theme:e,ownerState:t})=>(0,l.Z)({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:20,lineHeight:1,padding:"0 6px",height:20,borderRadius:10,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen})},"default"!==t.color&&{backgroundColor:(e.vars||e).palette[t.color].main,color:(e.vars||e).palette[t.color].contrastText},"dot"===t.variant&&{borderRadius:4,height:8,minWidth:8,padding:0},"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${E.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${E.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${E.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap&&{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${E.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${E.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${E.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}},"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${E.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}},"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap&&{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${E.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}},t.invisible&&{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})})),M=i.forwardRef(function(e,t){var n,i,s,d,c,u;let p;let g=(0,b.Z)({props:e,name:"MuiBadge"}),{anchorOrigin:h={vertical:"top",horizontal:"right"},className:v,component:x="span",components:w={},componentsProps:E={},overlap:M="rectangular",color:R="default",invisible:S=!1,max:O,badgeContent:_,slots:I,slotProps:A,showZero:z=!1,variant:T="standard"}=g,F=(0,r.Z)(g,P),B=(0,o.Z)({anchorOrigin:h,color:R,overlap:M,variant:T}),$=S;!1!==S||(0!==_||z)&&(null!=_||"dot"===T)||($=!0);let{color:W=R,overlap:j=M,anchorOrigin:L=h,variant:D=T}=$?B:g,H=(0,l.Z)({},g,{anchorOrigin:L,invisible:$,color:W,overlap:j,variant:D}),N=Z(H);"dot"!==D&&(p=_&&Number(_)>O?`${O}+`:_);let U=null!=(n=null!=(i=null==I?void 0:I.root)?i:w.Root)?n:k,Y=null!=(s=null!=(d=null==I?void 0:I.badge)?d:w.Badge)?s:C,V=null!=(c=null==A?void 0:A.root)?c:E.root,X=null!=(u=null==A?void 0:A.badge)?u:E.badge;return(0,m.jsx)(f,(0,l.Z)({invisible:S,badgeContent:p,showZero:z,max:O},F,{slots:{root:U,badge:Y},className:(0,a.default)(null==V?void 0:V.className,N.root,v),slotProps:{root:(0,l.Z)({},V,(0,y.Z)(U)&&{as:x,ownerState:(0,l.Z)({},null==V?void 0:V.ownerState,{anchorOrigin:L,color:W,overlap:j,variant:D})}),badge:(0,l.Z)({},X,{className:(0,a.default)(N.badge,null==X?void 0:X.className)},(0,y.Z)(Y)&&{ownerState:(0,l.Z)({},null==X?void 0:X.ownerState,{anchorOrigin:L,color:W,overlap:j,variant:D})})},ref:t}))});var R=M},70214:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var r=n(63366),l=n(87462),i=n(67294),a=n(86010),o=n(94780),s=n(45355),d=n(36622),c=n(78884),u=n(81719),p=n(1588),m=n(34867);function g(e){return(0,m.Z)("MuiTab",e)}let h=(0,p.Z)("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]);var f=n(85893);let v=["className","disabled","disableFocusRipple","fullWidth","icon","iconPosition","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"],b=e=>{let{classes:t,textColor:n,fullWidth:r,wrapped:l,icon:i,label:a,selected:s,disabled:c}=e,u={root:["root",i&&a&&"labelIcon",`textColor${(0,d.Z)(n)}`,r&&"fullWidth",l&&"wrapped",s&&"selected",c&&"disabled"],iconWrapper:["iconWrapper"]};return(0,o.Z)(u,g,t)},y=(0,u.ZP)(s.Z,{name:"MuiTab",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.label&&n.icon&&t.labelIcon,t[`textColor${(0,d.Z)(n.textColor)}`],n.fullWidth&&t.fullWidth,n.wrapped&&t.wrapped]}})(({theme:e,ownerState:t})=>(0,l.Z)({},e.typography.button,{maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center"},t.label&&{flexDirection:"top"===t.iconPosition||"bottom"===t.iconPosition?"column":"row"},{lineHeight:1.25},t.icon&&t.label&&{minHeight:72,paddingTop:9,paddingBottom:9,[`& > .${h.iconWrapper}`]:(0,l.Z)({},"top"===t.iconPosition&&{marginBottom:6},"bottom"===t.iconPosition&&{marginTop:6},"start"===t.iconPosition&&{marginRight:e.spacing(1)},"end"===t.iconPosition&&{marginLeft:e.spacing(1)})},"inherit"===t.textColor&&{color:"inherit",opacity:.6,[`&.${h.selected}`]:{opacity:1},[`&.${h.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},"primary"===t.textColor&&{color:(e.vars||e).palette.text.secondary,[`&.${h.selected}`]:{color:(e.vars||e).palette.primary.main},[`&.${h.disabled}`]:{color:(e.vars||e).palette.text.disabled}},"secondary"===t.textColor&&{color:(e.vars||e).palette.text.secondary,[`&.${h.selected}`]:{color:(e.vars||e).palette.secondary.main},[`&.${h.disabled}`]:{color:(e.vars||e).palette.text.disabled}},t.fullWidth&&{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},t.wrapped&&{fontSize:e.typography.pxToRem(12)})),x=i.forwardRef(function(e,t){let n=(0,c.Z)({props:e,name:"MuiTab"}),{className:o,disabled:s=!1,disableFocusRipple:d=!1,fullWidth:u,icon:p,iconPosition:m="top",indicator:g,label:h,onChange:x,onClick:w,onFocus:E,selected:P,selectionFollowsFocus:Z,textColor:k="inherit",value:C,wrapped:M=!1}=n,R=(0,r.Z)(n,v),S=(0,l.Z)({},n,{disabled:s,disableFocusRipple:d,selected:P,icon:!!p,iconPosition:m,label:!!h,fullWidth:u,textColor:k,wrapped:M}),O=b(S),_=p&&h&&i.isValidElement(p)?i.cloneElement(p,{className:(0,a.default)(O.iconWrapper,p.props.className)}):p,I=e=>{!P&&x&&x(e,C),w&&w(e)},A=e=>{Z&&!P&&x&&x(e,C),E&&E(e)};return(0,f.jsxs)(y,(0,l.Z)({focusRipple:!d,className:(0,a.default)(O.root,o),ref:t,role:"tab","aria-selected":P,disabled:s,onClick:I,onFocus:A,ownerState:S,tabIndex:P?0:-1},R,{children:["top"===m||"start"===m?(0,f.jsxs)(i.Fragment,{children:[_,h]}):(0,f.jsxs)(i.Fragment,{children:[h,_]}),g]}))});var w=x},99164:function(e,t,n){"use strict";n.d(t,{Z:function(){return V}});var r,l,i=n(63366),a=n(87462),o=n(67294);n(59864);var s=n(86010),d=n(94780),c=n(81719),u=n(78884),p=n(62097),m=n(75400),g=n(6528);function h(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}var f=n(57577),v=n(85893);let b=["onChange"],y={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};var x=n(60376),w=n(79476),E=n(45355),P=n(1588),Z=n(34867);function k(e){return(0,Z.Z)("MuiTabScrollButton",e)}let C=(0,P.Z)("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),M=["className","direction","orientation","disabled"],R=e=>{let{classes:t,orientation:n,disabled:r}=e;return(0,d.Z)({root:["root",n,r&&"disabled"]},k,t)},S=(0,c.ZP)(E.Z,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.orientation&&t[n.orientation]]}})(({ownerState:e})=>(0,a.Z)({width:40,flexShrink:0,opacity:.8,[`&.${C.disabled}`]:{opacity:0}},"vertical"===e.orientation&&{width:"100%",height:40,"& svg":{transform:`rotate(${e.isRtl?-90:90}deg)`}})),O=o.forwardRef(function(e,t){let n=(0,u.Z)({props:e,name:"MuiTabScrollButton"}),{className:o,direction:d}=n,c=(0,i.Z)(n,M),m=(0,p.Z)(),g="rtl"===m.direction,h=(0,a.Z)({isRtl:g},n),f=R(h);return(0,v.jsx)(S,(0,a.Z)({component:"div",className:(0,s.default)(f.root,o),ref:t,role:null,ownerState:h,tabIndex:null},c,{children:"left"===d?r||(r=(0,v.jsx)(x.Z,{fontSize:"small"})):l||(l=(0,v.jsx)(w.Z,{fontSize:"small"}))}))});var _=n(26432);function I(e){return(0,Z.Z)("MuiTabs",e)}let A=(0,P.Z)("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]);var z=n(47505);let T=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],F=(e,t)=>{return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:e.firstChild},B=(e,t)=>{return e===t?e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:e.lastChild},$=(e,t,n)=>{let r=!1,l=n(e,t);for(;l;){if(l===e.firstChild){if(r)return;r=!0}let i=l.disabled||"true"===l.getAttribute("aria-disabled");if(!l.hasAttribute("tabindex")||i)l=n(e,l);else{l.focus();return}}},W=e=>{let{vertical:t,fixed:n,hideScrollbar:r,scrollableX:l,scrollableY:i,centered:a,scrollButtonsHideMobile:o,classes:s}=e;return(0,d.Z)({root:["root",t&&"vertical"],scroller:["scroller",n&&"fixed",r&&"hideScrollbar",l&&"scrollableX",i&&"scrollableY"],flexContainer:["flexContainer",t&&"flexContainerVertical",a&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",o&&"scrollButtonsHideMobile"],scrollableX:[l&&"scrollableX"],hideScrollbar:[r&&"hideScrollbar"]},I,s)},j=(0,c.ZP)("div",{name:"MuiTabs",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${A.scrollButtons}`]:t.scrollButtons},{[`& .${A.scrollButtons}`]:n.scrollButtonsHideMobile&&t.scrollButtonsHideMobile},t.root,n.vertical&&t.vertical]}})(({ownerState:e,theme:t})=>(0,a.Z)({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},e.vertical&&{flexDirection:"column"},e.scrollButtonsHideMobile&&{[`& .${A.scrollButtons}`]:{[t.breakpoints.down("sm")]:{display:"none"}}})),L=(0,c.ZP)("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.scroller,n.fixed&&t.fixed,n.hideScrollbar&&t.hideScrollbar,n.scrollableX&&t.scrollableX,n.scrollableY&&t.scrollableY]}})(({ownerState:e})=>(0,a.Z)({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},e.fixed&&{overflowX:"hidden",width:"100%"},e.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},e.scrollableX&&{overflowX:"auto",overflowY:"hidden"},e.scrollableY&&{overflowY:"auto",overflowX:"hidden"})),D=(0,c.ZP)("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.flexContainer,n.vertical&&t.flexContainerVertical,n.centered&&t.centered]}})(({ownerState:e})=>(0,a.Z)({display:"flex"},e.vertical&&{flexDirection:"column"},e.centered&&{justifyContent:"center"})),H=(0,c.ZP)("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(e,t)=>t.indicator})(({ownerState:e,theme:t})=>(0,a.Z)({position:"absolute",height:2,bottom:0,width:"100%",transition:t.transitions.create()},"primary"===e.indicatorColor&&{backgroundColor:(t.vars||t).palette.primary.main},"secondary"===e.indicatorColor&&{backgroundColor:(t.vars||t).palette.secondary.main},e.vertical&&{height:"100%",width:2,right:0})),N=(0,c.ZP)(function(e){let{onChange:t}=e,n=(0,i.Z)(e,b),r=o.useRef(),l=o.useRef(null),s=()=>{r.current=l.current.offsetHeight-l.current.clientHeight};return o.useEffect(()=>{let e=(0,m.Z)(()=>{let e=r.current;s(),e!==r.current&&t(r.current)}),n=(0,f.Z)(l.current);return n.addEventListener("resize",e),()=>{e.clear(),n.removeEventListener("resize",e)}},[t]),o.useEffect(()=>{s(),t(r.current)},[t]),(0,v.jsx)("div",(0,a.Z)({style:y,ref:l},n))},{name:"MuiTabs",slot:"ScrollbarSize"})({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),U={},Y=o.forwardRef(function(e,t){let n=(0,u.Z)({props:e,name:"MuiTabs"}),r=(0,p.Z)(),l="rtl"===r.direction,{"aria-label":d,"aria-labelledby":c,action:b,centered:y=!1,children:x,className:w,component:E="div",allowScrollButtonsMobile:P=!1,indicatorColor:Z="primary",onChange:k,orientation:C="horizontal",ScrollButtonComponent:M=O,scrollButtons:R="auto",selectionFollowsFocus:S,TabIndicatorProps:I={},TabScrollButtonProps:A={},textColor:Y="primary",value:V,variant:X="standard",visibleScrollbar:q=!1}=n,G=(0,i.Z)(n,T),Q="scrollable"===X,K="vertical"===C,J=K?"scrollTop":"scrollLeft",ee=K?"top":"left",et=K?"bottom":"right",en=K?"clientHeight":"clientWidth",er=K?"height":"width",el=(0,a.Z)({},n,{component:E,allowScrollButtonsMobile:P,indicatorColor:Z,orientation:C,vertical:K,scrollButtons:R,textColor:Y,variant:X,visibleScrollbar:q,fixed:!Q,hideScrollbar:Q&&!q,scrollableX:Q&&!K,scrollableY:Q&&K,centered:y&&!Q,scrollButtonsHideMobile:!P}),ei=W(el),[ea,eo]=o.useState(!1),[es,ed]=o.useState(U),[ec,eu]=o.useState({start:!1,end:!1}),[ep,em]=o.useState({overflow:"hidden",scrollbarWidth:0}),eg=new Map,eh=o.useRef(null),ef=o.useRef(null),ev=()=>{let e,t;let n=eh.current;if(n){let l=n.getBoundingClientRect();e={clientWidth:n.clientWidth,scrollLeft:n.scrollLeft,scrollTop:n.scrollTop,scrollLeftNormalized:(0,g.T)(n,r.direction),scrollWidth:n.scrollWidth,top:l.top,bottom:l.bottom,left:l.left,right:l.right}}if(n&&!1!==V){let i=ef.current.children;if(i.length>0){let a=i[eg.get(V)];t=a?a.getBoundingClientRect():null}}return{tabsMeta:e,tabMeta:t}},eb=(0,_.Z)(()=>{let e;let{tabsMeta:t,tabMeta:n}=ev(),r=0;if(K)e="top",n&&t&&(r=n.top-t.top+t.scrollTop);else if(e=l?"right":"left",n&&t){let i=l?t.scrollLeftNormalized+t.clientWidth-t.scrollWidth:t.scrollLeft;r=(l?-1:1)*(n[e]-t[e]+i)}let a={[e]:r,[er]:n?n[er]:0};if(isNaN(es[e])||isNaN(es[er]))ed(a);else{let o=Math.abs(es[e]-a[e]),s=Math.abs(es[er]-a[er]);(o>=1||s>=1)&&ed(a)}}),ey=(e,{animation:t=!0}={})=>{t?function(e,t,n,r={},l=()=>{}){let{ease:i=h,duration:a=300}=r,o=null,s=t[e],d=!1,c=()=>{d=!0},u=r=>{if(d){l(Error("Animation cancelled"));return}null===o&&(o=r);let c=Math.min(1,(r-o)/a);if(t[e]=i(c)*(n-s)+s,c>=1){requestAnimationFrame(()=>{l(null)});return}requestAnimationFrame(u)};return s===n?(l(Error("Element already at target position")),c):(requestAnimationFrame(u),c)}(J,eh.current,e,{duration:r.transitions.duration.standard}):eh.current[J]=e},ex=e=>{let t=eh.current[J];K?t+=e:(t+=e*(l?-1:1),t*=l&&"reverse"===(0,g.E)()?-1:1),ey(t)},ew=()=>{let e=eh.current[en],t=0,n=Array.from(ef.current.children);for(let r=0;r<n.length;r+=1){let l=n[r];if(t+l[en]>e){0===r&&(t=e);break}t+=l[en]}return t},eE=()=>{ex(-1*ew())},eP=()=>{ex(ew())},eZ=o.useCallback(e=>{em({overflow:null,scrollbarWidth:e})},[]),ek=(0,_.Z)(e=>{let{tabsMeta:t,tabMeta:n}=ev();if(n&&t){if(n[ee]<t[ee]){let r=t[J]+(n[ee]-t[ee]);ey(r,{animation:e})}else if(n[et]>t[et]){let l=t[J]+(n[et]-t[et]);ey(l,{animation:e})}}}),eC=(0,_.Z)(()=>{if(Q&&!1!==R){let e,t;let{scrollTop:n,scrollHeight:i,clientHeight:a,scrollWidth:o,clientWidth:s}=eh.current;if(K)e=n>1,t=n<i-a-1;else{let d=(0,g.T)(eh.current,r.direction);e=l?d<o-s-1:d>1,t=l?d>1:d<o-s-1}(e!==ec.start||t!==ec.end)&&eu({start:e,end:t})}});o.useEffect(()=>{let e;let t=(0,m.Z)(()=>{eh.current&&(eb(),eC())}),n=(0,f.Z)(eh.current);return n.addEventListener("resize",t),"undefined"!=typeof ResizeObserver&&(e=new ResizeObserver(t),Array.from(ef.current.children).forEach(t=>{e.observe(t)})),()=>{t.clear(),n.removeEventListener("resize",t),e&&e.disconnect()}},[eb,eC]);let eM=o.useMemo(()=>(0,m.Z)(()=>{eC()}),[eC]);o.useEffect(()=>{return()=>{eM.clear()}},[eM]),o.useEffect(()=>{eo(!0)},[]),o.useEffect(()=>{eb(),eC()}),o.useEffect(()=>{ek(U!==es)},[ek,es]),o.useImperativeHandle(b,()=>({updateIndicator:eb,updateScrollButtons:eC}),[eb,eC]);let eR=(0,v.jsx)(H,(0,a.Z)({},I,{className:(0,s.default)(ei.indicator,I.className),ownerState:el,style:(0,a.Z)({},es,I.style)})),eS=0,eO=o.Children.map(x,e=>{if(!o.isValidElement(e))return null;let t=void 0===e.props.value?eS:e.props.value;eg.set(t,eS);let n=t===V;return eS+=1,o.cloneElement(e,(0,a.Z)({fullWidth:"fullWidth"===X,indicator:n&&!ea&&eR,selected:n,selectionFollowsFocus:S,onChange:k,textColor:Y,value:t},1!==eS||!1!==V||e.props.tabIndex?{}:{tabIndex:0}))}),e_=e=>{let t=ef.current,n=(0,z.Z)(t).activeElement,r=n.getAttribute("role");if("tab"!==r)return;let i="horizontal"===C?"ArrowLeft":"ArrowUp",a="horizontal"===C?"ArrowRight":"ArrowDown";switch("horizontal"===C&&l&&(i="ArrowRight",a="ArrowLeft"),e.key){case i:e.preventDefault(),$(t,n,B);break;case a:e.preventDefault(),$(t,n,F);break;case"Home":e.preventDefault(),$(t,null,F);break;case"End":e.preventDefault(),$(t,null,B)}},eI=(()=>{let e={};e.scrollbarSizeListener=Q?(0,v.jsx)(N,{onChange:eZ,className:(0,s.default)(ei.scrollableX,ei.hideScrollbar)}):null;let t=ec.start||ec.end,n=Q&&("auto"===R&&t||!0===R);return e.scrollButtonStart=n?(0,v.jsx)(M,(0,a.Z)({orientation:C,direction:l?"right":"left",onClick:eE,disabled:!ec.start},A,{className:(0,s.default)(ei.scrollButtons,A.className)})):null,e.scrollButtonEnd=n?(0,v.jsx)(M,(0,a.Z)({orientation:C,direction:l?"left":"right",onClick:eP,disabled:!ec.end},A,{className:(0,s.default)(ei.scrollButtons,A.className)})):null,e})();return(0,v.jsxs)(j,(0,a.Z)({className:(0,s.default)(ei.root,w),ownerState:el,ref:t,as:E},G,{children:[eI.scrollButtonStart,eI.scrollbarSizeListener,(0,v.jsxs)(L,{className:ei.scroller,ownerState:el,style:{overflow:ep.overflow,[K?`margin${l?"Left":"Right"}`:"marginBottom"]:q?void 0:-ep.scrollbarWidth},ref:eh,onScroll:eM,children:[(0,v.jsx)(D,{"aria-label":d,"aria-labelledby":c,"aria-orientation":"vertical"===C?"vertical":null,className:ei.flexContainer,ownerState:el,onKeyDown:e_,ref:ef,role:"tablist",children:eO}),ea&&eR]}),eI.scrollButtonEnd]}))});var V=Y},60376:function(e,t,n){"use strict";n(67294);var r=n(54235),l=n(85893);t.Z=(0,r.Z)((0,l.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},79476:function(e,t,n){"use strict";n(67294);var r=n(54235),l=n(85893);t.Z=(0,r.Z)((0,l.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")},69633:function(e,t,n){"use strict";var r=n(28442);let l=e=>{return!e||!(0,r.Z)(e)};t.Z=l},70735:function(e,t,n){var r=n(20731),l=n(21078),i=n(67206),a=n(5976),o=n(29246),s=n(10928),d=a(function(e,t){var n=s(t);return o(n)&&(n=void 0),o(e)?r(e,l(t,1,o,!0),i(n,2)):[]});e.exports=d},30998:function(e,t,n){var r=n(41848),l=n(67206),i=n(40554),a=Math.max;e.exports=function(e,t,n){var o=null==e?0:e.length;if(!o)return -1;var s=null==n?0:i(n);return s<0&&(s=a(o+s,0)),r(e,l(t,3),s)}},12482:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(35705),l=n(67294);let i={backdrop:{position:"absolute",left:0,top:0,bottom:0,right:0},content:{position:"absolute",left:"50%",top:"50%",marginLeft:-20,marginTop:-20}};function a({size:e=40}){return l.createElement("div",{style:i.backdrop,"data-testid":"loadingIndicator"},l.createElement("div",{style:i.content},l.createElement(r.Z,{variant:"indeterminate",size:e})))}},69709:function(e,t,n){"use strict";n.r(t);var r=n(85597),l=n(27274),i=n(7961),a=n(6867),o=n(81719),s=n(62097),d=n(67294),c=n(93836),u=n(42977),p=n(17563);let m=(0,o.ZP)(i.Z,{name:"AvatarWrapper"})(({theme:e})=>({borderWidth:"thin",borderStyle:"solid",borderColor:e.palette.border.secondary})),g=(0,o.ZP)(r.rUS,{name:"Link"})(({theme:e})=>({"&:hover":{textDecoration:"none"}})),h=(0,o.ZP)(a.Z,{shouldForwardProp:e=>"status"!==e})(({theme:e,status:t})=>({"& .MuiBadge-badge":{...0===t&&{display:"none"},...1===t&&{color:e.palette.success.main,backgroundColor:e.palette.success.main},...2===t&&{color:e.palette.warning.main,backgroundColor:e.palette.warning.main},...3===t&&{color:e.palette.error.main,backgroundColor:e.palette.error.main},boxShadow:"dark"===e.palette.mode?"none":`0 0 0 2px ${e.palette.background.paper}`,"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}}})),f=(0,o.ZP)("div",{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",width:"32px",height:"32px",...t&&{width:t,height:t}})),v=(0,o.ZP)(i.Z,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"absolute",bottom:0,left:0,width:"26px",height:"26px",backgroundColor:"dark"===e.palette.mode?e.palette.grey["600"]:e.palette.grey["300"],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.palette.mode?e.palette.grey["50"]:e.palette.grey["800"],zIndex:2,...t&&{width:t-6,height:t-6}})),b=(0,o.ZP)(i.Z,{shouldForwardProp:e=>"sizeProps"!==e})(({theme:e,sizeProps:t})=>({position:"relative",top:-2,left:6,width:"26px",height:"26px",...t&&{width:`${t-6}px !important`,height:`${t-6}px !important`}}));t.default=(0,d.memo)(function({username:e="Name",name:t="Name",src:n,size:a,to:o,onClick:y,status:x=0,room:w,uploadLocal:E=!1,roomType:P=null,avatarETag:Z,hoverCard:k=!1,component:C="span",target:M="_self"}){var R,S;let{getSetting:O}=(0,r.OgA)(),_=(0,s.Z)(),I=P||(null==w?void 0:w.t),A=(0,l.vK)(t),z={width:a,height:a,color:_.palette.grey["50"],fontSize:a/3},T=O("chatplus"),F=null==T?void 0:null===(R=T.server)||void 0===R?void 0:R.replace(/\/$/,""),B=n;if(B||(B=Z?`${F}/avatar/${e}?${p.stringify({etag:Z})}`:""),A&&(z.backgroundColor=l.kU.hex(A)),o)return d.createElement(g,{target:M,to:o||`/${e}`},d.createElement(m,{src:B,alt:t,style:z,component:C,children:A}));if([c.n.Private,c.n.Public].includes(I)){if(E)return d.createElement(m,{src:B,alt:t,style:z,component:C,children:A});if(null==w?void 0:w.avatarETag)return B=`${F}/avatar/room/${null==w?void 0:w.id}?${p.stringify({etag:null==w?void 0:w.avatarETag})}`,d.createElement(m,{src:B,alt:t,style:z,component:C,children:A});{let $=`${F}/avatar/${null==w?void 0:null===(S=w.u)||void 0===S?void 0:S.username}`;return d.createElement(f,{sizeProps:a},d.createElement(v,{sizeProps:a,src:$,alt:t,component:C,children:A}),d.createElement(b,{sizeProps:a,src:B,alt:t,style:z,component:C,children:A}))}}if(I===c.n.Direct&&x){let W=(0,u.xW)(x);return d.createElement(h,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",status:W},d.createElement(i.Z,{src:B,alt:t,style:z,component:C,children:A,hoverCard:k}))}return d.createElement(m,{src:B,alt:t,style:z,component:C,children:A,onClick:y,to:e,hoverCard:k})})},48372:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return nP}});var r=n(85597),l=n(39312),i=n(80036),a=n(93836),o=n(21241),s=n(16473),d=n(81719),c=n(62097),u=n(30120),p=n(1469),m=n.n(p),g=n(41609),h=n.n(g),f=n(67294),v=n(86706),b=n(94767),y=n(58663),x=n(42977),w=n(19382);let E=(0,d.ZP)("div",{shouldForwardProp:e=>"isAllPage"!==e})(({theme:e,isAllPage:t})=>({"&:not(:first-of-type)":{marginTop:e.spacing(.75)},position:"relative",padding:e.spacing(1),maxWidth:"245px",backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},borderRadius:e.spacing(1.25),overflow:"hidden",...t&&{maxWidth:"400px",padding:e.spacing(1.25,1)}})),P=(0,d.ZP)("div")(({theme:e})=>({display:"flex",alignItems:"center","& .ico":{marginRight:e.spacing(.75)}})),Z=(0,d.ZP)(s.Ys)(({theme:e})=>({flex:1,minWidth:0,fontSize:e.mixins.pxToRem(12)})),k=(0,d.ZP)("div",{shouldForwardProp:e=>"isAllPage"!==e})(({theme:e,isAllPage:t})=>({position:"absolute",bottom:0,left:0,right:0,padding:e.spacing(0,1),...t&&{span:{height:e.spacing(.75)}}}));var C=function({count:e=1,files:t,progress:n=0,isAllPage:l=!1}){let{i18n:i}=(0,r.OgA)();if(t||t.length)return f.createElement(E,{isAllPage:l},f.createElement(P,null,f.createElement(s.zb,{icon:"ico-paperclip-alt"}),f.createElement(Z,{lines:1},1===e?f.createElement(f.Fragment,null,i.formatMessage({id:"uploading_name"},{name:t[0].name})):i.formatMessage({id:"uploading_n_attachments"},{count:e}))),f.createElement(k,{isAllPage:l},f.createElement(w.Z,{variant:"determinate",value:n})))};function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let R=(0,d.ZP)("div")(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"flex-end",marginBottom:e.spacing(.5),padding:e.spacing(.5,2)})),S=(0,d.ZP)("div",{shouldForwardProp:e=>"isAllPage"!==e})(({theme:e,isAllPage:t})=>({display:"flex",flexDirection:"column",alignItems:"flex-end",width:"100%",...t&&{maxWidth:'calc(~"100% - 50px")'}}));var O=function({data:e,eventInit:t,isAllPage:n=!1}){let r=Object.keys(e),l=r.map(t=>{return{id:t,...e[t]}});return(f.useEffect(()=>{t&&t()},[l]),l.length)?f.createElement(R,null,f.createElement(S,{isAllPage:n},l.map(e=>f.createElement(C,M({},e,{key:e.id,isAllPage:n}))))):null},_=n(83940),I=n(27274),A=n(86010),z=n(96095),T=n(59045),F=n(38790);let B="MsgSeenUser",$=(0,d.ZP)("div",{name:B,slot:"UIChatMsgSeenUsers",shouldForwardProp:e=>"isOwner"!==e&&"indexLast"!==e})(({theme:e,isOwner:t,indexLast:n})=>({display:"flex",width:"100%",justifyContent:"flex-end",alignItems:"center",flexFlow:"wrap",transform:"translateX(12px)",marginBottom:e.spacing(-1.5),marginTop:e.spacing(.5),...!t&&{marginTop:e.spacing(0),...n&&{transform:"translateX(12px) translateY(-4px)"}}})),W=(0,d.ZP)("span",{name:B,slot:"UIChatMsgListUsersMore"})(({theme:e})=>({background:e.palette.grey["500"],color:e.palette.grey["50"],borderRadius:100,display:"inline-flex",alignItems:"center",justifyContent:"center",height:e.spacing(1.75),padding:e.spacing(0,.5),fontSize:e.spacing(1.5),lineHeight:e.spacing(1.75)})),j=(0,d.ZP)("div",{name:B,shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({marginRight:0,marginLeft:e.spacing(.25),"& .MuiAvatar-root":{fontSize:`${e.mixins.pxToRem(7)} !important`}})),L=({item:e,isOwner:t})=>{var n,i;let{i18n:a}=(0,r.OgA)(),o=(0,l.ID)(null==e?void 0:e._id);return f.createElement(F.Z,{className:"uiChatTooltipSeenUser",title:a.formatMessage({id:"seen_by_user_at_time"},{user:(i=(null==e?void 0:e.name)||(null==e?void 0:e.username)).length>20?`${i.slice(0,20)}...`:i,time:(0,x.jF)(null==e?void 0:null===(n=e.seenAt)||void 0===n?void 0:n.$date)}),placement:"top"},f.createElement(j,{isOwner:t},f.createElement(_.Z,{allowLink:!0,size:14,username:(null==o?void 0:o.username)||(null==e?void 0:e.username),name:(null==o?void 0:o.name)||(null==e?void 0:e.name),avatarETag:(null==e?void 0:e.avatarETag)||(null==o?void 0:o.avatarETag)})))};function D({disabled:e,user:t,message:{u:n,seenUser:l},isOwner:i,indexLast:a}){let{dispatch:o}=(0,r.OgA)();if(e||!(null==l?void 0:l.length))return null;let s=l.filter(e=>e._id!==t._id);if(!s.length)return null;let d=s.length-4,c=s.slice(4),p=d?f.createElement(f.Fragment,null,c.slice(0,20).map((e,t)=>{return f.createElement("div",{key:t},(null==e?void 0:e.name)||e.username)}),c.length>20?f.createElement("div",null,"..."):null):null,m=e=>{o({type:"chatplus/room/presentSeenUsersList",payload:e})};return f.createElement($,{isOwner:i,indexLast:a},d>0?f.createElement(F.Z,{title:p,placement:"top"},f.createElement(W,{onClick:()=>m(s)},`+${d}`)):null,s.slice(0,4).map((e,t)=>f.createElement(u.Z,{key:t.toString(),onClick:()=>m(s)},f.createElement(L,{item:e,isOwner:i}))))}let H="MsgItem",N=(0,d.ZP)("div",{name:H,slot:"uiChatMsgItem",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({...t&&{flexDirection:"row-reverse"},minHeight:"40px",marginBottom:e.spacing(.5)})),U=(0,d.ZP)("div",{name:H,slot:"uiChatMsgItemBody",shouldForwardProp:e=>"isOwner"!==e&&"isAlert"!==e&&"isShowReact"!==e})(({theme:e,isOwner:t,isAlert:n,isShowReact:r})=>({display:"flex","&:hover .uiChatItemBtn":{visibility:"visible"},...t&&{flexDirection:"row-reverse"},...n&&{textAlign:"center",...r&&{justifyContent:"center"}}})),Y=(0,d.ZP)("div",{name:H,slot:"uiChatMsgItemBodyOuter",shouldForwardProp:e=>"hasToolbar"!==e&&"multiImage"!==e&&"isOwner"!==e&&"isPageAllMessages"!==e&&"msgType"!==e&&"msgContentType"!==e})(({theme:e,hasToolbar:t,multiImage:n,isOwner:r,isPageAllMessages:l,msgType:i,msgContentType:a})=>({maxWidth:"100%",...t&&{maxWidth:"calc(100% - 42px)"},...t&&l&&{maxWidth:"calc(65% - 42px)"},..."messageDeleted"===a&&!r&&{maxWidth:"calc(100% - 26px)"},...n&&{maxWidth:"160px"},...n&&r&&{maxWidth:"190px"},...n&&l&&{maxWidth:"400px"},...l&&("message_pinned"===i||"message_unpinned"===i)&&{maxWidth:"400px"}}));function V({msgId:e,user:t,tooltipPosition:n,isMobile:i,showToolbar:o=!0,disableReact:s,seenUserShow:d,isRoomLimited:c,handleAction:u,isReadonly:p,isRoomOwner:m,room:g,subscription:h,indexLast:v}){let b=`chatplus.entities.message.${e}`,y=(0,l.v2)(b),{jsxBackend:w,usePageParams:E}=(0,r.OgA)(),P=(0,l.Fy)(),Z=(0,l.XP)(null==g?void 0:g.id),k=E(),C=(null==k?void 0:k.rid)||!1,[M]=(0,r.zXz)(b,{}),R=(0,l.PB)(),{_id:S,t:O,system:_,attachments:F,reactions:B,msgType:$,starred:W=[],ts:j,u:L,msgContentType:H}=y||{},V=t._id===(null==L?void 0:L._id),X=(0,x.jF)(null==j?void 0:j.$date),q=(0,x.qF)(F),G=(0,x.vS)(O),Q=!!((null==g?void 0:g.t)===a.n.Direct&&((null==h?void 0:h.metafoxBlocked)||(null==h?void 0:h.metafoxBlocker))),K=!!((null==g?void 0:g.t)===a.n.Direct&&((null==h?void 0:h.blocked)||(null==h?void 0:h.blocker))),J=!!(K||Q),ee=W.find(e=>e._id===t._id),et=!((null==h?void 0:h.allowMessageFrom)!=="noone"),en=(m||!p)&&!c&&!et&&!J,er=P.Message_AllowStarring&&!et&&!J,el=P.Message_AllowPinning&&Z["pin-message"]&&!c&&!et&&!J,ei=(Z["edit-message"]||V&&P.Message_AllowEditing)&&!c&&!et&&!J,ea=(Z["force-delete-message"]||P.Message_AllowDeleting&&(Z["delete-message"]||V&&Z["delete-own-message"]))&&!c&&!et&&!J,eo=f.useMemo(()=>(0,I.W$)(R,{allowReply:en,allowQuote:!1,isSearch:!1,allowEdit:ei,allowPinning:el,item:y,allowStarring:er,isStarred:ee,canDelete:ea}),[R,en,!1,!1,ei,el,y,er,ee,ea]),es=(e,t,n)=>{M(e,t,n),u(e,y,n)},ed="messageDeleted"!==H&&"message_pinned"!==$&&"message_unpinned"!==$;return y?f.createElement(N,{isOwner:V,"data-id":S,"data-t":O,"data-testid":S},f.createElement(U,{isOwner:V,isAlert:G,isShowReact:ed},f.createElement(Y,{hasToolbar:o&&!_,msgContentType:H,multiImage:q>1,isOwner:V,isPageAllMessages:C,msgType:$,className:(0,A.default)("uiChatMsgItemBodyOuter")},w.render({component:`chatplus.messageContent.${H}`,props:{message:y,isOwner:V,user:t,createdDate:X,isRoomLimited:c,msgType:$,tooltipPosition:i?"top":n}})),ed&&!G&&f.createElement(T.Z,{identity:b,handleAction:es,disabled:_||!o,disableReact:s,items:eo,isOwner:V})),ed&&f.createElement(z.Z,{identity:b,disabled:!B||_,reactions:B,isOwner:V,handleAction:es}),f.createElement(D,{disabled:!d,message:y,user:t,isOwner:V,indexLast:v})):null}let X="MsgSet",q=(0,d.ZP)("div",{name:X,slot:"uiChatMsgSet",shouldForwardProp:e=>"isOwner"!==e&&"isAlert"!==e&&"isGroup"!==e})(({theme:e,isOwner:t,isAlert:n,isGroup:r})=>({display:"flex",flexDirection:"row",padding:e.spacing(.5,2),...n&&{"&.uiChatMsgItemCall":{border:"none"},"&.uiChatMsgActions":{justifyContent:"center","&.my-1; .btn":{"&.mx-1":"!important"}}},...t&&{flexDirection:"row-reverse",padding:e.spacing(0,2)}})),G=(0,d.ZP)("div",{name:X,slot:"uiChatMsgSetAvatar",shouldForwardProp:e=>"isOwner"!==e&&"isAlert"!==e})(({theme:e,isOwner:t,isAlert:n})=>({marginRight:e.spacing(1),display:"flex",alignItems:"flex-end",marginBottom:e.spacing(.75),...t&&{display:"none",flexDirection:"row-reverse"},...n&&{display:"none"}})),Q=(0,d.ZP)("div",{name:X,slot:"uiChatMsgSetBody",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({flex:1,minWidth:0,...t&&{flexDirection:"row-reverse"}})),K=(0,d.ZP)("div",{name:X,slot:"uiChatMsgSetBodyUser"})(({theme:e})=>({...e.typography.body2,color:e.palette.text.secondary,marginBottom:e.spacing(.5),padding:e.spacing(0,.5)}));function J({msgSet:e,archived:t,settings:n,perms:r,tooltipPosition:i,isMobile:a,disableReact:o,room:s,subscription:d,user:c,seenUserShow:u,isReadonly:p,isRoomOwner:m,isRoomLimited:g,handleAction:h}){var v;let b=(0,l.ID)(null==e?void 0:null===(v=e.u)||void 0===v?void 0:v._id);if(!e)return;let{u:y,items:w,t:E}=e,P=c._id===y._id,Z=(0,x.TL)(E),k=s&&["p","c"].includes(s.t);return w&&w.length?f.createElement(q,{isOwner:P,isAlert:Z,isGroup:k,className:`uiChatMsgSet ${P?"isOwner":""} ${Z?"roomAlert":""} ${k?"roomGroup":""}`},f.createElement(G,{isOwner:P,isAlert:Z,className:"uiChatMsgSetAvatar"},f.createElement(_.Z,{name:(null==b?void 0:b.name)||(null==y?void 0:y.name),username:(null==b?void 0:b.username)||(null==y?void 0:y.username),avatarETag:(null==y?void 0:y.avatarETag)||(null==b?void 0:b.avatarETag),size:32})),f.createElement(Q,{className:"uiChatMsgSetBody"},k&&!P&&!Z&&f.createElement(K,null,y.name),w.map((e,r)=>f.createElement(V,{indexLast:r===w.length-1,user:c,settings:n,archived:t,key:e.toString(),msgId:e,room:s,subscription:d,tooltipPosition:"top",isMobile:a,disableReact:o,seenUserShow:u&&r+1===w.length,isReadonly:p,isRoomLimited:g,isRoomOwner:m,handleAction:h})))):null}let ee=e=>{let t=e.length;if(!t)return -1;for(;t--;){let n=(0,x.vS)(e[t].t);if(!n)return t}return -1};function et({msgGroup:e,archived:t,settings:n,tooltipPosition:r,isMobile:l,disableReact:i,room:a,subscription:o,user:s,isReadonly:d,isRoomOwner:c,isRoomLimited:u,handleAction:p}){if(!e)return null;let{items:m}=e,g=ee(m);return m?f.createElement("div",null,m.map((e,m)=>f.createElement(J,{user:s,msgSet:e,key:`k.0${m}`,archived:t,settings:n,tooltipPosition:r,isMobile:l,disableReact:i,room:a,subscription:o,seenUserShow:g===m,isReadonly:d,isRoomLimited:u,isRoomOwner:c,handleAction:p}))):null}var en=n(70917),er=n(23560),el=n.n(er),ei=n(69709);let ea="MsgTyping",eo=(0,d.ZP)("div",{name:ea,slot:"uiChatMsgSet",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",flexDirection:"row",padding:e.spacing(.5,2),...t&&{flexDirection:"row-reverse"}})),es=(0,d.ZP)("div",{name:ea,slot:"uiChatMsgSetBody"})(({theme:e})=>({backgroundColor:"light"===e.palette.mode?"#f8f8f8":"#828080",borderRadius:e.spacing(2),fontSize:e.mixins.pxToRem(12),display:"inline-block"})),ed=en.F4`
    0% {transform: translateY(0);}
    25%{transform: translateY(-5px);}
    55% {transform: translateY(0);}
    100% {transform: translateY(0);}
`,ec=en.F4`
    0% {transform: translateY(0);}
    20%{transform: translateY(0);}
    50% {transform: translateY(-5px);}
    80% {transform: translateY(0);}
    100% {transform: translateY(0);}
`,eu=en.F4`
  0% {transform: translateY(0);}
  40%{transform: translateY(0);}
  70% {transform: translateY(-5px);}
  100% {transform: translateY(0);}
`,ep=(0,d.ZP)("div",{name:ea,slot:"uiChatMsgTypingIcon"})(({theme:e})=>({display:"inline-flex",alignItems:"flex-end",justifyContent:"center","& > span":{display:"inline-flex",width:"6px",height:"6px",borderRadius:"100%",background:"light"===e.palette.mode?"#828080":"#cecece",margin:"0 2px","&:nth-of-type(1)":{animation:`${ed} 1.3s infinite`},"&:nth-of-type(2)":{animation:`${ec} 1.3s infinite`},"&:nth-of-type(3)":{animation:`${eu} 1.3s infinite`}}})),em=(0,d.ZP)("div",{name:ea,slot:"uiChatMsgItemMsg"})(({theme:e})=>({borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),display:"inline-block"})),eg=(0,d.ZP)("div",{name:ea,slot:"uiChatMsgSetAvatar"})(({theme:e})=>({marginRight:e.spacing(1)}));function eh({onInit:e,typings:t}){return(f.useEffect(()=>{el()(e)&&e()},[e]),t||t.length)?f.createElement(f.Fragment,null,t.slice(0,2).map((e,t)=>f.createElement(eo,{key:t},f.createElement(eg,null,f.createElement(ei.default,{name:e,username:e,size:32,avatarETag:Date.now().toString()})),f.createElement(es,null,f.createElement(em,null,f.createElement(ep,null,f.createElement("span",null),f.createElement("span",null),f.createElement("span",null))))))):null}let ef=(0,d.ZP)(u.Z,{name:"Messages",slot:"DateTimeGroup"})(({theme:e})=>({textAlign:"center",color:e.palette.grey["600"]}));var ev=f.forwardRef(function({rid:e,typing:t,groups:n,newest:l,disableReact:i,isMobile:a,tooltipPosition:o,settings:s,room:d,archived:c,seenUserShow:u,user:p,groupIds:m,isReadonly:g,isRoomOwner:v,isRoomLimited:b,containerRef:w,handleAction:E,roomProgress:P,isAllPage:Z,subscription:k},C){let M=(0,r.lJz)(),[R,S]=f.useState(!!(null==m?void 0:m.length)),_=()=>{let e=M.current.scrollHeight+0;M.current.scrollTo({top:e})};return(f.useEffect(()=>{R&&setTimeout(()=>{_()},100)},[e,R]),f.useEffect(()=>{S(!!(null==m?void 0:m.length))},[null==m?void 0:m.length]),f.useEffect(()=>{if((null==M?void 0:M.current)&&(l||t)){let e=M.current;e.scrollHeight-e.scrollTop-100<=e.clientHeight&&_()}},[l,t]),f.useImperativeHandle(C,()=>{return{scrollToBottom:()=>{_()}}}),n)?f.createElement(y.B.Provider,{value:w},m.map((e,t)=>{var r,l,m,h;return f.createElement("div",{key:`k.0${t}`},n[e]&&(0,x.jF)(null===(r=n[e])||void 0===r?void 0:null===(l=r.ts)||void 0===l?void 0:l.$date)?f.createElement(ef,{py:1},(0,x.jF)(null===(m=n[e])||void 0===m?void 0:null===(h=m.ts)||void 0===h?void 0:h.$date)):null,f.createElement(et,{user:p,msgGroup:n[e],archived:c,settings:s,tooltipPosition:o,isMobile:a,disableReact:i,seenUserShow:u,room:d,subscription:k,isReadonly:g,isRoomLimited:b,isRoomOwner:v,handleAction:E}))}),h()(P)?null:f.createElement(O,{data:P,eventInit:_,isAllPage:Z}),f.createElement(eh,{typings:t})):null});let eb=(0,d.ZP)("div",{name:"MsgItemFilter",slot:"uiChatMsgItemBody"})(({theme:e})=>({display:"flex"}));function ey({msgId:e,user:t,tooltipPosition:n,isMobile:i,showToolbar:a=!0,isRoomLimited:o,room:s,handleAction:d}){let c=`chatplus.chatRooms.${s.id}.messageFilter.${e}`,u=(0,l.v2)(c),{jsxBackend:p}=(0,r.OgA)(),[m,g]=(0,r.zXz)(c,{}),{_id:h,t:v,system:b,attachments:y,reactions:w,msgType:E,ts:P,u:Z}=u||{},k=t._id===(null==Z?void 0:Z._id),C=(0,x.jF)(null==P?void 0:P.$date),M=(0,x.qF)(y),R=(e,t,n)=>{m(e,t,n),d(e,u,n)};return f.createElement("div",{className:"uiChatMsgItem","data-id":h,"data-t":v},f.createElement(eb,null,f.createElement("div",{className:(0,A.default)("uiChatMsgItemBodyOuter",{hasToolbar:a&&!b,"multi-image":M>1})},p.render({component:"chatplus.messageContent.standard",props:{message:u,isOwner:k,user:t,createdDate:C,isRoomLimited:o,msgType:E,tooltipPosition:i?"top":n}})),f.createElement(T.Z,{identity:c,handleAction:R,disabled:b||!a,disableReact:!0,state:g})),f.createElement(z.Z,{identity:c,disabled:!w||b,reactions:w,handleAction:R}))}function ex(){return(ex=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let ew="MessageFilter",eE=(0,d.ZP)("div",{name:ew,slot:"uiChatMsgSet",shouldForwardProp:e=>"isOwner"!==e&&"isAlert"!==e&&"isGroup"!==e})(({theme:e,isOwner:t,isAlert:n,isGroup:r})=>({display:"flex",flexDirection:"row",padding:e.spacing(.5,2),...n&&{"&.uiChatMsgSetAvatar":{display:"none"},"&.uiChatMsgItemCall":{border:"none"},"&.uiChatMsgActions":{justifyContent:"center","&.my-1; .btn":{"&.mx-1":"!important"}}},...t&&{flexDirection:"row-reverse"}})),eP=(0,d.ZP)("div",{name:ew,slot:"uiChatMsgSetAvatar"})(({theme:e})=>({marginRight:e.spacing(1)})),eZ=(0,d.ZP)("div",{name:ew,slot:"noItemFound"})(({theme:e})=>({...e.typography.body1,padding:e.spacing(1,2),color:e.palette.grey["600"],marginTop:e.spacing(2)})),ek=({item:e,...t})=>{var n,r,i,a;let o=(0,l.ID)(null==e?void 0:null===(n=e.u)||void 0===n?void 0:n._id);return f.createElement(eE,null,f.createElement(eP,null,f.createElement(_.Z,{name:null==e?void 0:null===(r=e.u)||void 0===r?void 0:r.name,username:null==e?void 0:null===(i=e.u)||void 0===i?void 0:i.username,avatarETag:(null==e?void 0:null===(a=e.u)||void 0===a?void 0:a.avatarETag)||(null==o?void 0:o.avatarETag),size:32})),f.createElement(ey,ex({msgId:e._id,perms:{},isMobile:!1},t)))},eC=({items:e,phraseNoContent:t="no_results_found",...n})=>{let{i18n:l}=(0,r.OgA)();return h()(e)?f.createElement(eZ,null,l.formatMessage({id:t})," "):f.createElement("div",null,e&&Object.values(e).map(e=>f.createElement(ek,ex({key:e.id.toString(),item:e},n))))};var eM=n(42963),eR=n(63516),eS=n(21822),eO=n(81674),e_=n(49960),eI=n(91647),eA=n(23279),ez=n.n(eA);let eT=(0,d.ZP)("div")(({theme:e})=>({})),eF=(0,d.ZP)(eO.ZP,{shouldForwardProp:e=>"isMobile"!==e})(({theme:e,isMobile:t})=>({maxWidth:"600px",height:e.spacing(5),margin:e.spacing(2),padding:e.spacing(1.5,2),borderRadius:e.spacing(2.5),border:e.mixins.border("secondary"),backgroundColor:"dark"===e.palette.mode?e.palette.grey["700"]:e.palette.grey["100"],...t&&{margin:0,padding:e.spacing(0,1),"& input":{padding:e.spacing(.25,1,0,1)}}})),eB=(0,d.ZP)(s.zb,{shouldForwardProp:e=>"isMobile"!==e})(({theme:e,isMobile:t})=>({color:e.palette.text.primary,transition:"all .2s ease",cursor:"pointer",padding:e.spacing(0,1),...t&&{padding:0}})),e$=(0,d.ZP)("div")(({theme:e})=>({display:"inline-flex"})),eW=(0,d.ZP)("div",{shouldForwardProp:e=>"isMobile"!==e})(({theme:e,isMobile:t})=>({display:"inline-flex",alignItems:"center",justifyContent:"center",margin:"0",color:e.palette.grey["600"],marginRight:e.spacing(1.5),...t&&{marginRight:e.spacing(.75)}})),ej=(0,d.ZP)("span")(({theme:e})=>({marginRight:e.spacing(0,.25),color:e.palette.text.primary}));function eL({id:e,checked:t,icon:n,value:l,label:i,roomId:a,onClick:o}){let{dispatch:s}=(0,r.OgA)(),d=()=>{s({type:l,payload:{identity:a}}),"function"==typeof o&&o(t?void 0:e)};return f.createElement(eW,{onClick:d},f.createElement(e_.Z,{checked:t,size:"small"}),f.createElement(ej,null,i))}var eD=function({toggleSearch:e,room:t,messageFilter:n,searching:i}){let{i18n:a,dispatch:o,useIsMobile:s}=(0,r.OgA)(),d=s(),c=(0,l.pB)(null==t?void 0:t.id),[u,p]=f.useState(0),m=f.useRef(),g=(0,f.useRef)(null),v=(0,f.useMemo)(()=>{return[{icon:"ico-thumb-tack",label:a.formatMessage({id:"pinned"}),checked:null==c?void 0:c.pinned,value:"chatplus/room/pinnedMessages",id:"pin"},{icon:"ico-star-o",label:a.formatMessage({id:"starred"}),checked:null==c?void 0:c.starred,value:"chatplus/room/starredMessages",id:"star"}]},[a,c]);f.useEffect(()=>{h()(n)&&p(0)},[n]),f.useEffect(()=>{p(0),g.current=null,o({type:"chatplus/room/resetFilterPinnedStarred",payload:{identity:null==t?void 0:t.id}})},[]),f.useEffect(()=>{m.current="",g.current=null,P()},[i]);let b=e=>{g.current=e,P()},y=e=>{p((null==e?void 0:e.total)||0)},x=()=>{},w=e=>{m.current=e.target.value,P()},E=f.useCallback(()=>{o({type:"chatplus/room/searchMessages",payload:{roomId:null==t?void 0:t.id,text:m.current,filter:g.current},meta:{onSuccess:y,onFailure:x}})},[o,t]),P=f.useMemo(()=>{return ez()(E,eM.LS)},[E]);return d?f.createElement(eT,null,f.createElement(eF,{isMobile:d,startAdornment:f.createElement(f.Fragment,null,v&&v.length?f.createElement(e$,null,v.map(e=>{return f.createElement(eL,{id:e.id,key:e.id.toString(),checked:e.checked,icon:e.icon,value:e.value,label:e.label,roomId:null==t?void 0:t.id,onClick:b})})):null,f.createElement(eB,{icon:"ico-search-o",isMobile:d})),endAdornment:f.createElement(eB,{icon:"ico-close",onClick:e}),placeholder:a.formatMessage({id:"search_dots"}),autoComplete:"off",inputProps:{"aria-label":"search","data-testid":"searchBox",autoComplete:"off",autoCapitalize:"off"},inputRef:m,onChange:w})):f.createElement(eT,null,f.createElement(eF,{startAdornment:f.createElement(f.Fragment,null,v&&v.length?f.createElement(e$,null,v.map(e=>{return f.createElement(eL,{id:e.id,key:e.id.toString(),checked:e.checked,icon:e.icon,value:e.value,label:e.label,roomId:null==t?void 0:t.id,onClick:b})})):null,f.createElement(eB,{icon:"ico-search-o"})),endAdornment:f.createElement(f.Fragment,null,f.createElement(eI.Z,{color:"#828080"},"0/",u),f.createElement(eB,{icon:"ico-angle-up"}),f.createElement(eB,{icon:"ico-angle-down"}),f.createElement(eB,{icon:"ico-close",onClick:e})),placeholder:a.formatMessage({id:"search_dots"}),autoComplete:"off",inputProps:{"aria-label":"search","data-testid":"searchBox",autoComplete:"off",autoCapitalize:"off"},inputRef:m,onChange:w}))};let eH=(0,d.ZP)("div",{shouldForwardProp:e=>"isMobile"!==e&&"openSearch"!==e})(({theme:e,isMobile:t,openSearch:n})=>({backgroundColor:e.palette.background.paper,alignItems:"center",boxSizing:"border-box",display:"flex",height:e.spacing(9),padding:e.spacing(1,1,1,2),justifyContent:"space-between",borderBottom:e.mixins.border("secondary"),...t&&!n&&{padding:e.spacing(1,.5,1,1)}})),eN=(0,d.ZP)("div")(({theme:e})=>({"& button":{[e.breakpoints.up("sm")]:{minWidth:"auto"}}})),eU=(0,d.ZP)("div")(({theme:e})=>({padding:e.spacing(1.75,0),display:"flex",alignItems:"center"})),eY=(0,d.ZP)("span")(({theme:e})=>({...e.typography.h4})),eV=(0,d.ZP)(eR.Z)(({theme:e})=>({height:e.spacing(4.25)})),eX=(0,d.ZP)(eS.Z)(({theme:e})=>({height:e.spacing(4.25),marginLeft:e.spacing(1)})),eq=(0,d.ZP)(eS.Z,{shouldForwardProp:e=>"isInfo"!==e})(({theme:e,isInfo:t})=>({color:"light"===e.palette.mode?e.palette.grey["600"]:e.palette.text.primary,...t&&{color:e.palette.primary.main},fontSize:e.spacing(2.25),minWidth:"auto",height:"auto",padding:e.spacing(1),margin:0})),eG=(0,d.ZP)(eS.Z,{shouldForwardProp:e=>"isInfo"!==e})(({theme:e,isInfo:t})=>({color:"light"===e.palette.mode?e.palette.grey["600"]:e.palette.text.primary,fontSize:e.spacing(2.25),minWidth:e.spacing(5),...t&&{color:e.palette.primary.main},padding:0,margin:0})),eQ=(0,d.ZP)(s.zb)(({theme:e})=>({fontSize:e.spacing(2.25),cursor:"pointer",padding:e.spacing(1)})),eK=(0,d.ZP)(eO.ZP)(({theme:e})=>({width:"200px",height:e.spacing(4.375),margin:e.spacing(2),borderRadius:e.spacing(3),padding:e.spacing(2),backgroundColor:"dark"===e.palette.mode?e.palette.grey["700"]:e.palette.grey["100"]})),eJ=(0,d.ZP)("div")(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",paddingRight:e.spacing(1)})),e0=(0,d.ZP)("div")(({theme:e})=>({flex:1,display:"flex",alignItems:"center",justifyContent:"space-between"})),e1=(0,d.ZP)("div")(({theme:e})=>({display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:1,WebkitBoxOrient:"vertical",paddingLeft:e.spacing(1.5)})),e2=(0,d.ZP)(r.rUS,{shouldForwardProp:e=>"isDirect"!==e})(({theme:e,isDirect:t})=>({cursor:"pointer",...!t&&{"&:hover":{textDecoration:"none",cursor:"default"}}})),e5=({name:e,room:t,perms:n,to:l})=>{let{dispatch:i,i18n:o}=(0,r.OgA)(),[s,d]=f.useState(!1),[c,u]=f.useState(null),[p,m]=f.useState(!1);f.useEffect(()=>{d(!1)},[t]);let g=()=>{d(!1),u(null)},h=e=>{u(e.target.value)},v=()=>{if(!c){d(!1);return}m(!0),i({type:"chatplus/room/editSettings",payload:{identity:null==t?void 0:t.id,value:{roomName:c}},meta:{onSuccess:b,onFailure:y}})},b=()=>{u(null),m(!1),d(!1)},y=()=>{u(null),m(!1),d(!1)},x=e=>{13===e.keyCode&&v()};return s?f.createElement(f.Fragment,null,f.createElement(eK,{placeholder:e,value:c,onChange:h,inputProps:{maxLength:eM.LQ},onKeyDown:x}),f.createElement(eV,{loading:p,variant:"contained",onClick:v},"Save"),f.createElement(eX,{variant:"outlined",onClick:g},"Cancel")):f.createElement(f.Fragment,null,f.createElement(e1,null,f.createElement(e2,{target:"_blank",to:l||null,isDirect:l},f.createElement(eY,null,c||e))),n["edit-room"]&&(null==t?void 0:t.t)!==a.n.Direct&&f.createElement(F.Z,{title:o.formatMessage({id:"change_name_group"}),placement:"top"},f.createElement(eQ,{icon:"ico-pencilline-o",onClick:()=>d(!0)})))};var e6=function({buddy:e,perms:t,userChat:n,room:i,chatRoom:o,toggleInfo:d,messageFilter:c,searching:u,subscription:p,settings:g,isSelfChat:v,allowMsgNoOne:y,isReadOnly:x,isMetaFoxBlocked:w,isBlocked:E,openInfo:P}){var Z,k,C,M,R,S;let{dispatch:O,useActionControl:_,useIsMobile:A,navigate:z,i18n:T,jsxBackend:B}=(0,r.OgA)(),$=A(),W=f.useRef(),j=(0,l.Oy)(),[L,D]=f.useState(!1),[H,N]=f.useState(null),[U]=_(null==i?void 0:i.id,{}),Y=(e,t,n)=>{U(e,t,n),"chatplus/room/toggleSearching"===e&&(O({type:"chatplus/room/searchMessages",payload:{roomId:null==i?void 0:i.id,text:""}}),D(e=>!e)),"chatplus/room/sideInfo"===e&&d()},V=j&&i&&i.muted&&m()(i.muted)&&!!i.muted.find(e=>e===j.username),X=(null==i?void 0:i.t)===a.n.Direct&&(null==e?void 0:e.username)&&`/${e.username}`,q=f.useMemo(()=>{let t=T.formatMessage({id:"name"});if(null==i?void 0:i.isNameChanged)return(null==e?void 0:e.name)||t;let n=null==e?void 0:e.name.split(",");return(null==e?void 0:e.name)&&n.length>2?`${n[0]}, ${n[1]} +${n.length-2}`:null==e?void 0:e.name},[null==e?void 0:e.name,null==i?void 0:i.isNameChanged]),G=(0,l.Mn)(),Q=(0,l.KY)(),K=f.useMemo(()=>{return(0,I.W$)(G,{room:i,subscription:p,groups:null==o?void 0:o.groups,pinned:null==o?void 0:o.pinned,favorite:null==p?void 0:p.f,starred:null==o?void 0:o.starred,searching:null==o?void 0:o.searching,settings:g,perms:t,isMobile:$,isSelfChat:v,isBlocked:E,isMetaFoxBlocked:w,allowMsgNoOne:y,isReadOnly:x,isMuted:V})},[o,p,i,g,t,$,G,v,E,w,y,x,V]),J=f.useMemo(()=>{return(0,I.W$)(Q,{room:i,subscription:p,groups:null==o?void 0:o.groups,pinned:null==o?void 0:o.pinned,favorite:null==p?void 0:p.f,starred:null==o?void 0:o.starred,searching:null==o?void 0:o.searching,settings:g,perms:t,isMobile:$,isSelfChat:v,isBlocked:E,isMetaFoxBlocked:w,allowMsgNoOne:y,isReadOnly:x})},[o,p,i,g,t,$,Q,v,E,w,y,x]),ee=Boolean(-1!==J.findIndex(e=>"toggleSearching"===e.testid)),et=Boolean(-1!==J.findIndex(e=>"startVoiceCall"===e.testid)),en=Boolean(-1!==J.findIndex(e=>"startVideoChat"===e.testid)),er=!h()(K)&&K.length>1&&K.filter(e=>{return(null==e?void 0:e.behavior)!=="more"}),el=(null==n?void 0:n.status)||0;f.useEffect(()=>{return D(!1),()=>{N(null)}},[i]);let ea=f.useCallback(()=>{O({type:"chatplus/room/toggleSearching",payload:{identity:null==i?void 0:i.id}}),O({type:"chatplus/room/searchMessages",payload:{roomId:null==i?void 0:i.id,text:""}}),D(e=>!e),N(null)},[O,i]),eo=f.useCallback(()=>{O({type:"chatplus/room/startVoiceCall",payload:{identity:null==i?void 0:i.id}})},[O,i]),es=f.useCallback(()=>{O({type:"chatplus/room/startVideoChat",payload:{identity:null==i?void 0:i.id}})},[O,i]),ed=f.useCallback(()=>{if("pin"===H){N(null);return}N("pin")},[H]),ec=f.useCallback(()=>{if("star"===H){N(null);return}N("star")},[H]),eu=()=>{z({pathname:"/messages"})},ep=f.useCallback(()=>{H&&N(null)},[H]),em=f.useCallback(()=>{d(),N(null)},[]);return $?f.createElement(eH,{isMobile:$,openSearch:L},L?null:f.createElement(eG,{onClick:eu},f.createElement(s.zb,{icon:"ico-arrow-left"})),L?f.createElement(eD,{toggleSearch:ea,room:i,messageFilter:c,searching:u}):f.createElement(e0,null,f.createElement(eU,null,f.createElement(ei.default,{name:q,username:q,size:48,src:null==e?void 0:e.avatar,room:i,status:el,avatarETag:null==e?void 0:e.avatarETag}),f.createElement(e1,null,f.createElement(eY,null,q))),f.createElement(eN,null,f.createElement(eJ,null,f.createElement(b.BB,{items:K,handleAction:Y,displayLimit:2}))))):f.createElement(eH,null,f.createElement(eU,null,f.createElement(ei.default,{target:"_blank",to:X,name:q,username:null==e?void 0:e.username,size:48,src:null==e?void 0:e.avatar,room:i,status:el,avatarETag:null==e?void 0:e.avatarETag}),f.createElement(e5,{name:q,room:i,perms:t,to:X})),f.createElement(eN,null,L?f.createElement(eD,{toggleSearch:ea,room:i,messageFilter:c,searching:u}):f.createElement(eJ,null,ee&&f.createElement(F.Z,{title:null!==(Z=T.formatMessage({id:"search"}))&&void 0!==Z?Z:"",placement:"top"},f.createElement(eq,{onClick:ea},f.createElement(s.zb,{icon:"ico-search-o"}))),f.createElement(F.Z,{title:null!==(k=T.formatMessage({id:"pinned_messages"}))&&void 0!==k?k:"",placement:"top"},f.createElement(eq,{ref:"pin"===H&&W,onClick:ed,isInfo:"pin"===H},f.createElement(s.zb,{icon:"ico-thumb-tack"}))),f.createElement(F.Z,{title:null!==(C=T.formatMessage({id:"starred_messages"}))&&void 0!==C?C:"",placement:"top"},f.createElement(eq,{ref:"star"===H&&W,onClick:ec,isInfo:"star"===H},f.createElement(s.zb,{icon:"ico-star-o"}))),B.render({component:"chatplus.ui.FilterMessages",props:{open:"pin"===H||"star"===H,anchorRef:W,type:H,closePopover:ep}}),f.createElement(F.Z,{title:null!==(M=T.formatMessage({id:"info"}))&&void 0!==M?M:"",placement:"top"},f.createElement(eq,{onClick:em,isInfo:P},f.createElement(s.zb,{icon:"ico-info-circle-alt-o"}))),!v&&et&&f.createElement(F.Z,{title:null!==(R=T.formatMessage({id:"start_an_audio_call"}))&&void 0!==R?R:"",placement:"top"},f.createElement(eq,{onClick:eo},f.createElement(s.zb,{icon:"ico-phone-o"}))),!v&&en&&f.createElement(F.Z,{title:null!==(S=T.formatMessage({id:"start_a_video_call"}))&&void 0!==S?S:"",placement:"top"},f.createElement(eq,{onClick:es},f.createElement(s.zb,{icon:"ico-videocam-o"}))),er?f.createElement(eq,{sx:{p:0,height:"34px",width:"34px"}},f.createElement(b.BB,{items:K,handleAction:U,variant:"pageMessage"})):null)))},e4=n(33483),e7=n(70735),e8=n.n(e7);let e3="ChatRoomPanel",e9=(0,d.ZP)("div")(({theme:e})=>({borderLeft:e.mixins.border("secondary"),backgroundColor:e.palette.background.paper,display:"flex",flexDirection:"column",width:"100%",height:"100%"})),te=(0,d.ZP)("div",{name:e3,slot:"mainContent"})(({theme:e})=>({borderBottom:e.mixins.border("secondary"),display:"flex",flexDirection:"row",alignItems:"center"})),tt=(0,d.ZP)("div")(({theme:e})=>({display:"flex",flexDirection:"row",backgroundColor:e.palette.background.paper,flex:1})),tn=(0,d.ZP)("div")(({theme:e})=>({flex:1,display:"flex",flexDirection:"column",width:"100%",minWidth:0})),tr=(0,d.ZP)("div",{name:e3,slot:"Title"})(({theme:e})=>({fontSize:e.mixins.pxToRem(15),fontWeight:e.typography.fontWeightMedium,padding:e.spacing(3.5,2),alignSelf:"flex-start",color:e.palette.text.secondary,minWidth:"130px"})),tl=(0,d.ZP)("div",{name:e3,slot:"SearchWrapper"})(({theme:e})=>({flex:1,minWidth:0,margin:e.spacing(1),position:"relative",zIndex:e.zIndex.speedDial})),ti=(0,d.ZP)("div",{shouldForwardProp:e=>"suggestList"!==e})(({theme:e,suggestList:t})=>({...!0===t&&{position:"absolute",width:"calc(100% - 74px)",border:e.mixins.border("secondary"),borderTop:"none",backgroundColor:e.palette.background.paper,borderEndEndRadius:e.spacing(1),borderEndStartRadius:e.spacing(1),marginLeft:e.spacing(.25)}})),ta=(0,d.ZP)("div",{shouldForwardProp:e=>"users"!==e})(({theme:e,users:t})=>({...t&&{padding:e.spacing(0,1,1,2)},listStyle:"none",display:"flex",alignItems:"center",flexWrap:"wrap"})),to=(0,d.ZP)("li")(({theme:e})=>({margin:e.spacing(.5)})),ts=(0,d.ZP)("div")(({theme:e})=>({padding:e.spacing(1.75,2),display:"flex",alignItems:"center",cursor:"pointer",borderBottom:e.mixins.border("secondary"),"&:last-child":{borderBottom:"none"}})),td=(0,d.ZP)("span")(({theme:e})=>({...e.typography.h5,marginLeft:e.spacing(1)}));var tc=function(){let{i18n:e,dispatch:t}=(0,r.OgA)(),[n,d]=f.useState([]),{results:c,searching:u,searchText:p}=(0,l.eG)(),m=(0,l.Oy)(),g=(0,v.v9)(i.$J),[h,y]=f.useState(""),[x,w]=f.useState(!1),E=f.useCallback(()=>{let e=n.length;e&&t({type:"chatplus/newChatRoom/submit",payload:{users:n,pageMessage:!0}})},[t,n]),P=e=>{y(""),d(t=>[...t,e])},Z=e=>{d(t=>t.filter(t=>t.value!==e.value))},k=f.useCallback(e=>{var n,r;let l=null===(n=e.currentTarget)||void 0===n?void 0:n.value;if(l!==p&&t({type:"chatplus/newChatRoom/search",payload:{query:l}}),!l){let i=Object.values(g)?null===(r=Object.values(g))||void 0===r?void 0:r.slice(0,4):[];t({type:"chatplus/newChatRoom/search/updateUsers",payload:i})}},[t,p]),C=f.useCallback(e=>{var t;let n=null===(t=e.currentTarget)||void 0===t?void 0:t.value;y(n),w(!0)},[]),M=c.users.filter(e=>e.username!==m.username).map(e=>{return{value:e.username,label:e.name,_id:e._id,avatarETag:null==e?void 0:e.avatarETag}}),R=e8()(M,n,"value"),S=()=>{w(!1)};return f.createElement(e9,null,f.createElement(te,null,f.createElement(tr,null,e.formatMessage({id:"new_message"})),f.createElement(s.Qn,{onClickAway:S},f.createElement(tl,null,f.createElement(b.zj,{sx:{p:0},disabled:!n.length,valueSearch:h,onChangeSearch:C,onKeyUp:k,hide:!u,placeholder:e.formatMessage({id:"type_name_start_new_conversation"}),size:30,onSubmit:E,label:e.formatMessage({id:"submit"})}),f.createElement(ta,{users:n.length},n.map((e,t)=>f.createElement(to,{key:t},f.createElement(e4.Z,{size:"medium",onDelete:()=>Z(e),label:e.label})))),x?f.createElement(ti,{suggestList:Boolean(R&&R.length)},f.createElement("div",null,f.createElement(o.l$,{autoHide:!0,autoHeight:!0},R.map((e,t)=>{return f.createElement(f.Fragment,{key:t},f.createElement(ts,{onClick:()=>P(e)},f.createElement(ei.default,{name:e.label,username:e.value,size:32,roomType:a.n.Direct,avatarETag:null==e?void 0:e.avatarETag}),f.createElement(td,null,e.label)))})))):null))),f.createElement(tt,null,f.createElement(tn,null)))},tu=n(70214),tp=n(99164);let tm=(e,t)=>{let[n,l]=(0,f.useState)(!1),i=(0,r.lJz)(),a=e?e.current:i&&i.current;if((0,f.useEffect)(()=>{return a&&a.addEventListener("scroll",o),()=>{a&&a.removeEventListener("scroll",o)}},[a]),(0,f.useEffect)(()=>{n&&t()},[n]),!i||!i.current)return[n,l];function o(){a.clientHeight+a.scrollTop!==a.scrollHeight||n||l(!0)}return[n,l]};var tg=n(12482);let th=(0,d.ZP)("div")(({theme:e})=>({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:e.spacing(5.75),marginBottom:e.spacing(1.25)})),tf=(0,d.ZP)("div")(({theme:e})=>({display:"flex",alignItems:"center",overflow:"hidden"})),tv=(0,d.ZP)("div")(({theme:e})=>({display:"flex",flexDirection:"column",overflow:"hidden",marginRight:e.spacing(.5)})),tb=(0,d.ZP)(eS.Z)(({theme:e})=>({color:e.palette.primary.main,border:e.mixins.border("primary"),minWidth:e.spacing(5)})),ty=(0,d.ZP)(s.zb)(({theme:e})=>({color:e.palette.grey["600"],fontSize:e.spacing(5.75),marginRight:e.spacing(1)}));var tx=function(e){let{chatplus:t}=(0,r.OgA)(),n=(0,x.td)(e.size||0);return f.createElement(th,null,f.createElement(tf,null,f.createElement(ty,{icon:"ico-file-zip-o"}),f.createElement(tv,null,f.createElement(s.Ys,{lines:1,variant:"h5"},e.name),f.createElement(eI.Z,null,n))),f.createElement(tb,{onClick:()=>{return(0,x.Sv)(t.sanitizeRemoteFileUrl(null==e?void 0:e.url),!0)}},f.createElement(s.zb,{icon:"ico-download"})))};function tw(){return(tw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let tE="FileList",tP=(0,d.ZP)("div",{name:tE,slot:"NoContent"})(({theme:e})=>({...e.typography.body1,padding:e.spacing(2),textAlign:"center",flex:1,minHeight:0,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"100%",fontSize:e.mixins.pxToRem(16)})),tZ=(0,d.ZP)("div",{name:tE,slot:"description"})(({theme:e})=>({fontSize:e.mixins.pxToRem(14)})),tk=(0,d.ZP)("div",{name:tE,slot:"root"})(({theme:e})=>({padding:e.spacing(2)}));var tC=function(e){var t,n,i,a,o,s;let{room:d,scrollRefList:c,type:u}=e,{dispatch:p}=(0,r.OgA)(),m=(0,l.u_)(d.id),g=null!==(a=null==m?void 0:null===(t=m.other)||void 0===t?void 0:t.files)&&void 0!==a?a:[],h=null!==(o=null==m?void 0:null===(n=m.other)||void 0===n?void 0:n.total)&&void 0!==o?o:0,v=null!==(s=null==m?void 0:null===(i=m.other)||void 0===i?void 0:i.count)&&void 0!==s?s:0,b=f.useRef(!0),[y,x]=f.useState(!1),[w,E]=tm(c,function(){P(()=>{E(!1)})});f.useEffect(()=>{if(g.length)x(!0);else{var t;let n={rid:null==d?void 0:d.id,queryParam:null==e?void 0:e.query,sort:void 0,count:null!==(t=null==e?void 0:e.countLoad)&&void 0!==t?t:18,offset:0,type:null==e?void 0:e.type,callback:()=>{x(!0)}};p({type:"chatplus/room/getRoomFiles",payload:n})}},[u]);let P=t=>{if(h>v){var n;let r={rid:null==d?void 0:d.id,queryParam:null==e?void 0:e.query,sort:void 0,count:null!==(n=null==e?void 0:e.countLoad)&&void 0!==n?n:18,offset:v,type:null==e?void 0:e.type,callback:t};p({type:"chatplus/room/getRoomFiles",payload:r})}else E(!1),b.current=!1};return!y||w&&b.current?f.createElement(tg.Z,{size:32}):Array.isArray(g)&&!g.length&&y?f.createElement(tP,null,null==e?void 0:e.emptyPhrase,(null==e?void 0:e.emptyPhraseSub)?f.createElement(tZ,null,null==e?void 0:e.emptyPhraseSub):null):f.createElement(tk,null,g.map((e,t)=>f.createElement(tx,tw({key:t},e))))};let tM=(0,d.ZP)("div")(({theme:e})=>({padding:e.spacing(.5)})),tR=(0,d.ZP)("span")(({theme:e})=>({cursor:"pointer",display:"block",width:"100px",aspectRatio:"1",backgroundSize:"cover",backgroundPosition:"center center",backgroundRepeat:"no-repeat",backgroundOrigin:"border-box",border:"1px solid rgba(0, 0, 0, 0.1)",position:"relative"})),tS=(0,d.ZP)(s.zb,{name:"MediaItem",slot:"CustomPlayButton"})({position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",fontSize:"40px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2,background:"rgba(0, 0, 0, 0.3)",color:"#fff",pointerEvents:"none"});var tO=function(e){let{chatplus:t}=(0,r.OgA)(),{uploadedAt:n,keyIndex:l,listImages:i}=e;return f.createElement(tM,null,f.createElement(F.Z,{title:(0,x.jF)(null==n?void 0:n.$date),placement:"top"},f.createElement("div",null,(null==e?void 0:e.video_thumb_url)?f.createElement(tR,{style:{backgroundImage:`url(${t.sanitizeRemoteFileUrl(null==e?void 0:e.video_thumb_url)}&width=300)`},onClick:n=>{t.presentImageView(n,{id:parseInt(l),video_thumb_url:t.sanitizeRemoteFileUrl(null==e?void 0:e.video_thumb_url),src:t.sanitizeRemoteFileUrl(null==e?void 0:e.url),video_type:!!((null==e?void 0:e.type)&&e.type.match("video/*"))&&e.type},i)}},f.createElement(tS,{icon:"ico-play-circle-o"})):f.createElement(tR,{style:{backgroundImage:`url(${t.sanitizeRemoteFileUrl(null==e?void 0:e.url)}&width=300)`},onClick:n=>{t.presentImageView(n,{id:parseInt(l),src:t.sanitizeRemoteFileUrl(null==e?void 0:e.url)},i)}}))))};function t_(){return(t_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let tI="FileList",tA=(0,d.ZP)("div",{name:tI,slot:"no-content"})(({theme:e})=>({...e.typography.body1,padding:e.spacing(2),textAlign:"center",flex:1,minHeight:0,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"100%",fontSize:e.mixins.pxToRem(16)})),tz=(0,d.ZP)("div",{name:tI,slot:"description"})(({theme:e})=>({fontSize:e.mixins.pxToRem(14)})),tT=(0,d.ZP)("div",{name:tI,slot:"root"})(({theme:e})=>({padding:e.spacing(2)})),tF=(0,d.ZP)("div",{name:tI,slot:"content"})(({theme:e})=>({display:"flex",flexFlow:"wrap"}));var tB=function(e){var t,n,i,a,o,s;let{dispatch:d,chatplus:c}=(0,r.OgA)(),{room:u,type:p,scrollRefList:m}=e,g=(0,l.u_)(u.id),h=null!==(a=null==g?void 0:null===(t=g.media)||void 0===t?void 0:t.files)&&void 0!==a?a:[],v=null!==(o=null==g?void 0:null===(n=g.media)||void 0===n?void 0:n.total)&&void 0!==o?o:0,b=null!==(s=null==g?void 0:null===(i=g.media)||void 0===i?void 0:i.count)&&void 0!==s?s:0,[y,x]=f.useState(!1),w=f.useRef(!0),[E,P]=tm(m,function(){setTimeout(()=>{Z(()=>{P(!1)})},500)});f.useEffect(()=>{if(h.length)x(!0);else{var t;let n={rid:null==u?void 0:u.id,queryParam:null==e?void 0:e.query,sort:void 0,count:null!==(t=null==e?void 0:e.countLoad)&&void 0!==t?t:18,offset:0,type:null==e?void 0:e.type,callback:()=>{x(!0)}};d({type:"chatplus/room/getRoomFiles",payload:n})}},[p]);let Z=t=>{if(v>b){var n;let r={rid:null==u?void 0:u.id,queryParam:null==e?void 0:e.query,sort:void 0,count:null!==(n=null==e?void 0:e.countLoad)&&void 0!==n?n:18,offset:b,type:null==e?void 0:e.type,callback:t};d({type:"chatplus/room/getRoomFiles",payload:r})}else P(!1),w.current=!1},k=f.useMemo(()=>{return Array.isArray(h)&&!h.length?[]:h.map((e,t)=>{return{id:t,src:c.sanitizeRemoteFileUrl(e.url),video_type:!!((null==e?void 0:e.type)&&e.type.match("video/*"))&&!!e.type,video_thumb_url:(null==e?void 0:e.video_thumb_url)?c.sanitizeRemoteFileUrl(null==e?void 0:e.video_thumb_url):null}})},[h]);return!y||E&&w.current?f.createElement(tg.Z,{size:32}):Array.isArray(h)&&!h.length?f.createElement(tA,null,null==e?void 0:e.emptyPhrase,(null==e?void 0:e.emptyPhraseSub)?f.createElement(tz,null,null==e?void 0:e.emptyPhraseSub):null):f.createElement(tT,null,f.createElement(tF,null,h.map((e,t)=>f.createElement(tO,t_({key:t,listImages:k,keyIndex:t},e)))))},t$=n(44373);let tW="MemberItem",tj=(0,d.ZP)("div",{name:tW,slot:"UIChatBuddyItem"})(({theme:e})=>{var t;return{padding:e.spacing(0,2),display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid",borderColor:null===(t=e.palette.border)||void 0===t?void 0:t.secondary,"&:hover":{background:"dark"===e.palette.mode?e.palette.grey["700"]:e.palette.grey["50"]}}}),tL=(0,d.ZP)("div",{name:tW,slot:"UIChatBuddyItemWrapper"})(({theme:e})=>({padding:e.spacing(2,0),display:"flex",alignItems:"center",cursor:"pointer",flex:1})),tD=(0,d.ZP)("div")(({theme:e})=>({marginLeft:e.spacing(1.5),display:"flex",alignItems:"flex-start",flexDirection:"column",flex:1})),tH=(0,d.ZP)("div")(({theme:e})=>({color:e.palette.grey["600"],fontSize:e.spacing(2),padding:e.spacing(0,1)})),tN=(0,d.ZP)(s.Ys)(({theme:e})=>({display:"flex",flexDirection:"column",..."dark"===e.palette.mode&&{color:e.palette.grey["400"]}})),tU=(0,d.ZP)("div")(({theme:e})=>({...e.typography.body1,..."dark"===e.palette.mode&&{color:e.palette.grey["500"]}}));function tY({u:e,user:t,room:n,perms:l={}}){let{i18n:i,useActionControl:o,chatplus:d}=(0,r.OgA)(),c={moderator:0,leader:0,owner:0};e&&e.roles&&Array.isArray(e.roles)&&Object.keys(c).forEach(t=>{e.roles.includes(t)&&(c[t]=1)});let u=(null==e?void 0:e._id)===t._id,p=(null==n?void 0:n.muted)&&(null==n?void 0:n.muted.includes(null==e?void 0:e.username)),m=null==e?void 0:e._id,[g]=o(null==n?void 0:n._id,{}),h=[{label:"Un-mute",icon:"ico-unlock-o",value:"closeMenu, chatplus/room/unmuteUserInRoom",params:{userId:m},showWhen:["and",["truthy","perms.mute-user"],["falsy","isOwner"],["truthy","isMuted"]]},{label:"Mute",icon:"ico-lock",value:"closeMenu, chatplus/room/muteUserInRoom",params:{userId:m},showWhen:["and",["truthy","perms.mute-user"],["falsy","isOwner"],["falsy","isMuted"]]},{label:"Set as Owner",icon:"ico-businessman-plus",value:"closeMenu, chatplus/room/addRoomOwner",params:{userId:m},showWhen:["and",["truthy","perms.set-owner"],["falsy","roles.owner"],["falsy","isOwner"]]},{label:"Remove Owner",icon:"ico-businessman-del",value:"closeMenu, chatplus/room/removeRoomOwner",params:{userId:m},showWhen:["and",["truthy","perms.set-owner"],["truthy","roles.owner"]]},{label:"Set as Moderator",icon:"ico-businessman-plus",value:"closeMenu, chatplus/room/addRoomModerator",params:{userId:m},showWhen:["and",["truthy","perms.set-moderator"],["falsy","roles.moderator"],["falsy","isOwner"]]},{label:"Remove Moderator",icon:"ico-businessman-del",value:"closeMenu, chatplus/room/removeRoomModerator",params:{userId:m},showWhen:["and",["truthy","perms.set-moderator"],["truthy","roles.moderator"]]},{label:"Set as Leader",icon:"ico-businessman-plus",value:"closeMenu, chatplus/room/addRoomLeader",params:{userId:m},showWhen:["and",["truthy","perms.set-leader"],["falsy","roles.leader"],["falsy","isOwner"]]},{label:"Remove Leader",icon:"ico-businessman-del",value:"closeMenu, chatplus/room/removeRoomLeader",params:{userId:m},showWhen:["and",["truthy","perms.set-leader"],["truthy","roles.leader"]]},{label:"Remove user",icon:"ico-trash-o",value:"closeMenu, chatplus/room/removeUserFromRoom",params:{userId:m},showWhen:["and",["truthy","perms.remove-user"],["falsy","isOwner"]]}],v=f.useMemo(()=>(0,I.W$)(h,{isOwner:u,roles:c,perms:l,isMuted:p}),[u,c,l,p]);return e&&n?f.createElement(tj,null,f.createElement(tL,{onClick:()=>{return d.openDirectMessageByUserId(null==e?void 0:e._id)}},f.createElement(ei.default,{username:e.username,name:e.name,size:32,status:e.status,room:n,roomType:a.n.Direct,avatarETag:null==e?void 0:e.avatarETag,hoverCard:`/user/${null==e?void 0:e.metafoxUserId}`,component:r.QVN}),f.createElement(tD,null,f.createElement(tN,{lines:2,variant:"h5"},f.createElement(r.rUS,{children:e.name,hoverCard:`/user/${null==e?void 0:e.metafoxUserId}`,underline:"none",color:"inherit"})),f.createElement(tU,null,e.roles?e.roles.map(e=>i.formatMessage({id:e})).join(", "):null))),v.length?f.createElement(tH,null,f.createElement(s.VK,{identity:null==n?void 0:n._id,icon:"ico-dottedmore-vertical-o",items:v,menuName:"detailActionMenu",handleAction:g,size:"smaller",tooltipTitle:i.formatMessage({id:"more_options"})})):null,f.createElement(t$.Z,null)):null}let tV=(0,d.ZP)("div")(({theme:e})=>({}));var tX=function({room:e}){let{dispatch:t}=(0,r.OgA)(),n=f.useRef(),i=null==e?void 0:e.id,a=(0,l.Oy)(),s=(0,l.XP)(i),[d,c]=f.useState([]);f.useEffect(()=>{p()},[i,null==e?void 0:e.usersCount]);let u=e=>{Array.isArray(e.users)&&c(e.users)},p=()=>{t({type:"chatplus/room/presentMembers",payload:{rid:null==e?void 0:e.id},meta:{onSuccess:u}})};return h()(d)&&f.createElement(tg.Z,null),f.createElement(tV,null,f.createElement(o.l$,{ref:n},d.map((t,n)=>f.createElement(tY,{key:t._id,u:t,room:e,user:a,perms:s}))))};function tq(e){let t=f.useRef(),{children:n,value:r,index:l,...i}=e;return f.createElement("div",{role:"tabpanel",hidden:r!==l,id:`simple-tabpanel-${l}`,"aria-labelledby":`simple-tab-${l}`,style:{height:"100%"}},r===l?f.createElement(o.l$,{autoHide:!0,autoHeight:!0,autoHeightMax:"100%",ref:t},f.cloneElement(n,{...i})):null)}function tG(){return(tG=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let tQ="sideInfo",tK=(0,d.ZP)("div",{name:tQ})(({theme:e})=>({height:"100%",backgroundColor:e.palette.background.paper,position:"relative",borderLeft:e.mixins.border("secondary"),display:"flex",flexDirection:"column"})),tJ=(0,d.ZP)(eS.Z)(({theme:e})=>({position:"absolute",top:16,right:16,fontSize:e.spacing(2.25),color:e.palette.grey["600"]})),t0=(0,d.ZP)("div",{name:tQ})(({theme:e})=>({boxSizing:"border-box",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingTop:e.spacing(5)})),t1=(0,d.ZP)("div")(({theme:e})=>({padding:e.spacing(1.75,0),display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"})),t2=(0,d.ZP)(s.Ys)(({theme:e})=>({marginTop:e.spacing(2),textAlign:"center",padding:e.spacing(0,1)})),t5=(0,d.ZP)("span",{shouldForwardProp:e=>"bio"!==e})(({theme:e,bio:t})=>({...e.typography.body1,marginTop:e.spacing(1),...t&&{color:e.palette.text.hint}})),t6=(0,d.ZP)("div",{name:tQ})(({theme:e})=>({display:"flex",flexDirection:"column",height:"100%",backgroundColor:e.palette.background.paper,flex:1,overflow:"auto",marginTop:e.spacing(3)})),t4=(0,d.ZP)(eS.Z)(({theme:e})=>({fontSize:e.spacing(2),width:"90%"})),t7=(0,d.ZP)(tu.Z)(({theme:e})=>({...e.typography.h5}));function t8(e){let{toggleInfo:t,buddy:n,room:i}=e,{i18n:o,dispatch:d,dialogBackend:c,navigate:p,useIsMobile:m}=(0,r.OgA)(),g=m(),h=(0,l.XP)(null==i?void 0:i.id),v=(0,l.Fy)(),b=(0,l.Oy)(),y=(0,l.UV)(),x=(null==i?void 0:i.t)==="d",[w,E]=f.useState(0),[P,Z]=f.useState(null),k=f.useRef(),C=(()=>{try{if(i&&i.t===a.n.Direct&&1===i.usersCount)return b;if(i&&i.t===a.n.Direct&&2===i.usersCount){var e;let t=null==i?void 0:null===(e=i.uids)||void 0===e?void 0:e.find(e=>{return e!==(null==b?void 0:b._id)});if(!t)return null;let n=Object.values(y).find(e=>e._id===t);return n||null}}catch(r){return null}})(),M=f.useMemo(()=>{let e=o.formatMessage({id:"name"});if(null==i?void 0:i.isNameChanged)return(null==n?void 0:n.name)||e;let t=null==n?void 0:n.name.split(",");return(null==n?void 0:n.name)&&t.length>1?`${t[0]} +${t.length-1}`:null==n?void 0:n.name},[null==n?void 0:n.name,null==i?void 0:i.isNameChanged]);f.useEffect(()=>{Z(null)},[i]);let R=(e,t)=>{E(t)},S=f.useCallback(()=>{if(x&&C){window.open(`/${C.username}`,"_blank","noreferrer");return}h["edit-room"]&&k&&k.current&&k.current.click()},[p,n,x,k,h,C]),O=e=>{var t;e.preventDefault(),e.stopPropagation();let n=k.current;if(!n||!(null===(t=n.files)||void 0===t?void 0:t.length))return;let r=n.files[0],l=new FileReader,a="",s=(null==v?void 0:v.RoomAvatarUpload_MaxFileSize)||8e3;l.addEventListener("load",e=>{a=e.target.result;let t=null==r?void 0:r.size,n=r.name;if(t&&t<s&&0!==s){if(!a)return;Z(a),d({type:"chatplus/room/editSettings",payload:{identity:null==i?void 0:i.id,value:{roomAvatar:a}}})}else c.alert({message:o.formatMessage({id:"warning_upload_limit_one_file"},{fileName:(0,I.TX)(n,30),fileSize:(0,I.jA)(r.size),maxSize:(0,I.jA)(s)})})}),l.readAsDataURL(r)},_=[{label:o.formatMessage({id:"members"}).toUpperCase(),content:{component:f.createElement(tX,{room:i})},showWhen:["neq","room.t","d"]},{label:o.formatMessage({id:"files"}).toUpperCase(),query:{typeGroup:{$nin:["image","video"]}},type:"other",countLoad:18,content:{component:f.createElement(tC,{room:i})},emptyPhrase:o.formatMessage({id:"no_files"}),emptyPhraseSub:x?o.formatMessage({id:"no_files_subtext"},{name:null==n?void 0:n.name}):o.formatMessage({id:"no_files_group_subtext"})},{label:o.formatMessage({id:"media"}).toUpperCase(),query:{typeGroup:{$in:["image","video"]}},type:"media",countLoad:18,content:{component:f.createElement(tB,{room:i})},emptyPhrase:o.formatMessage({id:"no_media"}),emptyPhraseSub:x?o.formatMessage({id:"no_medias_subtext"},{name:null==n?void 0:n.name}):o.formatMessage({id:"no_medias_group_subtext"})}],A=f.useMemo(()=>(0,I.W$)(_,{room:i}),[i]);return f.createElement(tK,null,f.createElement(F.Z,{title:o.formatMessage({id:"close"}),placement:"top"},f.createElement(tJ,{onClick:t},g?f.createElement(s.zb,{icon:"ico-close"}):f.createElement(s.zb,{icon:"ico-goright"}))),f.createElement(t0,null,f.createElement(t1,null,f.createElement(ei.default,{name:null==n?void 0:n.name,username:null==n?void 0:n.username,src:P||(null==n?void 0:n.avatar),size:80,room:i,uploadLocal:!!P,avatarETag:null==n?void 0:n.avatarETag}),f.createElement(t2,{showFull:!0,variant:M.length<100?"h3":"h4"},M),f.createElement(t5,{bio:null==C?void 0:C.bio},x?null==C?void 0:C.bio:o.formatMessage({id:"total_user_member"},{value:(null==i?void 0:i.usersCount)||1}))),f.createElement("input",{accept:"image/*",style:{display:"none"},type:"file",ref:k,onChange:O}),x&&f.createElement(t4,{variant:"outlined",onClick:S},o.formatMessage({id:"view_main_profile"})),!x&&h["edit-room"]&&f.createElement(t4,{variant:"outlined",onClick:S},o.formatMessage({id:"change_group_image"}))),f.createElement(t6,null,f.createElement(tp.Z,{value:w,onChange:R},A.map((e,t)=>{return f.createElement(t7,tG({key:t,label:e.label},{id:`simple-tab-${t}`,"aria-controls":`simple-tabpanel-${t}`}))})),f.createElement(u.Z,{sx:{flex:1}},A.map((e,t)=>{var n;return f.createElement(tq,tG({key:t,value:w,index:t},e),null==e?void 0:null===(n=e.content)||void 0===n?void 0:n.component)}))))}let t3="PreviewUploadFile",t9=(0,d.ZP)("img",{name:t3,slot:"previewImage"})(({theme:e})=>({borderRadius:e.spacing(1),maxWidth:"52px",width:"52px",height:"52px",marginRight:e.spacing(2),objectFit:"cover"})),ne=(0,d.ZP)("div",{name:t3,slot:"PreviewFile",shouldForwardProp:e=>"isAllPage"!==e})(({theme:e,isAllPage:t})=>({borderRadius:e.spacing(1),maxWidth:"150px",width:"150px",height:"52px",marginRight:e.spacing(2),fontSize:e.spacing(1.5),display:"flex",alignItems:"center",background:"light"===e.palette.mode?e.palette.background.default:e.palette.grey["500"],...t&&{maxWidth:"180px",width:"180px",overflowX:"hidden"}})),nt=(0,d.ZP)("div",{name:t3,slot:"IconFile"})(({theme:e})=>({borderRadius:"100%",maxWidth:"28px",width:"28px",height:"28px",margin:e.spacing(0,1),padding:e.spacing(0,1),color:e.palette.default.contrastText,background:"light"===e.palette.mode?e.palette.grey["500"]:e.palette.grey["700"],display:"inline-flex",justifyContent:"center",alignItems:"center"})),nn=(0,d.ZP)("div",{name:t3,slot:"closeButton"})(({theme:e})=>({position:"absolute",top:"-8px",right:"8px",cursor:"pointer",width:e.spacing(2.5),height:e.spacing(2.5),backgroundColor:e.palette.grey["500"],borderRadius:"50%",fontSize:e.mixins.pxToRem(8),justifyContent:"center",alignItems:"center",display:"inline-flex",opacity:.8,color:(e.palette.mode,e.palette.text.primary),"&:hover":{backgroundColor:e.palette.background.default,color:e.palette.text.primary,border:e.mixins.border("secondary")}})),nr=(0,d.ZP)(s.Ys)(({theme:e})=>({paddingRight:e.spacing(1),wordBreak:"break-word",p:{fontSize:e.mixins.pxToRem(12)}}));var nl=function({onRemove:e,file:t,isAllPage:n}){let r=t.type,l=["image/gif","image/jpeg","image/png"].includes(r),i=l?URL.createObjectURL(t):"";return f.createElement(u.Z,{display:"inline-flex",position:"relative"},l?f.createElement(t9,{src:i,alt:"Preview"}):f.createElement(ne,{isAllPage:n},f.createElement(nt,null,f.createElement(s.zb,{icon:"ico-paperclip-alt"})),f.createElement(nr,{lines:2},t.name)),f.createElement(u.Z,{position:"absolute",top:1,right:1},f.createElement(nn,{"data-testid":"buttonRemove",onClick:e,"aria-label":"Close"},f.createElement(s.zb,{icon:"ico-close"}))))};let ni=(0,d.ZP)("div",{shouldForwardProp:e=>"isAllPage"!==e})(({theme:e,isAllPage:t})=>({background:e.palette.background.paper,padding:e.spacing(2,1,0,1),display:"flex",overflow:"hidden",borderTop:e.mixins.border("secondary"),userSelect:"none",height:"90px",minHeight:"90px"})),na=(0,d.ZP)("div")(({theme:e})=>({display:"flex",overflowX:"auto",paddingTop:e.spacing(1),marginBottom:e.spacing(.5),paddingBottom:e.spacing(.5),"&::-webkit-scrollbar":{height:"5px",width:"5px",background:"transparent",borderRadius:e.spacing(.5),transition:"opacity 200ms"},"&::-webkit-scrollbar-track":{margin:e.spacing(.5,0),borderRadius:e.spacing(.5),background:"light"===e.palette.mode?"white":e.palette.grey["300"]},"&::-webkit-scrollbar-thumb":{background:e.palette.grey["600"],borderRadius:e.spacing(.5)},"&::-webkit-scrollbar-thumb:hover":{background:e.palette.grey["700"]},"&::-webkit-scrollbar-thumb:horizontal":{background:e.palette.grey["700"],borderRadius:"10px"}})),no=(0,d.ZP)("div",{slot:"ButtonAdd"})(({theme:e})=>({marginRight:e.spacing(1),cursor:"pointer",span:{background:"light"===e.palette.mode?e.palette.background.default:e.palette.grey["500"],"&:hover":{background:e.palette.action.hover},borderRadius:e.spacing(1),maxWidth:"52px",width:"52px",height:"52px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:e.spacing(2.5)}}));var ns=f.forwardRef(function({filesUploadRef:e,isAllPage:t},n){let[r,l]=f.useState([]),[i,a]=f.useState("image"),o=f.useRef(),d=f.useRef(),c=t=>{let n=[...r];if(t>-1&&(n.splice(t,1),l([...n]),e)){var i;null===(i=e.current)||void 0===i||i.removeFile(t)}};if(f.useImperativeHandle(n,()=>{return{attachFiles:e=>{(null==e?void 0:e.length)&&l(e)},typeUpload:e=>{e&&a(e)},clear:()=>{l([])},checkIsLoading:()=>{}}}),!r||!(null==r?void 0:r.length))return null;let u=()=>{o.current.click()},p=()=>{d.current.click()},m=()=>{if("image"===i){u();return}p()},g=()=>{if(!o.current.files.length)return;let t=[...r,...o.current.files];if(l(t),e){var n;null===(n=e.current)||void 0===n||n.attachFiles(t)}},h=()=>{if(!d.current.files.length)return;let t=[...r,...d.current.files];if(l(t),e){var n;null===(n=e.current)||void 0===n||n.attachFiles(t)}};return f.createElement(ni,{isAllPage:t},f.createElement(na,null,Object.values(r).map((e,n)=>f.createElement(nl,{key:n,file:e,onRemove:()=>c(n),isAllPage:t})),f.createElement(no,{onClick:m},f.createElement("span",null,f.createElement(s.zb,{icon:"ico-text-file-plus"})))),f.createElement("input",{"data-testid":"inputAttachPhoto",onChange:g,multiple:!0,ref:o,style:{display:"none"},type:"file",accept:"image/*"}),f.createElement("input",{style:{display:"none"},type:"file",multiple:!0,ref:d,onChange:h}))}),nd=n(32990),nc=n(38781);let nu="ChatRoomPanel",np=(0,d.ZP)("div")(({theme:e})=>({borderLeft:e.mixins.border("secondary"),backgroundColor:e.palette.background.paper,display:"flex",flexDirection:"row",width:"100%",height:"100%"})),nm=(0,d.ZP)("div",{name:nu,slot:"mainContent",shouldForwardProp:e=>"isMobile"!==e})(({theme:e,isMobile:t})=>({flex:1,display:"flex",width:"100%",height:"100%",...t&&{flexDirection:"column"}})),ng=(0,d.ZP)("div")(({theme:e})=>({display:"flex",flexDirection:"row",flex:1,width:"100%",minHeight:0})),nh=(0,d.ZP)("div",{name:nu,slot:"Main",shouldForwardProp:e=>"isMobile"!==e&&"openInfo"!==e})(({theme:e,isMobile:t,openInfo:n})=>({flex:1,display:"flex",flexDirection:"column",overflow:"hidden",height:"100%",...t&&n&&{flex:0,display:"none"}})),nf=(0,d.ZP)("div",{name:nu,slot:"sideInfoStyled",shouldForwardProp:e=>"isMobile"!==e})(({theme:e,isMobile:t})=>({flexBasis:"360px",...t&&{flex:1},overflow:"hidden"})),nv=(0,d.ZP)("div")(({theme:e})=>({textAlign:"center",padding:e.spacing(2),fontStyle:"italic",color:"dark"===e.palette.mode?e.palette.text.primary:e.palette.grey["700"],fontSize:e.spacing(1.75)})),nb=(0,d.ZP)("div",{name:nu,slot:"ReplyEditWrapper"})(({theme:e})=>({padding:e.spacing(.625,1.25),height:"50px",width:"100%",borderTop:e.mixins.border("secondary"),display:"flex",justifyContent:"space-between",backgroundColor:"dark"===e.palette.mode?e.palette.grey["600"]:e.palette.grey["100"]})),ny=(0,d.ZP)(s.Ys,{name:nu,slot:"SelectedMsg"})(({theme:e})=>({color:e.palette.text.primary,a:{pointerEvents:"none",color:e.palette.text.primary}})),nx=(0,d.ZP)(s.zb,{name:nu,slot:"LineIconClose"})(({theme:e})=>({cursor:"pointer",alignSelf:"center"})),nw=(0,d.ZP)("div",{name:nu,slot:"SelectedMsgAttachment"})(({theme:e})=>({fontSize:e.spacing(1.5),margin:e.spacing(.5,0),"& .ico":{marginRight:e.spacing(.5)}})),nE=(0,d.ZP)("div",{name:nu,slot:"ContentWrapper"})(({theme:e})=>({overflow:"hidden"}));var nP=(0,r.j4Z)({name:"ChatRoomPanel",extendBlock:function(e){var t;let{i18n:n,jsxBackend:d,usePageParams:p,useActionControl:g,dispatch:y,useIsMobile:x}=(0,r.OgA)(),w=x(),E=p(),{rid:P,noConversation:Z}=E,k=f.useRef(),C=(0,l.pB)(P),M=(0,l.F5)(P),R=(0,l.jS)(P),S=(0,l.dC)(P),O=(0,v.v9)(e=>(0,i.TC)(e,P)),_=(0,l.Oy)(),I=(0,l.Fy)(),A=(0,l.XP)(P),z=(0,l.ID)(null==M?void 0:M.userId),T=(0,l.Pu)(P),[F]=g(P,{}),[B,$]=f.useState(!1),[W,j]=(0,f.useState)("no_react"),[L,D]=(0,f.useState)(),[H,N]=f.useState(!1),U=(0,c.Z)(),Y=f.useRef(),V=f.useRef(),X=f.useRef(),q=d.get("ChatComposer"),G=f.useRef(),Q=e=>{if(e.target.scrollTop<100&&!H){let{oldest:t,endLoadmoreMessage:n}=C;t&&!n&&(G.current=e.target.scrollHeight-e.target.clientHeight,N(!0),y({type:"chatplus/room/loadHistory",payload:{rid:P,oldest:t},meta:{onSuccess:()=>{N(!1)}}}))}};f.useEffect(()=>{if(!(null==C?void 0:C.oldest)||!G.current)return;let e=k.current.scrollHeight-k.current.clientHeight;k.current.scrollTop=0+(e-G.current),G.current=0},[null==C?void 0:C.oldest]);let K=f.useCallback(()=>{R.alert&&y({type:"chatplus/room/markAsRead",payload:{identity:P}})},[R,P,y]),J=()=>{j("no_react"),D(void 0)};f.useEffect(()=>{return P&&(y({type:"chatplus/room/markAsRead",payload:{identity:P}}),y({type:"chatplus/openRooms/activeRoom",payload:P})),()=>{y({type:"chatplus/openRooms/activeRoom",payload:void 0}),$(!1)}},[P]),f.useEffect(()=>{return M&&R&&C&&O&&y({type:"chatplus/room/active",payload:{rid:P}}),()=>{y({type:"chatplus/room/inactive",payload:{rid:P}}),y({type:"chatplus/room/closeSearching",payload:{identity:P}}),J()}},[P,C&&M&&R&&O]);let ee=f.useCallback(()=>$(e=>!e),[]),{isQuote:et}=(0,nd.checkIsQuote)(null==L?void 0:L.attachments),en=f.useMemo(()=>{return(null==L?void 0:L.msg)?(0,nc.Hj)(null==L?void 0:L.msg,{mentions:null==L?void 0:L.mentions}):""},[L]);if(!P&&Z&&!w)return f.createElement(tc,null);let er=!!(null==R?void 0:R.archived),el=!!((null==M?void 0:M.t)===a.n.Direct&&((null==R?void 0:R.blocked)||(null==R?void 0:R.blocker))),ei=!!((null==M?void 0:M.t)===a.n.Direct&&((null==R?void 0:R.metafoxBlocked)||(null==R?void 0:R.metafoxBlocker))),ea=!!(el||ei),eo=!((null==R?void 0:R.allowMessageFrom)!=="noone"),es=(null==C?void 0:C.newest)||0,ed=null==C?void 0:C.roomProgress,ec=M&&(null==M?void 0:M.typing)||[],eu=eo||ea,ep=_&&M&&M.muted&&m()(M.muted)&&!!M.muted.find(e=>e===_.username),em=(null==M?void 0:M.ro)&&(null==M?void 0:M.t)!==a.n.Direct&&!(null==A?void 0:A.postReadonly)||!!er,eg=(e,t)=>{if(!e)return;let n=e.split(/.,| /);n.forEach(e=>{switch(e){case"chatplus/replyMessage":j("reply"),D(t);break;case"chatplus/editMessage":j("edit"),D(t)}})},eh=()=>{J(),(null==X?void 0:X.current)&&X.current.scrollToBottom()},ef={backgroundColor:U.palette.background.paper};return f.createElement(np,null,f.createElement(nm,{isMobile:w},w?f.createElement(e6,{buddy:O,perms:A,userChat:z,room:M,toggleInfo:ee,messageFilter:S,chatRoom:C,subscription:R,searching:null==C?void 0:C.searching,settings:I,isSelfChat:T,allowMsgNoOne:eo,isReadOnly:em,isMetaFoxBlocked:ei,isBlocked:ea,openInfo:B}):null,f.createElement(ng,null,f.createElement(nh,{isMobile:w,openInfo:B},w?null:f.createElement(e6,{buddy:O,perms:A,userChat:z,room:M,toggleInfo:ee,messageFilter:S,chatRoom:C,subscription:R,searching:null==C?void 0:C.searching,settings:I,isSelfChat:T,allowMsgNoOne:eo,isReadOnly:em,isMetaFoxBlocked:ei,isBlocked:ea,openInfo:B}),f.createElement(u.Z,{sx:{flex:1,minHeight:0}},f.createElement(o.l$,{autoHide:!1,autoHeight:!0,autoHeightMax:"100%",ref:k,style:ef,onScroll:Q},(null==C?void 0:C.searching)||!(null==C?void 0:C.endLoadmoreMessage)?null:f.createElement(nv,null,n.formatMessage({id:"start_of_conversation"})),(null==C?void 0:C.searching)&&S?f.createElement(u.Z,{sx:{mt:2}},f.createElement(eC,{user:_,items:S,archived:er,room:M,isMobile:!1,settings:I,disableReact:eu,handleAction:F})):f.createElement(ev,{rid:P,typing:ec,groupIds:null==C?void 0:C.groupIds,groups:null==C?void 0:C.groups,roomProgress:ed,newest:es,archived:er,room:M,subscription:R,isMobile:!1,settings:I,user:_,containerRef:k,disableReact:eu,handleAction:eg,isAllPage:!0,ref:X}))),"no_react"!==W&&f.createElement(nb,null,f.createElement(nE,null,f.createElement("div",null,"reply"===W?n.formatMessage({id:"reply_to_user_at_timestamp"},{user:null==L?void 0:null===(t=L.u)||void 0===t?void 0:t.name,time:new Date(L.ts.$date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}):n.formatMessage({id:"editing"})),h()(null==L?void 0:L.attachments)?f.createElement(ny,{lines:1,dangerouslySetInnerHTML:{__html:en}}):et?f.createElement(ny,{lines:1,dangerouslySetInnerHTML:{__html:en}}):f.createElement(nw,null,f.createElement(s.zb,{icon:"ico-paperclip-alt"}),f.createElement("span",null,n.formatMessage({id:"file_attachment"})," "))),f.createElement(nx,{icon:"ico-close",onClick:()=>j("no_react")})),f.createElement(ns,{ref:Y,filesUploadRef:V,isAllPage:!0}),f.createElement(b.jH,{archived:er,isReadOnly:em,isMuted:ep,searching:null==C?void 0:C.searching,isBlocked:ea,reactMode:W,allowMsgNoOne:eo},f.createElement(q,{rid:P,room:M,user:_,msgId:null==L?void 0:L.id,reactMode:W,text:"edit"===W?en:"",onSuccess:eh,onMarkAsRead:K,subscription:R,previewRef:Y,ref:V,isAllPage:!0}))),B?f.createElement(nf,{isMobile:w},f.createElement(t8,{toggleInfo:ee,buddy:O,room:M})):null)))}})},94767:function(e,t,n){"use strict";n.d(t,{zj:function(){return u},jH:function(){return y},BB:function(){return R}});var r=n(16473),l=n(30120),i=n(21822),a=n(81719),o=n(67294);let s=(0,a.ZP)("div",{name:"ChatDockFilter"})(({theme:e})=>({position:"relative"})),d=(0,a.ZP)(l.Z,{name:"ChatDockFilter"})(({theme:e})=>({padding:e.spacing(1,2,1,2),display:"flex",flexDirection:"row",alignItems:"center"})),c=(0,a.ZP)(i.Z,{name:"ChatDockFilter"})(({theme:e})=>({marginLeft:e.spacing(.5)}));function u({placeholder:e,size:t,hide:n=!1,label:l,disabled:i,valueSearch:a,onChangeSearch:u,onKeyUp:p,onSubmit:m,variant:g="direct",isShowButtonSubmit:h=!0,sx:f}){return n?null:o.createElement(s,null,o.createElement(d,{sx:f},o.createElement(r.Rj,{placeholder:e,onKeyUp:p,value:a,onChange:u}),h&&m?o.createElement(c,{disabled:i,size:"medium",color:"primary",variant:"text",onClick:m},l):null))}n(39312);var p=n(93836),m=n(85597);n(21241),n(70735),n(69709);let g="AddNewMembers",h=((0,a.ZP)("div")(({theme:e})=>({padding:e.spacing(0,1,0,2)})),(0,a.ZP)("div",{shouldForwardProp:e=>"users"!==e})(({theme:e,users:t})=>({...t&&{padding:e.spacing(0,1,1,2)},listStyle:"none",display:"flex",alignItems:"center",flexWrap:"wrap"})),(0,a.ZP)("li")(({theme:e})=>({margin:e.spacing(.5)})),(0,a.ZP)("div")(({theme:e})=>({padding:e.spacing(1.75,0),display:"flex",alignItems:"center",cursor:"pointer"})),(0,a.ZP)("span")(({theme:e})=>({...e.typography.h5,marginLeft:e.spacing(1)})),(0,a.ZP)("div",{name:g,slot:"RootSearch"})(({theme:e})=>({})),(0,a.ZP)("div",{name:g,slot:"SearchControl"})(({theme:e})=>({padding:e.spacing(0,1,0,2),display:"flex",flexDirection:"row",alignItems:"center"})),(0,a.ZP)(i.Z,{name:g,slot:"ButtonCustom"})(({theme:e})=>({marginLeft:e.spacing(.5)})),(0,a.ZP)("input",{name:g,slot:"InputWrapper"})(({theme:e})=>({zIndex:"auto",backgroundColor:e.mixins.backgroundColor("paper"),color:"dark"===e.palette.mode?e.palette.grey["50"]:e.palette.grey["700"],height:"35px",borderRadius:"2px",fontSize:"14px",padding:"8px",paddingLeft:"12px",paddingRight:"72px",display:"block",width:"100%",margin:"0",border:e.mixins.border("secondary"),"&:focus":{borderColor:"#a2a2a2",boxShadow:"0 1px 4px 0 rgba(0,0,0,0.1)",outline:"none"},"&::placeholder":{fontSize:"14px"}})),(0,a.ZP)("div",{name:"ChatDockContent",slot:"root",shouldForwardProp:e=>"searching"!==e&&"collapsed"!==e})(({theme:e,searching:t,collapsed:n})=>({flex:1,maxHeight:"100%",position:"relative",paddingBottom:e.spacing(.75),...t&&{borderTop:"none"},...n&&{display:"none"},"&::-webkit-scrollbar":{height:"5px",width:"5px",background:"gray",borderRadius:e.spacing(.5),transition:"opacity 200ms"},"&::-webkit-scrollbar-track":{borderRadius:e.spacing(.5),background:"light"===e.palette.mode?"white":e.palette.grey["300"]},"&::-webkit-scrollbar-thumb":{background:e.palette.grey["600"],borderRadius:e.spacing(.5)},"&::-webkit-scrollbar-thumb:hover":{background:e.palette.grey["700"]},"&::-webkit-scrollbar-thumb:horizontal":{background:"#000",borderRadius:"10px"}})),"ChatDockFooter"),f=(0,a.ZP)("div",{name:h,slot:"root",shouldForwardProp:e=>"isAllPageMessages"!==e})(({theme:e,isAllPageMessages:t})=>({position:"relative",display:"flex",minHeight:e.spacing(5),zIndex:2,backgroundColor:e.palette.background.paper,borderTop:e.mixins.border("secondary"),...t&&{minHeight:e.spacing(6)}})),v=(0,a.ZP)("div",{name:h,slot:"uiChatRoomFooter",shouldForwardProp:e=>"disable"!==e&&"isAllPageMessages"!==e})(({theme:e,disable:t,isAllPageMessages:n})=>({position:"relative",borderTop:e.mixins.border("secondary"),display:"flex",alignItems:"flex-end",minHeight:e.spacing(5),zIndex:2,flexFlow:"wrap",justifyContent:"center",...t&&{userSelect:"none",backgroundColor:"dark"===e.palette.mode?e.palette.grey["700"]:e.palette.background.paper},...n&&{minHeight:e.spacing(6)}})),b=(0,a.ZP)("div",{name:h,slot:"uiChatComposerContainer"})(({theme:e})=>({textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",padding:"4px 8px",color:e.palette.grey["500"]}));function y({children:e,archived:t,isReadOnly:n,isMuted:r,searching:l,isBlocked:i,reactMode:a,allowMsgNoOne:s}){let{i18n:d,usePageParams:c}=(0,m.OgA)(),u=c(),p=(null==u?void 0:u.isAllPageMessages)||!1;return l?null:t?o.createElement(v,{disable:!0,isAllPageMessages:p},o.createElement(b,null,d.formatMessage({id:"this_group_is_archived"}))):n?o.createElement(v,{disable:!0,isAllPageMessages:p},o.createElement(b,null,d.formatMessage({id:"this_group_is_readonly"}))):r?o.createElement(v,{disable:!0,isAllPageMessages:p},o.createElement(b,null,d.formatMessage({id:"you_have_been_muted_in_this_group"}))):i||s&&"edit"!==a?o.createElement(v,{disable:!0,isAllPageMessages:p},o.createElement(b,null,d.formatMessage({id:"you_can_not_send_message_in_this_conversation"}))):o.createElement(f,{isAllPageMessages:p},e)}(0,a.ZP)("div",{shouldForwardProp:e=>"searching"!==e&&"addNewMembers"!==e})(({theme:e,searching:t,addNewMembers:n})=>({display:"flex",alignItems:"center",minHeight:e.spacing(7),padding:e.spacing(1.5,1.25,1.5,2),borderBottom:e.mixins.border("secondary"),...(t||n)&&{borderBottom:"none"}}));let x="ChatDockPanel";(0,a.ZP)("div",{name:x,slot:"Root"})(({theme:e})=>({display:"flex",alignItems:"flex-end",marginLeft:e.spacing(2),width:"328px",zIndex:999})),(0,a.ZP)("div",{name:x,slot:"PanelStyled"})(({theme:e})=>({display:"flex",flexDirection:"column",zIndex:10,backgroundColor:e.mixins.backgroundColor("paper"),borderTopLeftRadius:"4px",borderTopRightRadius:"4px",boxShadow:"0 0 4px 0 rgba(0,0,0,0.2)",wordBreak:"break-word",wordWrap:"break-word",borderStartStartRadius:e.spacing(1),borderStartEndRadius:e.spacing(1),height:"455px",maxHeight:"calc(100vh - 60px)"})),(0,a.ZP)("div",{name:x,slot:"StageStyled"})(({theme:e})=>({width:"100%"})),n(42963),n(23279);var w=n(22410),E=n(73327);(0,w.Z)(e=>(0,E.Z)({optionLabel:{width:"32px",height:"32px",display:"inline-flex",alignItems:"center",justifyContent:"center",margin:"0",color:"#a2a2a2"},optionChecked:{color:e.palette.primary.main},optionInput:{display:"none"},optionIcon:{display:"inline-flex",alignItems:"center",marginTop:"1px",height:"14px",marginRight:"4px"}}),{name:"ChatDockSearchFilter"}),(0,a.ZP)("div")(({theme:e})=>({})),(0,a.ZP)("div")(({theme:e})=>({display:"inline-flex"})),(0,a.ZP)("label",{shouldForwardProp:e=>"id"!==e})(({theme:e,id:t})=>({cursor:"pointer",..."close"===t&&{"& span.ico":{"&:hover":{background:e.palette.action.selected,width:e.spacing(2.8),height:e.spacing(2.8),display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"40px"}}}})),(0,a.ZP)(l.Z,{name:"SearchBox",slot:"Root"})(({theme:e})=>({margin:e.spacing(0,2,1,2),height:e.spacing(5),borderRadius:e.spacing(2.5),display:"flex",alignItems:"center",backgroundColor:e.palette.action.hover})),n(42977);var P=n(6867);n(81763),(0,a.ZP)("div")(({theme:e})=>({flex:1,fontWeight:"bold",display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"})),(0,a.ZP)("span",{shouldForwardProp:e=>"status"!==e})(({theme:e,status:t})=>({fontSize:e.mixins.pxToRem(13),color:e.palette.text.primary,lineHeight:e.spacing(2.375),...t===p.d.Offline&&{color:e.palette.text.secondary}})),(0,a.ZP)("span",{shouldForwardProp:e=>"variant"!==e})(({theme:e,variant:t,type:n})=>({...e.typography.subtitle1,fontSize:"15px",lineHeight:e.spacing(2.375),...n===p.n.Direct&&{":hover":{cursor:"pointer",textDecoration:"underline"}},..."new_message"===t&&{fontSize:e.typography.pxToRem(18),":hover":{cursor:"auto",textDecoration:"none"}}})),(0,a.ZP)(P.Z,{shouldForwardProp:e=>"status"!==e})(({theme:e,status:t})=>({margin:e.spacing(0,1,0,.5),"& .MuiBadge-badge":{...1===t&&{color:e.palette.success.main,backgroundColor:e.palette.success.main},...2===t&&{color:e.palette.warning.main,backgroundColor:e.palette.warning.main},...3===t&&{color:e.palette.error.main,backgroundColor:e.palette.error.main},"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}}})),(0,a.ZP)("div",{name:"DockPanelTitle"})(({theme:e})=>({display:"flex",alignItems:"center",marginTop:e.spacing(.25)}));var Z=n(30998),k=n.n(Z),C=(0,w.Z)(e=>(0,E.Z)({root:{display:"flex",padding:"0",margin:"0",listStyle:"none"},item:{position:"relative",lineHeight:"34px",padding:"0",margin:"0",".panelHeader &":{height:"30px",width:"30px",marginLeft:e.spacing(.5)},".panelHeader &:hover button":{color:e.palette.text.secondary,backgroundColor:e.palette.action.selected,borderRadius:"50%"}},btn:{height:"34px",lineHeight:"20px",fontSize:"17px",padding:"0 6px",cursor:"pointer",color:"light"===e.palette.mode?e.palette.grey["600"]:e.palette.text.secondary,position:"relative",minWidth:e.spacing(3),display:"inline-flex",textAlign:"center",alignItems:"center",justifyContent:"center",border:"none",outline:"none",backgroundColor:"transparent",".panelHeader &":{height:"30px",width:"30px"}},itemActive:{},btnActive:{color:e.palette.primary.main}}),{name:"ChatDockToolbar"});let M=(0,a.ZP)("div",{name:"ToolbarChat",slot:"root",shouldForwardProp:e=>"variant"!==e})(({theme:e,variant:t})=>({display:"flex",padding:"0",margin:"0",listStyle:"none","& .MuiActionMenu-menu":"roomPanel"===t&&{overflow:"auto",maxHeight:"200px","&::-webkit-scrollbar":{height:"6px",width:"6px",background:"transparent",borderRadius:"3px",transition:"opacity 200ms"},"&::-webkit-scrollbar-track":{margin:e.spacing(.5,0),borderRadius:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.2)",borderRadius:"3px"},"&::-webkit-scrollbar-thumb:horizontal":{background:"#000",borderRadius:"10px"}},..."pageMessage"===t&&{"& .MuiListItem-root .ico":{fontSize:e.mixins.pxToRem(13)}}}));function R({items:e,displayLimit:t=4,variant:n=null,handleAction:l,popperOptions:i}){var a,s,d;let c=C();if(!Array.isArray(e))return null;if("roomPanel"===n){let u=t-2,p=k()(e,{testid:"startVoiceCall"}),m=k()(e,{testid:"startVideoChat"});u=t-2-(p>-1?0:1)-(m>-1?0:1);let g=e.filter((e,t)=>{return t<u||e.behavior}),h=k()(g,{behavior:"more"});if(h>-1){if(null===(a=g[h].items)||void 0===a?void 0:a.length)g[h].as="dropdown";else{let f=e.filter((e,t)=>t>u-1&&!e.behavior);g[h]={...g[h],items:f,as:"dropdown"}}}return o.createElement(M,{variant:n},o.createElement(r.sd,{items:g,prefixName:"chatplusToolbar.item.",fallbackName:"button",classes:c,handleAction:l,popperOptions:i}))}if("pageMessage"===n){let v=e.filter((e,t)=>{return e.behavior}),b=k()(v,{behavior:"more"});if(b>-1){if(null===(s=v[b].items)||void 0===s?void 0:s.length)v[b].as="dropdown";else{let y=e.filter((e,t)=>!e.behavior);v[b]={...v[b],items:y,as:"dropdown"}}}return o.createElement(M,{variant:n},o.createElement(r.sd,{items:v,prefixName:"chatplusToolbar.item.",fallbackName:"button",classes:c,handleAction:l,variant:n,popperOptions:i}))}let x=e.filter((e,n)=>n<t-1||e.behavior),w=k()(x,{behavior:"more"});if(w>-1){if(null===(d=x[w].items)||void 0===d?void 0:d.length)x[w].as="dropdown";else{let E=e.filter((e,n)=>n>t-2&&!e.behavior);x[w]={...x[w],items:E,as:"dropdown"}}}return o.createElement(M,null,o.createElement(r.sd,{items:x,prefixName:"chatplusToolbar.item.",fallbackName:"button",classes:c,handleAction:l,popperOptions:i}))}},83940:function(e,t,n){"use strict";var r=n(93836),l=n(67294),i=n(69709);t.Z=(0,l.memo)(function({username:e,name:t,size:n="sm",status:a=null,room:o=null,avatarETag:s,hoverCard:d}){return l.createElement(i.default,{username:e,size:n,name:t,roomType:r.n.Direct,status:a,room:o,avatarETag:s,hoverCard:d})})},96211:function(e,t,n){"use strict";var r=n(40684),l=n(85597),i=n(81719),a=n(67294);let o=(0,i.ZP)("audio",{slot:"AudioPre"})(({theme:e})=>({visibility:"hidden",height:0})),s=(0,i.ZP)("div",{slot:"uiChatAudioCustom",shouldForwardProp:e=>"isPageAllMessages"!==e&&"msgType"!==e&&"isOwner"!==e&&"isOther"!==e})(({theme:e,isPageAllMessages:t,msgType:n,isOwner:r,isOther:l})=>({width:"300px",maxWidth:"100%",...("message_pinned"===n||"message_unpinned"===n||l)&&{width:r?"177px":"137px"},...("message_pinned"===n||"message_unpinned"===n||l)&&t&&{width:"200px"},"& .rhap_container":{borderRadius:"4px",boxSizing:"border-box",display:"flex",flexDirection:"column",lineHeight:1,fontFamily:"inherit",width:"100%",padding:"10px 15px",backgroundColor:"#fff",boxShadow:"0 0 3px 0 rgba(0, 0, 0, 0.2)"},"& .rhap_main":{display:"flex",flexDirection:"column",flex:"1 1 auto","& .rhap_button-clear":{backgroundColor:"transparent",border:"none",padding:0,overflow:"hidden",cursor:"pointer"}},"& .rhap_progress-section":{display:"flex",flex:"3 1 auto",alignItems:"center","& .rhap_time":{color:"#555555",userSelect:"none",fontSize:t?"16px":"12px"},"& .rhap_progress-container":{display:"flex",alignItems:"center",height:"20px",flex:"1 0 auto",alignSelf:"center",margin:"0 calc(11px)",cursor:"pointer",userSelect:"none","& .rhap_progress-bar-show-download":{backgroundColor:"rgba(221, 221, 221, 0.5)"},"& .rhap_progress-bar":{boxSizing:"border-box",position:"relative",zIndex:0,width:"100%",height:"5px",backgroundColor:"#dddddd",borderRadius:"2px","& .rhap_progress-indicator":{boxSizing:"border-box",position:"absolute",zIndex:3,width:"20px",height:"20px",marginLeft:"-10px",top:"-8px",background:"#868686",borderRadius:"50px",boxShadow:"rgb(134 134 134 / 50%) 0 0 5px"},"& .rhap_progress-filled":{height:"100%",position:"absolute",zIndex:2,backgroundColor:"#868686",borderRadius:"2px",left:0},"& .rhap_download-progress":{width:"100%",height:"100%",position:"absolute",zIndex:1,backgroundColor:"#dddddd",borderRadius:"2px"}}}},"& .rhap_controls-section":{marginTop:"8px",flex:"1 1 auto",display:"flex",alignItems:"center",justifyContent:"space-between","& .rhap_additional-controls":{display:"none",flex:"1 1 auto",alignItems:"center"},"& .rhap_main-controls":{paddingRight:"8px",flex:"none",display:"flex",alignItems:"center",justifyContent:"center","& .rhap_play-pause-button":{fontSize:"40px",width:"40px",height:"40px"},"& .rhap_main-controls-button":{margin:"0 3px",color:"#868686",fontSize:"35px",width:"35px",height:"35px",display:"inline-flex",alignItems:"center"}},"& .rhap_volume-controls":{flex:1,minWidth:0,flexBasis:"auto",paddingRight:"8px",display:"flex",alignItems:"center",justifyContent:"flex-end","& .rhap_volume-container":{display:"flex",alignItems:"center",flex:"0 1 100px",userSelect:"none","& .rhap_volume-button":{flex:"0 0 26px",fontSize:"26px",width:"26px",height:"26px",color:"#868686",marginRight:"6px"},"& .rhap_volume-bar-area":{display:"flex",alignItems:"center",width:"100%",height:"14px",cursor:"pointer","& .rhap_volume-bar":{boxSizing:"border-box",position:"relative",width:"100%",height:"4px",background:"#dddddd",borderRadius:"2px","& .rhap_volume-indicator":{boxSizing:"border-box",position:"absolute",width:"12px",height:"12px",marginLeft:"-6px",left:0,top:"-4px",background:"#868686",opacity:.9,borderRadius:"50px",boxShadow:"rgb(134 134 134 / 50%) 0 0 3px",cursor:"pointer"}}}}}}})),d=(0,r.ZP)({resolved:{},chunkName(){return"AudioPlayer"},isReady(e){let t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>n.e("AudioPlayer").then(n.bind(n,8886)),requireAsync(e){let t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>{return this.resolved[t]=!0,e})},requireSync(e){let t=this.resolve(e);return n(t)},resolve(){return 8886}});t.Z=a.memo(function({audio_url:e,msgType:t,isOwner:n,isOther:r}){let{usePageParams:i,useMediaPlaying:c}=(0,l.OgA)(),u=i(),p=(null==u?void 0:u.rid)||!1,m=a.useRef(),g=`msg-audio-${e}`,[h,f]=c(g),v=()=>{f(!0)},b=()=>{f(!1)},y=()=>{f(!1)};return a.useEffect(()=>{if(!h){var e,t,n;f(!1),(null===(e=m.current)||void 0===e?void 0:null===(t=e.audio)||void 0===t?void 0:t.current)&&(null===(n=m.current.audio.current)||void 0===n||n.pause())}},[g,h]),a.createElement(s,{isPageAllMessages:p,msgType:t,isOwner:n,isOther:r},a.createElement(o,{controls:!0,src:e,preload:"metadata"}),a.createElement(d,{ref:m,src:e,preload:"metadata",onPlay:v,onPause:b,onEnded:y}))},(e,t)=>{return(null==e?void 0:e.audio_url)===(null==t?void 0:t.audio_url)})},71348:function(e,t,n){"use strict";n.d(t,{Z:function(){return R}});var r=n(85597),l=n(67294),i=n(96211),a=n(81719);let o="MsgAttachmentImage",s=(0,a.ZP)("div",{name:o})(({theme:e})=>({position:"relative",width:"100%"})),d=(0,a.ZP)("figure",{name:o})(({theme:e})=>({margin:0,display:"block"})),c=(0,a.ZP)("div",{name:o,shouldForwardProp:e=>"isOwner"!==e&&"isPageAllMessages"!==e})(({theme:e,isOwner:t,isPageAllMessages:n})=>({width:"144px",maxWidth:"100%",cursor:"pointer",...t&&{width:"186px"},...n&&{width:"300px"}})),u=(0,a.ZP)("img",{name:o})(({theme:e})=>({position:"absolute",left:0,top:0,width:"100%",borderRadius:e.spacing(1)}));function p({isOwner:e,title:t,image_url:n,image_dimensions:i}){let{chatplus:a,usePageParams:o}=(0,r.OgA)(),p=o(),m=(null==p?void 0:p.rid)||!1,g=!!i&&i.height/i.width;return l.createElement(s,{className:"uiMsgAttachmentImgWrapper"},l.createElement(d,null,l.createElement(c,{isOwner:!!e,isPageAllMessages:m,style:{paddingBottom:`${g?100*g:100}%`}},l.createElement(u,{src:`${a.sanitizeRemoteFileUrl(n)}&width=300`,onClick:e=>{a.presentImageView(e,{id:"img0",src:a.sanitizeRemoteFileUrl(n)})},alt:t}))))}let m="MsgAttachmentImage",g=(0,a.ZP)("div",{name:m,slot:"UIMsgAttachmentImgWrapper"})(({theme:e})=>({position:"relative",width:"100%"})),h=(0,a.ZP)("figure",{name:m})(({theme:e})=>({margin:0,display:"block"})),f=(0,a.ZP)("div",{name:m,shouldForwardProp:e=>"isOwner"!==e&&"isPageAllMessages"!==e&&"typeGridLayout"!==e&&"msgType"!==e&&"isOther"!==e})(({theme:e,isOwner:t,isPageAllMessages:n,typeGridLayout:r,msgType:l,isOther:i})=>({width:"94px",height:"94px",maxWidth:"100%",cursor:"pointer",marginBottom:"1px",..."type-2"===r&&!t&&{width:"72px",height:"72px"},..."type-1"===r&&{width:"52px",height:"52px"},..."type-1"===r&&t&&{width:"62px",height:"62px"},...("message_pinned"===l||"message_unpinned"===l||i)&&"type-2"===r&&{width:"84px",height:"84px"},...("message_pinned"===l||"message_unpinned"===l||i)&&"type-2"===r&&!t&&{width:"62px",height:"62px"},...("message_pinned"===l||"message_unpinned"===l||i)&&"type-1"===r&&{width:"45px",height:"45px"},...("message_pinned"===l||"message_unpinned"===l||i)&&"type-1"===r&&t&&{width:"58px",height:"58px"},...n&&"type-2"===r&&{width:"190px",height:"190px"},...n&&"type-1"===r&&{width:"126px",height:"126px"},...("message_pinned"===l||"message_unpinned"===l||i)&&n&&"type-2"===r&&{width:"120px",height:"120px"},...("message_pinned"===l||"message_unpinned"===l||i)&&n&&"type-1"===r&&{width:"100px",height:"100px"}})),v=(0,a.ZP)("img",{name:m,shouldForwardProp:e=>"typeGridLayout"!==e})(({theme:e,typeGridLayout:t})=>({position:"absolute",left:0,top:0,width:"100%",objectFit:"cover",borderRadius:e.spacing(1),...t&&{width:"98%",height:"98%"}}));function b({image_url:e,images:t,keyIndex:n,isOwner:i,typeGridLayout:a,msgType:o,isOther:s}){let{chatplus:d,usePageParams:c}=(0,r.OgA)(),u=c(),p=(null==u?void 0:u.rid)||!1,m=t&&t.length?t.map((e,t)=>{return{id:t,src:d.sanitizeRemoteFileUrl(e.image_url)}}):[];return l.createElement(g,null,l.createElement(h,null,l.createElement(f,{isOwner:!!i,isPageAllMessages:p,typeGridLayout:a,msgType:o,isOther:s},l.createElement(v,{typeGridLayout:a,src:`${d.sanitizeRemoteFileUrl(e)}&width=150`,onClick:t=>{d.presentImageView(t,{id:parseInt(n),src:d.sanitizeRemoteFileUrl(e)},m)},alt:"dwq"}))))}var y=n(16473);let x="MsgAttachmentVideo",w=(0,a.ZP)("figure",{name:x})(({theme:e})=>({margin:0,display:"block"})),E=(0,a.ZP)("video",{slot:"AudioPre"})(({theme:e})=>({visibility:"hidden",height:0})),P=(0,a.ZP)("video",{name:x,slot:"VideoStyled",shouldForwardProp:e=>"isPageAllMessages"!==e})(({theme:e,isPageAllMessages:t})=>({width:"186px",maxWidth:"100%",display:"inline-block",...t&&{width:"300px"}})),Z=(0,a.ZP)("div",{name:x,slot:"VideoPreviewWrapper",shouldForwardProp:e=>"isOwner"!==e&&"isPageAllMessages"!==e})(({theme:e,isOwner:t,isPageAllMessages:n})=>({width:"144px",maxWidth:"100%",position:"relative",cursor:"pointer",...t&&{width:"186px"},...n&&{width:"300px"}})),k=(0,a.ZP)("span",{name:x,slot:"VideoPreviewSrc"})(({theme:e})=>({display:"block",position:"relative",backgroundSize:"cover",backgroundPosition:"center center",backgroundRepeat:"no-repeat",backgroundOrigin:"border-box",border:"1px solid rgba(0, 0, 0, 0.1)","&:before":{content:'""',display:"block",paddingBottom:"56.25%"}})),C=(0,a.ZP)(y.zb,{name:x,slot:"CustomPlayButton"})({position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",fontSize:"40px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2,background:"rgba(0, 0, 0, 0.3)",color:"#fff",pointerEvents:"none"});var M=l.memo(function({video_url:e,thumb_url:t,isOwner:n}){let{chatplus:i,usePageParams:a,useMediaPlaying:o}=(0,r.OgA)(),s=a(),d=(null==s?void 0:s.rid)||!1,[c,u]=l.useState(!1),p=l.useRef(),m=`msg-video-${e}`,[g,h]=o(m),f=()=>{h(!0)},v=()=>{h(!1)},b=()=>{h(!1)};return(l.useEffect(()=>{if(!g){var e;h(!1),p.current&&(null===(e=p.current)||void 0===e||e.pause())}},[m,g]),c)?l.createElement(w,null,l.createElement(E,{src:i.sanitizeRemoteFileUrl(e)}),l.createElement(P,{ref:p,isPageAllMessages:d,src:i.sanitizeRemoteFileUrl(e),controls:!0,autoPlay:!0,onPlay:f,onPause:v,onEnded:b})):l.createElement(Z,{isOwner:n,isPageAllMessages:d,onClick:()=>u(!0)},l.createElement(k,{style:{backgroundImage:`url(${t})`}}),l.createElement(C,{icon:"ico-play-circle-o"}))},(e,t)=>{return(null==e?void 0:e.video_url)===(null==t?void 0:t.video_url)});function R({image_url:e,image_dimensions:t,video_url:n,title:a,video_type:o,video_thumb_url:s,audio_url:d,layout:c,totalImages:u,isOwner:m,typeGridLayout:g,msgType:h,isOther:f,keyIndex:v}){let{chatplus:y}=(0,r.OgA)();return d?l.createElement(i.Z,{audio_url:y.sanitizeRemoteFileUrl(d),msgType:h,isOwner:m,isOther:f}):n?l.createElement(M,{isOwner:m,video_url:n,video_type:y.sanitizeRemoteFileUrl(o),thumb_url:y.sanitizeRemoteFileUrl(s)}):e&&"multi-image"===c?l.createElement(b,{title:a,images:u,image_url:e,isOwner:m,typeGridLayout:g,msgType:h,isOther:f,keyIndex:v}):e?l.createElement(p,{isOwner:m,title:a,image_dimensions:t,image_url:e}):null}},72637:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var r=n(67294),l=n(39312),i=n(38781),a=n(42977),o=n(85597),s=n(16473),d=n(30120),c=n(81719),u=n(83940),p=n(71348);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let g="MsgAttachmentMultiMedia",h=(0,c.ZP)("div",{name:g,slot:"uiMsgImageAttachmentWrapper",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:t?"flex-end":"flex-start",marginTop:e.spacing(.25)})),f=(0,c.ZP)("div",{name:g,slot:"uiMsgImageAttachmentItem",shouldForwardProp:e=>"typeGridLayout"!==e&&"isPageAllMessages"!==e&&"isLastItem"!==e})(({theme:e,typeGridLayout:t,isPageAllMessages:n,isLastItem:r})=>({..."type-1"===t&&{flexBasis:"33.333333%"},..."type-2"===t&&{flexBasis:"50%"}}));function v({mediaItems:e,isOwner:t,msgType:n,isOther:l}){let{usePageParams:i}=(0,o.OgA)(),a=i(),s=(null==a?void 0:a.rid)||!1,d=e.length,c=d%3==0?"type-1":d%3==1?"type-1":"type-2";return r.createElement(h,{isOwner:t},e.map((i,a)=>r.createElement(f,{typeGridLayout:c,isPageAllMessages:s,isLastItem:a===e.length-1,key:`k${a}`},r.createElement(p.Z,m({},i,{layout:"multi-image",keyIndex:a,totalImages:e,typeGridLayout:c,isOwner:t,msgType:n,isOther:l})))))}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let y="MsgAttachment",x=(0,c.ZP)("div",{name:y,slot:"UIMsgAttachment",shouldForwardProp:e=>"isOwner"!==e&&"isAudio"!==e&&"isTypeFile"!==e&&"isOther"!==e&&"msgType"!==e})(({theme:e,isOwner:t,isAudio:n,isTypeFile:r,isOther:l,msgType:i})=>({maxWidth:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",marginBottom:e.spacing(.5),marginTop:e.spacing(.25),overflow:"hidden",...(n||"message_pinned"===i||"message_unpinned"===i||l)&&{backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},padding:e.spacing(.5,.75),borderRadius:e.spacing(1.25),"& a":{color:t?"#fff":e.palette.text.primary,textDecoration:"underline",cursor:"pointer"},...t&&{backgroundColor:e.palette.primary.main,color:"#fff !important"}}})),w=(0,c.ZP)("div",{name:y,slot:"TitleStyled",shouldForwardProp:e=>"isOwner"!==e&&"isVideo"!==e&&"isImage"!==e&&"isAudio"!==e&&"isTypeFile"!==e})(({theme:e,isOwner:t,isVideo:n,isImage:r,isAudio:l,isTypeFile:i})=>({display:"none"})),E=(0,c.ZP)("div",{name:y,slot:"TitleLinkStyled",shouldForwardProp:e=>"isOwner"!==e&&"isVideo"!==e&&"isImage"!==e&&"isAudio"!==e&&"isTypeFile"!==e})(({theme:e,isOwner:t,isVideo:n,isImage:r,isAudio:l,isTypeFile:i})=>({borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",display:"inline-block",maxWidth:"100%",wordBreak:"break-word",wordWrap:"break-word",backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},...t&&{backgroundColor:e.palette.primary.main,color:"#fff"},...(n||r)&&{display:"none"},...l&&{width:"300px"}})),P=(0,c.ZP)("div",{name:y,slot:"DescriptionStyled",shouldForwardProp:e=>"isOwner"!==e&&"isVideo"!==e})(({theme:e,isOwner:t,isVideo:n})=>({backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},borderRadius:e.spacing(1),fontSize:e.spacing(1.75),padding:e.spacing(1),display:"inline-block",...t&&{backgroundColor:e.palette.primary.main,color:"#fff"}})),Z=(0,c.ZP)("div")(({theme:e})=>({cursor:"pointer","& .ico":{marginRight:e.spacing(1)}})),k=(0,c.ZP)("div",{name:y,slot:"uiMsgAttachmentAuthor"})(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center","& .MuiAvatar-root":{fontSize:`${e.spacing(1)} !important`},strong:{padding:e.spacing(0,.5,0,.25)}})),C=(0,c.ZP)("div",{name:y,slot:"uiMsgAttachmentFlex"})(({theme:e})=>({textAlign:"start"})),M=(0,c.ZP)("div",{name:y,slot:"uiMsgAttachmentText"})(({theme:e})=>({margin:e.spacing(.5,0)})),R=(0,c.ZP)("div",{name:y,slot:"UIMsgAttachmentTextDelete"})(({theme:e})=>({margin:e.spacing(.5),marginLeft:0,fontStyle:"italic"})),S=(0,c.ZP)("div",{name:y,slot:"uiMsgAttachmentInfoWrapper",shouldForwardProp:e=>"msgType"!==e&&"isOther"!==e})(({theme:e,msgType:t,isOther:n})=>({...("message_pinned"===t||"message_unpinned"===t||n)&&{borderLeft:"2px solid #a2a2a2",paddingLeft:e.spacing(1)}})),O=(0,c.ZP)(s.Ys,{name:y,slot:"uiMsgAttachmentLink"})(({theme:e})=>({cursor:"pointer","& .ico":{marginRight:e.spacing(1)}}));function _({mentions:e=[],title:t,author_real_name:n,author_name:c,author_id:m,text:g,image_url:h,image_dimensions:f,audio_url:y,video_url:_,video_type:I,title_link:A,description:z,video_thumb_url:T,attachments:F,type:B,layout:$,isOwner:W,msgType:j,t:L}){let{chatplus:D,i18n:H}=(0,o.OgA)(),N="file"===B,{count:U,data:Y}=(0,a.HT)(F),V=(0,l.ID)(m);return r.createElement(x,{isOwner:W,isAudio:!!y,isTypeFile:!!N,isOther:!y&&!N,msgType:j},r.createElement(S,{msgType:j,isOther:!y&&!N},c?r.createElement(k,null,r.createElement(u.Z,{size:16,name:(null==V?void 0:V.name)||c,username:(null==V?void 0:V.username)||c,avatarETag:null==V?void 0:V.avatarETag}),r.createElement("strong",null,n||c)):null,r.createElement(C,null,"rm"===L?r.createElement(R,null,H.formatMessage({id:"message_was_deleted"})):null,g&&"rm"!==L?r.createElement(M,{dangerouslySetInnerHTML:{__html:(0,i.ZP)(g,{mentions:e})}}):null,F&&F.length?r.createElement(d.Z,{mt:1},U>1?r.createElement(v,{mediaItems:Y,isOwner:W,msgType:j,isOther:!y&&!N}):r.createElement(r.Fragment,null,F.map((e,t)=>r.createElement(r.Fragment,{key:`k${t}`},e.video_url||e.image_url||e.audio_url?r.createElement(p.Z,b({},e,{key:`k${t}`,msgType:j,isOther:!y&&!N})):r.createElement(r.Fragment,null,e.title_link?r.createElement(O,{lines:1},r.createElement("div",{onClick:()=>(0,a.Sv)(D.sanitizeRemoteFileUrl(e.title_link),!0)},r.createElement(s.zb,{icon:"ico-arrow-down-circle"}),e.title)):null))))):null)),t?r.createElement(w,{isOwner:W,isVideo:!!_,isImage:!!h,isAudio:!!y,isTypeFile:!!N},t):null,r.createElement(p.Z,{image_url:h,video_url:_,audio_url:y,title:t,video_type:I,video_thumb_url:T,layout:$,image_dimensions:f,isOwner:W}),A?r.createElement(E,{isOwner:W,isVideo:!!_,isImage:!!h,isAudio:!!y,isTypeFile:!!N},r.createElement(Z,{onClick:()=>(0,a.Sv)(D.sanitizeRemoteFileUrl(A),!0)},r.createElement("i",{className:"ico ico-arrow-down-circle mr-1"}),t)):null,z?r.createElement(P,{isOwner:W,isVideo:!!_,isImage:!!h,isAudio:!!y,isTypeFile:!!N},z):null)}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function A({message:e,isOwner:t,msgType:n,dataQuote:l,isQuote:i}){var a;if(!(null===(a=e.attachments)||void 0===a?void 0:a.length))return null;let o=e.attachments;if(i&&l&&(o=o.filter(e=>!e.message_id)),!o&&!o.length)return null;let s=o.filter(e=>e.image_url);return s.length>1?r.createElement(v,{mediaItems:s,isOwner:t}):o.map((e,l)=>r.createElement(_,I({},e,{key:`k${l}`,isOwner:t,msgType:n})))}},32990:function(e,t,n){"use strict";n.r(t),n.d(t,{checkIsQuote:function(){return I},default:function(){return A}});var r=n(38781),l=n(81719),i=n(38790),a=n(41609),o=n.n(a),s=n(67294),d=n(72637),c=n(28838),u=n(42977),p=n(85597),m=n(16473),g=n(91647),h=n(71348);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let v="MsgQuote",b=(0,l.ZP)("div",{name:v,slot:"UIMsgAttachment",shouldForwardProp:e=>"isOwner"!==e&&"isAudio"!==e&&"isTypeFile"!==e&&"isOther"!==e&&"msgType"!==e})(({theme:e,isOwner:t,isAudio:n,isTypeFile:r,isOther:l,msgType:i})=>({marginBottom:e.spacing(-2),marginLeft:e.spacing(1),marginRight:0,marginTop:e.spacing(.25),paddingBottom:e.spacing(3),maxWidth:"calc(100% - 8px)",display:"flex",flexDirection:"row",overflow:"hidden",border:e.mixins.border("secondary"),borderRadius:e.spacing(1),minHeight:"70px",...(n||"message_pinned"===i||"message_unpinned"===i||l)&&{"& a":{color:e.palette.text.primary,textDecoration:"underline",cursor:"pointer"},...t&&{color:e.palette.text.secondary,marginRight:e.spacing(1),marginLeft:0}}})),y=(0,l.ZP)("div",{name:v,slot:"uiMsgAttachmentAuthor"})(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center","& .MuiAvatar-root":{fontSize:`${e.spacing(1)} !important`}})),x=(0,l.ZP)(g.Z)(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey.A200:e.palette.text.primary})),w=(0,l.ZP)("div",{name:v,slot:"uiMsgAttachmentFlex"})(({theme:e})=>({textAlign:"start"})),E=(0,l.ZP)(m.Ys,{name:v,slot:"uiMsgAttachmentText"})(({theme:e})=>({color:e.palette.text.secondary})),P=(0,l.ZP)("div",{name:v,slot:"UIMsgAttachmentTextDelete"})(({theme:e})=>({margin:e.spacing(.5),marginLeft:0,fontStyle:"italic"})),Z=(0,l.ZP)("div",{name:v,slot:"uiMsgAttachmentInfoWrapper",shouldForwardProp:e=>"msgType"!==e&&"isOther"!==e})(({theme:e,msgType:t,isOther:n})=>({...("message_pinned"===t||"message_unpinned"===t||n)&&{overflow:"hidden",margin:e.spacing(1,1,0,0)}})),k=(0,l.ZP)(m.Ys,{name:v,slot:"uiMsgAttachmentLink"})(({theme:e})=>({"& .ico":{fontSize:e.mixins.pxToRem(12),marginRight:e.spacing(.5)}})),C=(0,l.ZP)("div")(({theme:e})=>({width:e.spacing(.5),height:"100%",backgroundColor:e.palette.grey["100"]})),M=(0,l.ZP)("div")(({theme:e})=>({width:e.spacing(3),minWidth:e.spacing(3),marginTop:e.spacing(1.5),display:"flex",justifyContent:"center",alignItems:"center"}));function R({dataQuote:e,isOwner:t}){let{chatplus:n,i18n:l}=(0,p.OgA)();if(!e)return null;let{mentions:i=[],author_real_name:a,author_name:o,text:d,audio_url:c,attachments:g,type:v,msgType:R,t:S}=e,O="file"===v,{count:_}=(0,u.HT)(g);return s.createElement(b,{isOwner:t,isAudio:!!c,isTypeFile:!!O,isOther:!c&&!O,msgType:R},s.createElement(M,null,s.createElement(C,null)),s.createElement(Z,{msgType:R,isOther:!c&&!O},o?s.createElement(y,null,s.createElement(x,{component:"h2",variant:"h5"},a||o)):null,s.createElement(w,null,"rm"===S?s.createElement(P,null,l.formatMessage({id:"message_was_deleted"})):null,d&&"rm"!==S?s.createElement(E,{lines:1,dangerouslySetInnerHTML:{__html:(0,r.ZP)(d,{mentions:i})}}):null,!d&&g&&g.length?s.createElement("div",{className:"mt-1"},_>1?s.createElement(E,{lines:1},l.formatMessage({id:"total_photo"},{value:_})):s.createElement(s.Fragment,null,g.map((e,t)=>{return s.createElement(s.Fragment,{key:`k${t}`},e.video_url||e.image_url?s.createElement(h.Z,f({},e,{key:`k${t}`,msgType:R,isOther:!c&&!O})):e.audio_url?s.createElement(E,{lines:1},(null==e?void 0:e.title)||l.formatMessage({id:"file_attachment"})):s.createElement("div",null,e.title_link?s.createElement(k,{lines:1},s.createElement("div",{onClick:()=>(0,u.Sv)(n.sanitizeRemoteFileUrl(e.title_link),!0)},s.createElement(m.zb,{icon:"ico-paperclip-alt"}),e.title)):null))}))):null)))}let S="MessageText",O=(0,l.ZP)("div",{name:S,slot:"uiChatMsgItemMsg",shouldForwardProp:e=>"isOwner"!==e&&"isQuote"!==e&&"isMention"!==e})(({theme:e,isOwner:t,isQuote:n,isMention:r})=>({borderRadius:e.spacing(1),fontSize:e.mixins.pxToRem(15),padding:e.spacing(1.25),display:"flex",alignItems:"center",backgroundColor:e.palette.grey["100"],..."dark"===e.palette.mode&&{backgroundColor:e.palette.grey["600"]},overflowWrap:"break-word","& a":{overflowWrap:"break-word",color:t?"#fff":e.palette.text.primary,textDecoration:"underline",cursor:"pointer",...r&&{textDecoration:"none","&:hover":{textDecoration:"underline"}}},...t&&{backgroundColor:e.palette.primary.main,color:"#fff !important"}})),_=(0,l.ZP)("div",{name:S,slot:"uiChatMsgItemBodyInnerWrapper",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",flexDirection:"column",alignItems:"flex-start",...t&&{alignItems:"flex-end"}})),I=e=>{var t;let n=e&&e.length&&(null===(t=e[e.length-1])||void 0===t?void 0:t.type)!=="file";if(!n)return{isQuote:n,dataQuote:null};{let r=e.filter(e=>e.message_id);return{isQuote:n,dataQuote:r?r[0]:null}}};function A({message:e,isOwner:t,createdDate:n,tooltipPosition:l}){let a=e.msg?(0,r.ZP)(e.msg,{mentions:e.mentions}):null,{isQuote:u,dataQuote:p}=I(null==e?void 0:e.attachments);return s.createElement(i.Z,{title:n,placement:l,PopperProps:{disablePortal:!0}},s.createElement(_,{isOwner:t},u?s.createElement(R,{dataQuote:p,isOwner:t}):null,a?s.createElement(O,{isMention:!o()(e.mentions),isQuote:u,isOwner:t,className:"uiChatMsgItemMsg"},s.createElement("div",{dangerouslySetInnerHTML:{__html:a}})):null,s.createElement(d.Z,{message:e,isOwner:t,isQuote:u,dataQuote:p}),s.createElement(c.Z,{message:e})))}},28838:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(67294),l=n(42977),i=n(16473),a=n(81719),o=n(41609),s=n.n(o);let d="MsgEmbed",c=(0,a.ZP)("div",{name:d,slot:"uiMsgEmbed"})(({theme:e})=>({marginTop:"4px",marginBottom:"8px",width:"400px",maxWidth:"100%",cursor:"pointer"})),u=(0,a.ZP)("div",{name:d,slot:"uiMsgEmbedOuter"})(({theme:e})=>({display:"flex",flexDirection:"column",borderRadius:"8px",border:e.mixins.border("secondary"),color:"#555555"})),p=(0,a.ZP)("div",{name:d,slot:"ItemMedia"})(({theme:e})=>({width:"100%"})),m=(0,a.ZP)("div",{name:d,slot:"ItemMediaSrc"})(({theme:e})=>({width:"100%",display:"block",position:"relative",backgroundSize:"cover",backgroundPosition:"center center",backgroundRepeat:"no-repeat",backgroundOrigin:"border-box",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"8px 8px 0 0",backgroundColor:"transparent",borderBottom:"1px solid rgba(0, 0, 0, 0.1)","&:before":{content:"''",display:"block",paddingBottom:"56%"}})),g=(0,a.ZP)("div",{name:d,slot:"ItemInner"})(({theme:e})=>({flex:1,minWidth:0,padding:"8px"})),h=(0,a.ZP)(i.Ys,{name:d,slot:"ItemTitle"})(({theme:e})=>({marginBottom:"2px",color:"light"===e.palette.mode?e.palette.grey["900"]:e.palette.text.primary})),f=(0,a.ZP)(i.Ys,{name:d,slot:"ItemUrl"})(({theme:e})=>({marginBottom:"2px",color:e.palette.text.secondary})),v=(0,a.ZP)(i.Ys,{name:d,slot:"ItemDescription"})(({theme:e})=>({color:"light"===e.palette.mode?e.palette.grey["900"]:e.palette.text.primary}));function b({url:e,meta:t,parsedUrl:n,ignoreParse:i}){let a=!i&&(t&&!s()(t)||n&&!s()(n));if(!a)return null;let{ogTitle:o,ogDescription:d,ogImage:b,oembedThumbnailUrl:y,oembedTitle:x,oembedDescription:w}=t,E=n.host,P=o||x,Z=d||w;return r.createElement(c,null,r.createElement(u,{onClick:()=>(0,l.Sv)(e,!0)},b||y?r.createElement(p,null,r.createElement(m,{style:{backgroundImage:`url(${b||y})`}})):r.createElement(p,null,r.createElement("span",{className:"item-media-src media-default"})),r.createElement(g,null,P?r.createElement(h,{lines:2,variant:"h6"},P):null,r.createElement(f,{lines:2,variant:"body2"},E),Z?r.createElement(v,{lines:2,variant:"h6"},Z):null)))}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function x({message:e}){var t;return(null===(t=e.urls)||void 0===t?void 0:t.length)?e.urls.filter(e=>{return!(null==e?void 0:e.ignoreParse)&&e.meta&&e.parsedUrl}).map((e,t)=>r.createElement(b,y({},e,{key:`k${t}`}))):null}},96095:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(85597),l=n(81719),i=n(67294),a=n(40471),o=n(47037),s=n.n(o);let d=(0,l.ZP)("span")(({theme:e})=>({display:"inline-flex",alignItems:"center",justifyContent:"center",margin:e.spacing(0,.25)})),c=(0,l.ZP)("img")(({theme:e})=>({width:15,height:15}));function u({id:e,usernames:t}){let n=(0,a.z)();if(!e||!t)return null;let r=s()(e)&&e.split(":")[1].split("_")[1];if(!r||!n)return null;let l=n.find(e=>e.id===parseInt(r));return i.createElement(d,null,i.createElement(c,{src:null==l?void 0:l.src,draggable:!1,alt:null==l?void 0:l.title}))}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let m=(0,l.ZP)("div",{shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",margin:0,padding:0,marginBottom:e.spacing(-1),...t&&{flexDirection:"row-reverse"}})),g=(0,l.ZP)("span")(({theme:e})=>({marginLeft:e.spacing(.5),position:"relative",top:"-1px",fontSize:e.typography.pxToRem(14),height:e.spacing(2.5),fontWeight:e.typography.fontWeightRegular})),h=(0,l.ZP)("div")(({theme:e})=>({cursor:"pointer",color:e.palette.grey["800"],backgroundColor:e.palette.grey["50"],position:"relative",borderRadius:e.spacing(1),lineHeight:e.spacing(2.5),whiteSpace:"nowrap",display:"inline-flex",alignItems:"center",padding:e.spacing(.5,.75),boxShadow:"0px 0px 15px 0px #00000026",transform:"translateY(-10px)",height:e.spacing(3),zIndex:2}));function f({identity:e,disabled:t,reactions:n,isOwner:l,handleAction:a}){let{dispatch:o}=(0,r.OgA)(),s=()=>{o({type:"chatplus/presentReactionsList",payload:{identity:e}})};if(t||!n||!Object.keys(n).length)return null;let d=0,c=Object.keys(n).sort((e,t)=>{var r,l,i,a,o,s,d,c;return((null===(r=n[t])||void 0===r?void 0:null===(l=r.usernames)||void 0===l?void 0:l.length)||1)-((null===(i=n[e])||void 0===i?void 0:null===(a=i.usernames)||void 0===a?void 0:a.length)||1)-((null===(o=n[t])||void 0===o?void 0:null===(s=o.updatedAt)||void 0===s?void 0:s.$date)||1)-((null===(d=n[e])||void 0===d?void 0:null===(c=d.updatedAt)||void 0===c?void 0:c.$date)||1)}).reduce((e,t)=>{var r,l;return d+=null===(r=n[t])||void 0===r?void 0:null===(l=r.usernames)||void 0===l?void 0:l.length,{...e,[t]:n[t]}},{});return i.createElement(m,{isOwner:l},i.createElement(h,{onClick:s},Object.keys(c).slice(0,3).map((e,t)=>i.createElement(u,p({id:e},c[e],{key:`k${t}`}))),i.createElement(g,null,d)))}},59045:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var r=n(85597),l=n(81719),i=n(67294),a=n(16473),o=n(21822),s=n(38790);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let c="MsgActionMenu",u=(0,l.ZP)("div",{name:c,slot:"root"})(({theme:e})=>({"& .MuiActionMenu-menu":{overflowY:"auto",overflowX:"hidden",maxHeight:"260px",maxWidth:"170px","&::-webkit-scrollbar":{height:"6px",width:"6px",borderRadius:"3px",transition:"opacity 200ms"},"&::-webkit-scrollbar-track":{borderRadius:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.2)",borderRadius:"3px"},"&::-webkit-scrollbar-thumb:horizontal":{background:"#000",borderRadius:"10px"}}})),p=(0,l.ZP)(o.Z,{name:c,slot:"UIChatItemBtn",shouldForwardProp:e=>"showHover"!==e})(({theme:e,showHover:t})=>({position:"relative",visibility:t?"hidden":"unset",padding:e.spacing(1,.5),cursor:"pointer",minWidth:e.spacing(3),lineHeight:e.spacing(2.5),color:"light"===e.palette.mode?e.palette.grey["600"]:e.palette.text.secondary}));function m({identity:e,handleAction:t,scrollRef:n,items:l,showHover:o=!0,placement:c="auto-start",...m}){let{ItemActionMenu:g,i18n:h}=(0,r.OgA)();return i.createElement(u,null,i.createElement(g,d({items:l,placement:c,identity:e,handleAction:t,dependName:"chatplus/msgActionMenu",scrollRef:n,scrollClose:!0},m,{control:i.createElement(s.Z,{title:h.formatMessage({id:"more"}),placement:"top",PopperProps:{disablePortal:!0}},i.createElement(p,{showHover:o,disableFocusRipple:!0,disableRipple:!0,disableTouchRipple:!0,className:"uiChatItemBtn"},i.createElement(a.zb,{icon:"ico-dottedmore-vertical-o"})))})))}var g=n(25722),h=n(62937),f=n(39312),v=n(40471),b=n(86010),y=n(22410),x=n(73327),w=n(41609),E=n.n(w);let P=(0,y.Z)(e=>(0,x.Z)({paper:{borderRadius:24,margin:0,padding:0},itemsRoot:{display:"flex",flexDirection:"row"},itemRoot:{padding:"4px",display:"flex",alignItem:"center",alignSelf:"center"},itemImage:{width:27,height:27},active:{background:e.palette.grey["300"],padding:e.spacing(.5),borderRadius:e.spacing(1),width:34,height:34,display:"flex",alignItem:"center",justifyContent:"center",margin:e.spacing(.2)}}),{name:"ReactionThisItemPopover"}),Z=({item:e,classes:t,onClick:n,active:r})=>{return i.createElement("div",{className:(0,b.default)(t.itemRoot,r&&t.active),role:"button",onClick:n,"aria-label":e.title,"data-testid":"itemReaction"},i.createElement(s.Z,{title:e.title},i.createElement("img",{src:e.src,draggable:!1,alt:e.title,className:t.itemImage})))};var k=function({onEmojiClick:e,unsetReaction:t,identity:n}){let r=(0,v.z)(),l=P(),a=(0,f.v2)(n),o=(0,f.Oy)(),s=o.username,d=e=>{var t,n,r;return!E()(null==a?void 0:null===(t=a.reactions)||void 0===t?void 0:t[e])&&(null===(n=a.reactions)||void 0===n?void 0:null===(r=n[e])||void 0===r?void 0:r.usernames.includes(s))},c=n=>{let r=d(n);r?t(n):e(n,null)};return i.createElement("div",{className:l.itemsRoot},r.map(e=>i.createElement(Z,{key:e.id.toString(),onClick:()=>{c(`:reaction_${e.id.toString()}:`)},classes:l,item:e,active:d(`:reaction_${e.id}:`)})))};let C=(0,l.ZP)(g.Z)(({theme:e})=>({margin:0,padding:e.spacing(0,.5),maxHeight:"48px",display:"flex",alignItems:"center",whiteSpace:"nowrap"}));function M({onEmojiClick:e,multiple:t=!0,disabled:n,scrollRef:l,scrollClose:o,placement:s="top",label:d="react",control:c,identity:u,unsetReaction:p}){let{i18n:m}=(0,r.OgA)(),g=m.formatMessage({id:d}),[f,v]=i.useState(null),b=i.useRef(),[y,x]=i.useState(!1),w=i.useCallback(()=>{x(!1)},[]),E=i.useCallback(e=>{x(e=>!e),v(f?null:e.currentTarget)},[]),P=i.useCallback((n,r)=>{e&&e(n,r),t||x(!1)},[t,e]),Z=i.useCallback(e=>{p&&p(e),x(!1)},[p]);return i.useEffect(()=>{if(y&&l&&l.current&&o){let e=()=>x(!1);return l.current.addEventListener("scroll",e),()=>{null==l||l.current.removeEventListener("scroll",e)}}},[y]),i.createElement(i.Fragment,null,i.createElement(a.Qn,{excludeRef:b,onClickAway:w},i.createElement(c,{onClick:E,disabled:n,title:g,"data-testid":"buttonAttachEmoji",icon:"ico-smile-o"})),i.createElement(h.Z,{ref:b,open:y,anchorEl:f,placement:s,role:"presentation",style:{zIndex:5e3}},i.createElement(C,{"data-testid":"dialogEmojiPicker"},i.createElement(k,{onEmojiClick:P,unsetReaction:Z,identity:u}))))}function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let S=(0,l.ZP)(o.Z,{name:"MsgEmojiPicker",slot:"UIChatItemBtn"})(({theme:e})=>({position:"relative",visibility:"hidden",padding:e.spacing(1,.75),cursor:"pointer",minWidth:e.spacing(2.5),lineHeight:e.spacing(2.5),color:"light"===e.palette.mode?e.palette.grey["600"]:e.palette.text.secondary})),O=i.forwardRef(({title:e,...t},n)=>{return i.createElement(s.Z,{title:e,placement:"top",PopperProps:{disablePortal:!0}},i.createElement(S,R({className:"uiChatItemBtn uiChatIconBtn",disableFocusRipple:!0,disableRipple:!0,disableTouchRipple:!0},t,{ref:n}),i.createElement(a.zb,{icon:"ico-smile-o"})))});function _({handleAction:e,scrollRef:t,identity:n}){let r=i.useCallback((t,n=null)=>e("chatplus/messageReaction",{shortcut:t,unicode:n}),[e]),l=i.useCallback(t=>{e("chatplus/unsetReaction",{identity:n,shortcut:t})},[e]);return i.createElement(M,{size:"small",multiple:!1,onEmojiClick:r,unsetReaction:l,control:O,scrollRef:t,scrollClose:!0,identity:n})}let I=(0,l.ZP)("div",{name:"MsgToolbar",slot:"uiChatToolbar",shouldForwardProp:e=>"isOwner"!==e})(({theme:e,isOwner:t})=>({display:"flex",justifyContent:"center",alignItems:"center",...!t&&{flexDirection:"row-reverse"}}));function A({items:e,disabled:t,disableReact:n,handleAction:l,identity:a,isOwner:o,showHover:s,placement:d}){let{useScrollRef:c}=(0,r.OgA)(),u=c();return t?null:i.createElement(I,{isOwner:o,className:"uiChatToolbar"},i.createElement(m,{identity:a,items:e,scrollRef:u,handleAction:l,showHover:s,placement:d,popperOptions:{strategy:"fixed"}}),n?null:i.createElement(_,{scrollRef:u,handleAction:l,identity:a}))}},38781:function(e,t,n){"use strict";n.d(t,{Hj:function(){return c},ZP:function(){return u},kK:function(){return m}});var r=n(7187),l=n.n(r),i=n(42977);function a(e){return e.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2")}function o(e,t={}){let{mentions:n=[]}=t,r=e.replace(/\[(\s)*\]\(([^\)]+)\)/gm,"");return n&&n.length>0&&(r=r.replace(/@([^\s\\#@:]+)/giu,(e,t)=>{let r=n.find(e=>e.username===t);return r&&r.name?`@${r.name}`:e})),r}function s(e,t={}){let{mentions:n=[]}=t,r=e.replace(/@\[([^\]]+)\]\(([^#@:]+)\)/giu,"<a onclick=\"triggerClick('$2')\">@$1</a>");return n&&n.length>0&&(r=r.replace(/@([^\s\\#@:]+)/giu,(e,t)=>{let r=n.find(e=>e.username===t);return r&&r.name?`<a onclick="triggerClick('/${t}')">@${r.name}</a>`:e})),r}window.triggerClick=i.Sv;let d=e=>e.replace(/:\w+:/gi,e=>e),c=(e,t={})=>{return e?o(e,t):null};function u(e,t={}){var n;return e?a(d(s((n=o(e),l()(n)).replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,'<a onclick="triggerClick(\'$1\',true)" target="_blank">$1</a>'),t))):null}let p=(e={})=>{return/^(\w+)_(audio|video)_call_([cpd]$)/.test((null==e?void 0:e.t)||(null==e?void 0:e.type))};function m(e){var t;let n=null==e?void 0:e.t;return["rm"].includes(n)?[{id:"message_was_deleted"}]:p(e)?/(invite)_/.test(n)||/(start)_/.test(n)?[{id:"started_a_call"}]:/(miss)_/.test(n)?[{id:"missed_a_call"}]:[{id:"call_ended"}]:(null==e?void 0:e.msg)?a(d(s((t=o(null==e?void 0:e.msg),l()(t)),{mentions:(null==e?void 0:e.mentions)||[]}))):null}},40471:function(e,t,n){"use strict";n.d(t,{z:function(){return a}});var r=n(86706),l=n(22222);let i=(0,l.P1)(e=>e.preaction.data.reactions,e=>e);function a(){return(0,r.v9)(i)}}}]);